<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>FOREST: Forest::BoundaryValues&lt; dim &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="forest_icon.png" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="forest_icon.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">FOREST
   </div>
   <div id="projectbrief">Framework Oriented for REactor SimulaTions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="pages.html"><span>pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="../../index.html"><span>FOREST&#160;Documentation</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classForest_1_1BoundaryValues.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classForest_1_1BoundaryValues-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Forest::BoundaryValues&lt; dim &gt; Class Template Reference<div class="ingroups"><a class="el" href="group__ForestNeutronics.html">ForestNeutronics</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Boundary conditions for the system.  
 <a href="classForest_1_1BoundaryValues.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="eq__transport_8h_source.html">/home/lns/Codes/forest-public/mylib/include/algebra/eq_transport.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aca15ecc7c018ae04b11fc45e14f99378"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#aca15ecc7c018ae04b11fc45e14f99378">BoundaryValues</a> (<a class="el" href="classForest_1_1State.html">State</a>&lt; dim &gt; &amp;state, std::shared_ptr&lt; <a class="el" href="classForest_1_1QuadratureBase.html">QuadratureBase</a>&lt; dim &gt; &gt; &amp;ord)</td></tr>
<tr class="memdesc:aca15ecc7c018ae04b11fc45e14f99378"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor using the information in <code>state</code>.  <a href="#aca15ecc7c018ae04b11fc45e14f99378">More...</a><br /></td></tr>
<tr class="separator:aca15ecc7c018ae04b11fc45e14f99378"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32cc58a4a8711849f3c7215811331d83"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#a32cc58a4a8711849f3c7215811331d83">apply_reflective</a> (<a class="el" href="classdealii_1_1Vector.html">Vector</a>&lt; double &gt; &amp;src_m, const <a class="el" href="classdealii_1_1BlockVector.html">BlockVector</a>&lt; double &gt; &amp;psi_s, unsigned int g, unsigned int i_dir, unsigned int f_bc_ind=0)</td></tr>
<tr class="memdesc:a32cc58a4a8711849f3c7215811331d83"><td class="mdescLeft">&#160;</td><td class="mdescRight">apply the boundary conditions in <code>psi_s</code> for direction <code>i_ord</code> to the flux <code>src_m</code>  <a href="#a32cc58a4a8711849f3c7215811331d83">More...</a><br /></td></tr>
<tr class="separator:a32cc58a4a8711849f3c7215811331d83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8cf7e61828838bcc2ed7fd6e5ab5e67"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#aa8cf7e61828838bcc2ed7fd6e5ab5e67">get_reflective</a> (<a class="el" href="classdealii_1_1BlockVector.html">BlockVector</a>&lt; double &gt; &amp;psi_s, const <a class="el" href="classdealii_1_1Vector.html">Vector</a>&lt; double &gt; &amp;psi_m, unsigned int o_dir, unsigned int f_bc_ind=0)</td></tr>
<tr class="memdesc:aa8cf7e61828838bcc2ed7fd6e5ab5e67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collect the outgoing flux for direction <code>o_dir</code> to incoming flux.  <a href="#aa8cf7e61828838bcc2ed7fd6e5ab5e67">More...</a><br /></td></tr>
<tr class="separator:aa8cf7e61828838bcc2ed7fd6e5ab5e67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a001043723110c7f020edde8ec2cce224"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#a001043723110c7f020edde8ec2cce224">memory_consumption</a> () const </td></tr>
<tr class="memdesc:a001043723110c7f020edde8ec2cce224"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate memory consumption for this class.  <a href="#a001043723110c7f020edde8ec2cce224">More...</a><br /></td></tr>
<tr class="separator:a001043723110c7f020edde8ec2cce224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d1460ff156fa76397c913f74b7eb6f3"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; unsigned int &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#a6d1460ff156fa76397c913f74b7eb6f3">get_block_sizes</a> () const </td></tr>
<tr class="memdesc:a6d1460ff156fa76397c913f74b7eb6f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Significant dofs for the incoming flux for every direction.  <a href="#a6d1460ff156fa76397c913f74b7eb6f3">More...</a><br /></td></tr>
<tr class="separator:a6d1460ff156fa76397c913f74b7eb6f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98b03d6ef11409df3e521ddd22846e3d"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#a98b03d6ef11409df3e521ddd22846e3d">get_block_sizes</a> (unsigned int i_ord) const </td></tr>
<tr class="memdesc:a98b03d6ef11409df3e521ddd22846e3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of degrees of freedom for direction <code>i_ord</code>.  <a href="#a98b03d6ef11409df3e521ddd22846e3d">More...</a><br /></td></tr>
<tr class="separator:a98b03d6ef11409df3e521ddd22846e3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:ab0b027500ccb031c3a7352d3e5ae15d3"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classdealii_1_1DoFHandler.html">DoFHandler</a>&lt; dim, dim &gt;::face_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#ab0b027500ccb031c3a7352d3e5ae15d3">f_iter</a></td></tr>
<tr class="memdesc:ab0b027500ccb031c3a7352d3e5ae15d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Short name for the face iterator.  <a href="#ab0b027500ccb031c3a7352d3e5ae15d3">More...</a><br /></td></tr>
<tr class="separator:ab0b027500ccb031c3a7352d3e5ae15d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b1d07829097331ddaba5b1fcecdff1f"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classdealii_1_1DoFHandler.html">DoFHandler</a>&lt; dim, dim &gt;::active_cell_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#a9b1d07829097331ddaba5b1fcecdff1f">c_iter</a></td></tr>
<tr class="memdesc:a9b1d07829097331ddaba5b1fcecdff1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Short name for the cell iterator.  <a href="#a9b1d07829097331ddaba5b1fcecdff1f">More...</a><br /></td></tr>
<tr class="separator:a9b1d07829097331ddaba5b1fcecdff1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a8666bcf626564f9aa7ba335ad9262a74"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#a8666bcf626564f9aa7ba335ad9262a74">init</a> ()</td></tr>
<tr class="memdesc:a8666bcf626564f9aa7ba335ad9262a74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializing the data.  <a href="#a8666bcf626564f9aa7ba335ad9262a74">More...</a><br /></td></tr>
<tr class="separator:a8666bcf626564f9aa7ba335ad9262a74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ea25aaae629a54d139efe08446e58e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#a10ea25aaae629a54d139efe08446e58e">set_incoming_faces</a> (unsigned int i_ord)</td></tr>
<tr class="memdesc:a10ea25aaae629a54d139efe08446e58e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collect the albedo faces for direction i_ord.  <a href="#a10ea25aaae629a54d139efe08446e58e">More...</a><br /></td></tr>
<tr class="separator:a10ea25aaae629a54d139efe08446e58e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7663664c05d831ca86c3e0c99f6f1271"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#a7663664c05d831ca86c3e0c99f6f1271">set_outgoing_faces</a> (unsigned int i_ord)</td></tr>
<tr class="memdesc:a7663664c05d831ca86c3e0c99f6f1271"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collect the albedo faces for direction i_ord.  <a href="#a7663664c05d831ca86c3e0c99f6f1271">More...</a><br /></td></tr>
<tr class="separator:a7663664c05d831ca86c3e0c99f6f1271"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1b3e901a3367f63eaef282c144d822e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#ae1b3e901a3367f63eaef282c144d822e">set_global_to_bc_data</a> (unsigned int i_ord)</td></tr>
<tr class="separator:ae1b3e901a3367f63eaef282c144d822e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a62fbb23a2de5168fab1b19df83845703"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1State.html">State</a>&lt; dim &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a></td></tr>
<tr class="memdesc:a62fbb23a2de5168fab1b19df83845703"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to state object.  <a href="#a62fbb23a2de5168fab1b19df83845703">More...</a><br /></td></tr>
<tr class="separator:a62fbb23a2de5168fab1b19df83845703"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71667d3e2d6389cf0ea75933018b0bd2"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classForest_1_1QuadratureBase.html">QuadratureBase</a>&lt; dim &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#a71667d3e2d6389cf0ea75933018b0bd2">mp_ord</a></td></tr>
<tr class="memdesc:a71667d3e2d6389cf0ea75933018b0bd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to quadrature object.  <a href="#a71667d3e2d6389cf0ea75933018b0bd2">More...</a><br /></td></tr>
<tr class="separator:a71667d3e2d6389cf0ea75933018b0bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc790104b7688c60713072116ed8f5c6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; unsigned int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">m_fe_sup_on_face</a></td></tr>
<tr class="memdesc:adc790104b7688c60713072116ed8f5c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">For running over the dofs of the face and skipping the interiors.  <a href="#adc790104b7688c60713072116ed8f5c6">More...</a><br /></td></tr>
<tr class="separator:adc790104b7688c60713072116ed8f5c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e2527ac3d0fc92736bfe8c4fe0ca8c1"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::multimap&lt; <a class="el" href="classForest_1_1BoundaryValues.html#a9b1d07829097331ddaba5b1fcecdff1f">c_iter</a>, unsigned int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">m_i_faces</a></td></tr>
<tr class="memdesc:a7e2527ac3d0fc92736bfe8c4fe0ca8c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the incoming faces.  <a href="#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">More...</a><br /></td></tr>
<tr class="separator:a7e2527ac3d0fc92736bfe8c4fe0ca8c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a965cc443482b36db1801948586d9bc2a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::multimap&lt; <a class="el" href="classForest_1_1BoundaryValues.html#a9b1d07829097331ddaba5b1fcecdff1f">c_iter</a>, unsigned int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#a965cc443482b36db1801948586d9bc2a">m_o_faces</a></td></tr>
<tr class="memdesc:a965cc443482b36db1801948586d9bc2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the outgoing faces.  <a href="#a965cc443482b36db1801948586d9bc2a">More...</a><br /></td></tr>
<tr class="separator:a965cc443482b36db1801948586d9bc2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad23ad159d9575db6e871aa735cf9bb6a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::map&lt; unsigned int, unsigned int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#ad23ad159d9575db6e871aa735cf9bb6a">m_g2s_dofs</a></td></tr>
<tr class="memdesc:ad23ad159d9575db6e871aa735cf9bb6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The matrix \( P \) extracting significant dofs for bcs.  <a href="#ad23ad159d9575db6e871aa735cf9bb6a">More...</a><br /></td></tr>
<tr class="separator:ad23ad159d9575db6e871aa735cf9bb6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29e7c8ab2a0ee2327321fb9495670b3c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1BoundaryValues.html#a29e7c8ab2a0ee2327321fb9495670b3c">m_dofs_in_bc</a></td></tr>
<tr class="memdesc:a29e7c8ab2a0ee2327321fb9495670b3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Significant dofs for the incoming flux for every direction.  <a href="#a29e7c8ab2a0ee2327321fb9495670b3c">More...</a><br /></td></tr>
<tr class="separator:a29e7c8ab2a0ee2327321fb9495670b3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;int dim&gt;<br />
class Forest::BoundaryValues&lt; dim &gt;</h3>

<p>Boundary conditions for the system. </p>
<p>After the discretization of the energy and the angle (in this case with discrete ordinates), the streaming operator over a domain \( T \) has the following form</p>
<p class="formulaDsp">
\begin{align*} &amp; \Omega_m \cdot \nabla \Psi_{m,g}(\mathbf{r}) \quad \forall m, g \quad \mathbf{r} \in T . \end{align*}
</p>
<p>And when the finite element method is used, using integration by parts we get</p>
<p class="formulaDsp">
\begin{align*} &amp; \int_T \left( \Omega_m \cdot \nabla \right) \Psi_{m,g}(\mathbf{r}) v(\mathbf{r}) \ \text{d}(\mathbf{r}) \\ &amp; = \int_T \Psi_{m,g}(\mathbf{r}) \left( \Omega_m \cdot \nabla \right) v(\mathbf{r}) \ \text{d}(\mathbf{r}) - \int_{\partial T}\left( \Omega_m \cdot \vec{n}(\mathbf{r}) \right) \Psi_{m,g}(\mathbf{r}) v(\mathbf{r}) \ \text{d}(\mathbf{r}) \\ &amp; = \int_T \Psi_{m,g}(\mathbf{r}) \left( \Omega_m \cdot \nabla \right) v(\mathbf{r}) \ \text{d}(\mathbf{r}) - \int_{\partial T_{\text{out}}} \left( \Omega_m \cdot \vec{n}(\mathbf{r}) \right) \Psi_{m,g}(\mathbf{r}) v(\mathbf{r}) \ \text{d}(\mathbf{r}) - \int_{\partial T_{\text{in}}} \left( \Omega_m \cdot \vec{n}(\mathbf{r}) \right) \Psi_{m,g}(\mathbf{r}) v(\mathbf{r}) \ \text{d}(\mathbf{r}) \end{align*}
</p>
<p>Then, the boundary conditions are imposed by substituting the value of \( \Psi_{m,g}(\mathbf{r}) \) at the incoming boundaries, by its value, and moving this term to the right hand side (when the value is known), or generating coupling between directions when this value is related to an outgoing flux for a different direction (reflective boundary conditions).</p>
<h2>Incoming (or Dirichlet) Boundary Conditions.</h2>
<p>Incoming boundary conditions can be written as</p>
<p class="formulaDsp">
\begin{align*} &amp; \Psi_{m,g}(\mathbf{r}) = \Psi_{m,g}^{\text{in}}(\mathbf{r}), \quad n(\mathbf{r})\cdot \Omega_m &lt; 0 \quad \forall m, g \quad \forall \mathbf{r} \in \Gamma_{D} \end{align*}
</p>
<p>being \( \Gamma_{D} \) the incoming part of the boundary (Dirichlet). In matrix form, this can be used to solve the system</p>
<p class="formulaDsp">
\begin{align*} L_{0,g} \Psi_{g} = Q_{g} - L_{D,g} \Psi_{g}^{\text{in}} \end{align*}
</p>
<p>where \( L_{0,g} \) is a block diagonal matrix, where the blocks in the diagonal are constructed as the discretized version of the <b>bilinear</b> form</p>
<p class="formulaDsp">
\begin{align*} \mathcal{L}_{0,m,g} (\Psi_{m,g},v) = \int_T \Psi_{m,g}(\mathbf{r}) \left( \Omega_m \cdot \nabla \right) v(\mathbf{r}) \ \text{d}(\mathbf{r}) + \int_{\partial T_{\text{out}}} \left( \Omega_m \cdot \vec{n}(\mathbf{r}) \right) \Psi_{m,g}(\mathbf{r}) v(\mathbf{r}) \ \text{d}(\mathbf{r}) \quad \forall m \end{align*}
</p>
<p>and the right hand side is the discretized version of the <b>linear</b> forms</p>
<p class="formulaDsp">
\begin{align*} Q_{m,g}(v) - \mathcal{L}_{D,m,g} (v) = \int_T Q_{m,g}(\mathbf{r}) v(\mathbf{r}) \ \text{d}(\mathbf{r}) + \int_{\partial T_{\text{in}}} \left( \Omega_m \cdot \vec{n}(\mathbf{r}) \right) \Psi_{m,g}^{\text{in}} (\mathbf{r}) v(\mathbf{r}) \ \text{d}(\mathbf{r}) \quad \forall m \end{align*}
</p>
<h2>Reflective Boundary Conditions.</h2>
<p>Reflective boundary conditions can be written as</p>
<p class="formulaDsp">
\begin{align*} &amp; \Psi_{m,g}(\mathbf{r}) = \Psi_{m,g}^{\text{in}}(\mathbf{r}) := \beta_{m&#39;,g} \Psi_{m&#39;,g}^{\text{out}}(\mathbf{r}) , \quad n(\mathbf{r})\cdot \Omega_m &lt; 0 \quad \forall m,g \quad \forall \mathbf{r} \in \Gamma_{R} \end{align*}
</p>
<p>being \( \Gamma_{R}\) the boundary with reflecting boundary conditions. It is important to notice that the index \( m&#39; \) representing the outgoing direction that will enter as an incoming direction for \( m \) is calculated by</p>
<p class="formulaDsp">
\begin{align*} \Omega_{m&#39;} := \Omega_m - 2 \vec{n}(\mathcal{r}) (\Omega_m \cdot \vec{n}(\mathcal{r})) \end{align*}
</p>
<p>and directly depends on the normal vector to the particular face, so it will be different for every face orientation.</p>
<p>Here we drop the group index for simplicity. In order to clarify the coupling between the different directions, we can write the complete streaming operator containing all the directions as</p>
<p class="formulaDsp">
\begin{align*} L := \left( \begin{array}{cccc} L_{0,m} &amp; \ldots &amp; \ldots &amp; \\ \ldots &amp; L_{0,m} &amp; \beta_{m} L_{R,m&#39;} &amp; \ldots \\ \ldots &amp; \beta_{n&#39;} L_{R,n&#39;} &amp; L_{0,n} &amp; \ldots \\ &amp; \ldots &amp; \ldots &amp; L_{0,M} \end{array} \right) = L_{0} + L_{R} \end{align*}
</p>
<p>meaning that using one of the rows of the matrix L and multiplying for the vector of all the directions we get</p>
<p class="formulaDsp">
\begin{align*} L_{0,m} \Psi_{m} + \beta_{m&#39;} L_{R,m&#39;} \Psi_{m&#39;} + \beta_{m&#39;&#39;} L_{R,m&#39;&#39;} \Psi_{m&#39;&#39;} + \ldots \end{align*}
</p>
<p>Here we notice that one direction can have more than one outgoing direction associated, with a maximum of one per each different oriented face of the boundary.</p>
<p>We also notice that the boundary values, when lagged from a previous iteration, will be stored in a compressed form, meaning that only the values related to significant degrees of freedom are stored, representing them as \( \Psi_{S} \), and they can be obtained by applying the projection matrix \( P \) to the vector containing all the degrees of freedom, as follows</p>
<p class="formulaDsp">
\begin{align*} \Psi_S = P^{T}*\Psi , \quad \iff \quad \Psi = P*\Psi_{S} \end{align*}
</p>
<p>so the matrix \( L_R \) should be applied as follows</p>
<p class="formulaDsp">
\begin{align*} - L_{R}*\Psi := - L_{R}*P*\Psi_{S} . \end{align*}
</p>
<dl class="section note"><dt>Note</dt><dd>The notation is inspired from <a class="el" href="citelist.html#CITEREF_warsa2004krylov">[1]</a> .</dd>
<dd>
It is important to notice here that the relations between the incoming and outgoing directions does not depends on the group, discretization. Nevertheless, the notation is maintained because the incoming flux, if provided, will most probably depend on each group, and the albedo factor applied to the reflective boundary conditions too.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000094">Todo:</a></b></dt><dd>do I need this? </dd></dl>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> get_albedos ();</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="eq__transport_8h_source.html#l00028">28</a> of file <a class="el" href="eq__transport_8h_source.html">eq_transport.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="ab0b027500ccb031c3a7352d3e5ae15d3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classdealii_1_1DoFHandler.html">DoFHandler</a>&lt;dim, dim&gt;::face_iterator <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::<a class="el" href="classForest_1_1BoundaryValues.html#ab0b027500ccb031c3a7352d3e5ae15d3">f_iter</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Short name for the face iterator. </p>

<p>Definition at line <a class="el" href="boundaryvalues_8h_source.html#l00209">209</a> of file <a class="el" href="boundaryvalues_8h_source.html">boundaryvalues.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9b1d07829097331ddaba5b1fcecdff1f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classdealii_1_1DoFHandler.html">DoFHandler</a>&lt;dim, dim&gt;::active_cell_iterator <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::<a class="el" href="classForest_1_1BoundaryValues.html#a9b1d07829097331ddaba5b1fcecdff1f">c_iter</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Short name for the cell iterator. </p>

<p>Definition at line <a class="el" href="boundaryvalues_8h_source.html#l00212">212</a> of file <a class="el" href="boundaryvalues_8h_source.html">boundaryvalues.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aca15ecc7c018ae04b11fc45e14f99378"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::<a class="el" href="classForest_1_1BoundaryValues.html">BoundaryValues</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classForest_1_1State.html">State</a>&lt; dim &gt; &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classForest_1_1QuadratureBase.html">QuadratureBase</a>&lt; dim &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>ord</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor using the information in <code>state</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td></td></tr>
    <tr><td class="paramname">ord</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="boundaryvalues_8cc_source.html#l00038">38</a> of file <a class="el" href="boundaryvalues_8cc_source.html">boundaryvalues.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      : <a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a> (state),</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <a class="code" href="classForest_1_1BoundaryValues.html#a71667d3e2d6389cf0ea75933018b0bd2">mp_ord</a> (ord),</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">m_fe_sup_on_face</a> (GeometryInfo&lt;dim&gt;::faces_per_cell)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">/* We initialize this vector. */</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keyword">const</span> <a class="code" href="classdealii_1_1FiniteElement.html">FiniteElement&lt;dim, dim&gt;</a> &amp; fe (<a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.get_fe ());</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; GeometryInfo&lt;dim&gt;::faces_per_cell; ++f)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; fe.dofs_per_cell; ++i)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">if</span> (fe.has_support_on_face (i, f))</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;          <a class="code" href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">m_fe_sup_on_face</a>[f].push_back (i);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;          <span class="comment">//std::cout &lt;&lt; &quot;m_fe_sup_on_face[f].push_back (i) = &quot; &lt;&lt; f &lt;&lt; &quot;  &quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;          <span class="comment">//    &lt;&lt; i &lt;&lt; std::endl; /* bugs*/</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">/* Initialize the memory for the vectors. */</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="classForest_1_1BoundaryValues.html#a8666bcf626564f9aa7ba335ad9262a74">init</a> ();</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  }</div><div class="ttc" id="classdealii_1_1FiniteElement_html"><div class="ttname"><a href="classdealii_1_1FiniteElement.html">dealii::FiniteElement&lt; dim, dim &gt;</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a62fbb23a2de5168fab1b19df83845703"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">Forest::BoundaryValues::mp_state</a></div><div class="ttdeci">State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Pointer to state object. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00215">boundaryvalues.h:215</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a8666bcf626564f9aa7ba335ad9262a74"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a8666bcf626564f9aa7ba335ad9262a74">Forest::BoundaryValues::init</a></div><div class="ttdeci">void init()</div><div class="ttdoc">Initializing the data. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8cc_source.html#l00066">boundaryvalues.cc:66</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a71667d3e2d6389cf0ea75933018b0bd2"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a71667d3e2d6389cf0ea75933018b0bd2">Forest::BoundaryValues::mp_ord</a></div><div class="ttdeci">std::shared_ptr&lt; QuadratureBase&lt; dim &gt; &gt; &amp; mp_ord</div><div class="ttdoc">Pointer to quadrature object. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00218">boundaryvalues.h:218</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_adc790104b7688c60713072116ed8f5c6"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">Forest::BoundaryValues::m_fe_sup_on_face</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; unsigned int &gt; &gt; m_fe_sup_on_face</div><div class="ttdoc">For running over the dofs of the face and skipping the interiors. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00225">boundaryvalues.h:225</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1BoundaryValues_aca15ecc7c018ae04b11fc45e14f99378_cgraph.png" border="0" usemap="#classForest_1_1BoundaryValues_aca15ecc7c018ae04b11fc45e14f99378_cgraph" alt=""/></div>
<map name="classForest_1_1BoundaryValues_aca15ecc7c018ae04b11fc45e14f99378_cgraph" id="classForest_1_1BoundaryValues_aca15ecc7c018ae04b11fc45e14f99378_cgraph">
<area shape="rect" id="node2" href="classForest_1_1BoundaryValues.html#a8666bcf626564f9aa7ba335ad9262a74" title="Initializing the data. " alt="" coords="216,71,379,112"/>
<area shape="rect" id="node3" href="classForest_1_1BoundaryValues.html#a10ea25aaae629a54d139efe08446e58e" title="Collect the albedo faces for direction i_ord. " alt="" coords="427,5,589,47"/>
<area shape="rect" id="node4" href="classForest_1_1BoundaryValues.html#a7663664c05d831ca86c3e0c99f6f1271" title="Collect the albedo faces for direction i_ord. " alt="" coords="427,71,589,112"/>
<area shape="rect" id="node5" href="classForest_1_1BoundaryValues.html#ae1b3e901a3367f63eaef282c144d822e" title="Forest::BoundaryValues\l::set_global_to_bc_data" alt="" coords="427,136,589,177"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a32cc58a4a8711849f3c7215811331d83"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::apply_reflective </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdealii_1_1Vector.html">Vector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>src_m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdealii_1_1BlockVector.html">BlockVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>psi_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>i_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>f_bc_ind</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>apply the boundary conditions in <code>psi_s</code> for direction <code>i_ord</code> to the flux <code>src_m</code> </p>
<p>For group <code>g</code>, <code>psi_s</code> contains the significant dofs for the boundary conditions, and these are applied to the vector <code>src_m</code> ( \( Q_m \))</p>
<p class="formulaDsp">
\begin{align*} Q_{m,g} = Q_{m,g} - L_{R,m&#39;,g}*\Psi_{m&#39;,g} - L_{R,m&#39;&#39;,g}*\Psi_{m&#39;&#39;,g} - \ldots , \end{align*}
</p>
<p>but it does using the vector of the significant boundary values <code>phi_s</code> ( \( \Psi_{S,g} \)) as follows</p>
<p class="formulaDsp">
\begin{align*} Q_{m,g} = Q_{m,g} - L_{R,g}*P*\Psi_{S,g} . \end{align*}
</p>
<dl class="section note"><dt>Note</dt><dd>The notation for \( -L_{R}*P*\psi_R \) is coming from the article <a class="el" href="citelist.html#CITEREF_warsa2004krylov">[1]</a> : "Krylov iterative methods applied to multidimensional Sn calculations in
the presence of material discontinuities". </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src_m</td><td></td></tr>
    <tr><td class="paramname">psi_s</td><td>The significant values of the boundary conditions. </td></tr>
    <tr><td class="paramname">g</td><td>The energy group. </td></tr>
    <tr><td class="paramname">i_dir</td><td>The incoming direction. </td></tr>
    <tr><td class="paramname">f_bc_ind</td><td>= 0 First index for the boundary condition. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="boundaryvalues_8cc_source.html#l00284">284</a> of file <a class="el" href="boundaryvalues_8cc_source.html">boundaryvalues.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    Point&lt;dim&gt; beta = vector_to_point&lt;dim&gt; (<a class="code" href="classForest_1_1BoundaryValues.html#a71667d3e2d6389cf0ea75933018b0bd2">mp_ord</a>-&gt;get_q (i_dir));</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// we get the finite elements</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keyword">const</span> <a class="code" href="classdealii_1_1FiniteElement.html">FiniteElement&lt;dim, dim&gt;</a> &amp; fe (<a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.get_fe ());</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    QGauss&lt;dim - 1&gt; face_quadrature (fe.degree + 1);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keyword">const</span> UpdateFlags face_update_flags = update_values | update_JxW_values</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                          | update_quadrature_points</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                          | update_normal_vectors;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    FEFaceValues&lt;dim&gt; fe_values_face (<a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.get_mapping (), fe,</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        face_quadrature, face_update_flags);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_face = std::pow(fe.degree + 1, dim-1);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="classdealii_1_1Vector.html">Vector&lt;double&gt;</a> cell_src (dofs_per_face), cell_dst (dofs_per_face);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    std::vector&lt;unsigned int&gt; l_dof_ind (fe.dofs_per_cell);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keyword">typename</span> std::multimap&lt;c_iter, unsigned int&gt;::iterator it;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">for</span> (it = <a class="code" href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">m_i_faces</a>[i_dir].begin (); it != <a class="code" href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">m_i_faces</a>[i_dir].end (); ++it)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <a class="code" href="classForest_1_1BoundaryValues.html#a9b1d07829097331ddaba5b1fcecdff1f">c_iter</a> cell = it-&gt;first;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = it-&gt;second;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <a class="code" href="classForest_1_1BoundaryValues.html#ab0b027500ccb031c3a7352d3e5ae15d3">f_iter</a> face = cell-&gt;face (f);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      fe_values_face.reinit (cell, f);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keyword">const</span> std::vector&lt;double&gt; &amp;JxW = fe_values_face.get_JxW_values ();</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="comment">/* Get normal outward vector to the face. */</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keyword">const</span> Tensor&lt;1, dim&gt; &amp;n0 = fe_values_face.normal_vector (0);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordtype">double</span> alb_bv = 1.0;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="comment">//-----------------------------------------------------------------------</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"></span>      <span class="comment">//-----------------------------------------------------------------------</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      cell-&gt;get_dof_indices (l_dof_ind); <span class="comment">/* local dof indices*/</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      cell_dst = 0;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="comment">// The faces are straight lines, so the normals are independent of</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="comment">// the quadrature point</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> beta_n = beta * n0;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; fe_values_face.n_quadrature_points; ++q)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordtype">double</span> cell_src_q = 0;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">m_fe_sup_on_face</a>[f].size (); ++j)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> jj = <a class="code" href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">m_fe_sup_on_face</a>[f][j];</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;          cell_src_q += psi_s.block (f_bc_ind + i_dir) (</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                            <a class="code" href="classForest_1_1BoundaryValues.html#ad23ad159d9575db6e871aa735cf9bb6a">m_g2s_dofs</a>[i_dir][l_dof_ind[jj]])</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                        * fe_values_face.shape_value (jj, q);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">m_fe_sup_on_face</a>[f].size (); ++i)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = <a class="code" href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">m_fe_sup_on_face</a>[f][i];</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;          cell_dst (i) -= beta_n * cell_src_q * alb_bv</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                          * fe_values_face.shape_value (ii, q) * JxW[q];</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      }</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">m_fe_sup_on_face</a>[f].size (); ++i)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = <a class="code" href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">m_fe_sup_on_face</a>[f][i];</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        src_m[l_dof_ind[ii]] += cell_dst (i);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  }</div><div class="ttc" id="classForest_1_1BoundaryValues_html_ab0b027500ccb031c3a7352d3e5ae15d3"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#ab0b027500ccb031c3a7352d3e5ae15d3">Forest::BoundaryValues::f_iter</a></div><div class="ttdeci">DoFHandler&lt; dim, dim &gt;::face_iterator f_iter</div><div class="ttdoc">Short name for the face iterator. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00209">boundaryvalues.h:209</a></div></div>
<div class="ttc" id="classdealii_1_1FiniteElement_html"><div class="ttname"><a href="classdealii_1_1FiniteElement.html">dealii::FiniteElement&lt; dim, dim &gt;</a></div></div>
<div class="ttc" id="classdealii_1_1Vector_html"><div class="ttname"><a href="classdealii_1_1Vector.html">dealii::Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_ad23ad159d9575db6e871aa735cf9bb6a"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#ad23ad159d9575db6e871aa735cf9bb6a">Forest::BoundaryValues::m_g2s_dofs</a></div><div class="ttdeci">std::vector&lt; std::map&lt; unsigned int, unsigned int &gt; &gt; m_g2s_dofs</div><div class="ttdoc">The matrix  extracting significant dofs for bcs. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00254">boundaryvalues.h:254</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a62fbb23a2de5168fab1b19df83845703"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">Forest::BoundaryValues::mp_state</a></div><div class="ttdeci">State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Pointer to state object. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00215">boundaryvalues.h:215</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a9b1d07829097331ddaba5b1fcecdff1f"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a9b1d07829097331ddaba5b1fcecdff1f">Forest::BoundaryValues::c_iter</a></div><div class="ttdeci">DoFHandler&lt; dim, dim &gt;::active_cell_iterator c_iter</div><div class="ttdoc">Short name for the cell iterator. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00212">boundaryvalues.h:212</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a7e2527ac3d0fc92736bfe8c4fe0ca8c1"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">Forest::BoundaryValues::m_i_faces</a></div><div class="ttdeci">std::vector&lt; std::multimap&lt; c_iter, unsigned int &gt; &gt; m_i_faces</div><div class="ttdoc">Container for the incoming faces. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00239">boundaryvalues.h:239</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a71667d3e2d6389cf0ea75933018b0bd2"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a71667d3e2d6389cf0ea75933018b0bd2">Forest::BoundaryValues::mp_ord</a></div><div class="ttdeci">std::shared_ptr&lt; QuadratureBase&lt; dim &gt; &gt; &amp; mp_ord</div><div class="ttdoc">Pointer to quadrature object. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00218">boundaryvalues.h:218</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_adc790104b7688c60713072116ed8f5c6"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">Forest::BoundaryValues::m_fe_sup_on_face</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; unsigned int &gt; &gt; m_fe_sup_on_face</div><div class="ttdoc">For running over the dofs of the face and skipping the interiors. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00225">boundaryvalues.h:225</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa8cf7e61828838bcc2ed7fd6e5ab5e67"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::get_reflective </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdealii_1_1BlockVector.html">BlockVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>psi_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdealii_1_1Vector.html">Vector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>psi_m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>o_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>f_bc_ind</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Collect the outgoing flux for direction <code>o_dir</code> to incoming flux. </p>
<p>Get the outgoing flux in direction <code>o_dir</code> and store it in <code>psi_s</code> for the corresponding incoming direction when it applies. The notation for this function would be the operator \( P^{T} \), which applied to the vector with the degrees of freedoms for all the fluxes restrict the vector to only the significant degrees of freedom, obtaining</p>
<p class="formulaDsp">
\begin{align*} \Psi_{S,g} = P^{T}\Psi_{g} , \end{align*}
</p>
<p>Because it is applied for a vector with a particular outgoing direction, it actually the corresponding incoming direction for every type of face, and store this part of the significant degrees of freedom</p>
<p class="formulaDsp">
\begin{align*} \left \{ \begin{array}{l} \Psi_{S,m&#39;} = P_{m&#39;}^{T}\Psi^{\text{in}}_{m&#39;,g} := P_{m&#39;}^{T}\Psi^{\text{out}}_{m,g} , \\ \Psi_{S,m&#39;&#39;} = P_{m&#39;&#39;}^{T}\Psi^{\text{in}}_{m&#39;&#39;,g} := P_{m&#39;&#39;}^{T}\Psi^{\text{out}}_{m,g} , \\ \quad \vdots \end{array} \right . \end{align*}
</p>
<p>Where in this case the outgoing direction \( m \) has the incoming directions \( m&#39;, m&#39;&#39;, \ldots \) .</p>
<dl class="section note"><dt>Note</dt><dd>The notation for \( P^{T} \) is coming from the article <a class="el" href="citelist.html#CITEREF_warsa2004krylov">[1]</a> : "Krylov iterative methods applied to multidimensional
Sn calculations in the presence of material discontinuities". </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">psi_s</td><td>Vector with the boundary conditions. </td></tr>
    <tr><td class="paramname">psi_m</td><td></td></tr>
    <tr><td class="paramname">o_dir</td><td>Outgoing direction of the flux that will be redistributed in the corresponding ingoing directions. </td></tr>
    <tr><td class="paramname">f_bc_ind</td><td>= 0. First index for the boundary condition.</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000095">Todo:</a></b></dt><dd>I am not sure about this line ... </dd></dl>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (face-&gt;boundary_id () != f)</div><div class="line">  <span class="keywordflow">continue</span>;</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="boundaryvalues_8cc_source.html#l00379">379</a> of file <a class="el" href="boundaryvalues_8cc_source.html">boundaryvalues.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  {</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keyword">const</span> <a class="code" href="classdealii_1_1FiniteElement.html">FiniteElement&lt;dim, dim&gt;</a> &amp; fe (<a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.get_fe ());</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">/* the dofs_per_face is not well defined in 1d, so we set it up manually. */</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_face = std::pow(fe.degree + 1, dim-1);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    std::vector&lt;types::global_dof_index&gt; l_dof_ind (fe.dofs_per_cell);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; GeometryInfo&lt;dim&gt;::faces_per_cell; ++f)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="comment">/* Identify incoming dir. i_dir associated with o_dir at each face. */</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_dir = <a class="code" href="classForest_1_1BoundaryValues.html#a71667d3e2d6389cf0ea75933018b0bd2">mp_ord</a>-&gt;out2in[f][o_dir];</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="comment">/* The ougoing flux is not inserted back by reflection. */</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">if</span> (i_dir == (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) -1)</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="comment">/* This face, f, does not have reflecting bcs. */</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.mp_data.mp_geom.m_core.m_bcs[f] == 2)</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keyword">typename</span> std::multimap&lt;c_iter, unsigned int&gt;::iterator it;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">for</span> (it = <a class="code" href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">m_i_faces</a>[i_dir].begin (); it != <a class="code" href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">m_i_faces</a>[i_dir].end (); ++it)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          <a class="code" href="classForest_1_1BoundaryValues.html#a9b1d07829097331ddaba5b1fcecdff1f">c_iter</a> cell = it-&gt;first;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face_no = it-&gt;second;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          <a class="code" href="classForest_1_1BoundaryValues.html#ab0b027500ccb031c3a7352d3e5ae15d3">f_iter</a> face = cell-&gt;face (face_no);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;          <span class="comment">/* @todo I am not sure about this...? */</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          <span class="keywordflow">if</span> (face-&gt;boundary_id () != f)</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;          {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          cell-&gt;get_dof_indices (l_dof_ind);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_face; ++i)</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;          {</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = <a class="code" href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">m_fe_sup_on_face</a>[face_no][i];</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            psi_s.block (f_bc_ind + i_dir)[<a class="code" href="classForest_1_1BoundaryValues.html#ad23ad159d9575db6e871aa735cf9bb6a">m_g2s_dofs</a>[i_dir][l_dof_ind[ii]]] =</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                psi_m[l_dof_ind[ii]];</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;          }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      {</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="comment">// If it is not a reflective boundary it should be &quot;zero incoming flux&quot;</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="comment">// until I add the option of &quot;given incoming flux&quot;</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="comment">//psi_s.block (f_bc_ind + i_dir) = 0.;</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  }</div><div class="ttc" id="classForest_1_1BoundaryValues_html_ab0b027500ccb031c3a7352d3e5ae15d3"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#ab0b027500ccb031c3a7352d3e5ae15d3">Forest::BoundaryValues::f_iter</a></div><div class="ttdeci">DoFHandler&lt; dim, dim &gt;::face_iterator f_iter</div><div class="ttdoc">Short name for the face iterator. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00209">boundaryvalues.h:209</a></div></div>
<div class="ttc" id="classdealii_1_1FiniteElement_html"><div class="ttname"><a href="classdealii_1_1FiniteElement.html">dealii::FiniteElement&lt; dim, dim &gt;</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_ad23ad159d9575db6e871aa735cf9bb6a"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#ad23ad159d9575db6e871aa735cf9bb6a">Forest::BoundaryValues::m_g2s_dofs</a></div><div class="ttdeci">std::vector&lt; std::map&lt; unsigned int, unsigned int &gt; &gt; m_g2s_dofs</div><div class="ttdoc">The matrix  extracting significant dofs for bcs. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00254">boundaryvalues.h:254</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a62fbb23a2de5168fab1b19df83845703"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">Forest::BoundaryValues::mp_state</a></div><div class="ttdeci">State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Pointer to state object. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00215">boundaryvalues.h:215</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a9b1d07829097331ddaba5b1fcecdff1f"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a9b1d07829097331ddaba5b1fcecdff1f">Forest::BoundaryValues::c_iter</a></div><div class="ttdeci">DoFHandler&lt; dim, dim &gt;::active_cell_iterator c_iter</div><div class="ttdoc">Short name for the cell iterator. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00212">boundaryvalues.h:212</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a7e2527ac3d0fc92736bfe8c4fe0ca8c1"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">Forest::BoundaryValues::m_i_faces</a></div><div class="ttdeci">std::vector&lt; std::multimap&lt; c_iter, unsigned int &gt; &gt; m_i_faces</div><div class="ttdoc">Container for the incoming faces. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00239">boundaryvalues.h:239</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a71667d3e2d6389cf0ea75933018b0bd2"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a71667d3e2d6389cf0ea75933018b0bd2">Forest::BoundaryValues::mp_ord</a></div><div class="ttdeci">std::shared_ptr&lt; QuadratureBase&lt; dim &gt; &gt; &amp; mp_ord</div><div class="ttdoc">Pointer to quadrature object. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00218">boundaryvalues.h:218</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_adc790104b7688c60713072116ed8f5c6"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">Forest::BoundaryValues::m_fe_sup_on_face</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; unsigned int &gt; &gt; m_fe_sup_on_face</div><div class="ttdoc">For running over the dofs of the face and skipping the interiors. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00225">boundaryvalues.h:225</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a001043723110c7f020edde8ec2cce224"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::memory_consumption </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate memory consumption for this class. </p>
<dl class="section return"><dt>Returns</dt><dd>Return the memory consumption. </dd></dl>

<p>Definition at line <a class="el" href="boundaryvalues_8h_source.html#l00353">353</a> of file <a class="el" href="boundaryvalues_8h_source.html">boundaryvalues.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="classForest_1_1BoundaryValues.html#a001043723110c7f020edde8ec2cce224">memory_consumption</a> = 0;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      memory_consumption += <span class="keyword">sizeof</span>(<a class="code" href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">m_i_faces</a>) + <span class="keyword">sizeof</span>(<a class="code" href="classForest_1_1BoundaryValues.html#a965cc443482b36db1801948586d9bc2a">m_o_faces</a>)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                            + <span class="keyword">sizeof</span>(<a class="code" href="classForest_1_1BoundaryValues.html#ad23ad159d9575db6e871aa735cf9bb6a">m_g2s_dofs</a>)</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                            + <span class="keyword">sizeof</span>(<a class="code" href="classForest_1_1BoundaryValues.html#a29e7c8ab2a0ee2327321fb9495670b3c">m_dofs_in_bc</a>);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classForest_1_1BoundaryValues.html#a001043723110c7f020edde8ec2cce224">memory_consumption</a>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    }</div><div class="ttc" id="classForest_1_1BoundaryValues_html_a001043723110c7f020edde8ec2cce224"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a001043723110c7f020edde8ec2cce224">Forest::BoundaryValues::memory_consumption</a></div><div class="ttdeci">double memory_consumption() const </div><div class="ttdoc">Calculate memory consumption for this class. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00353">boundaryvalues.h:353</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_ad23ad159d9575db6e871aa735cf9bb6a"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#ad23ad159d9575db6e871aa735cf9bb6a">Forest::BoundaryValues::m_g2s_dofs</a></div><div class="ttdeci">std::vector&lt; std::map&lt; unsigned int, unsigned int &gt; &gt; m_g2s_dofs</div><div class="ttdoc">The matrix  extracting significant dofs for bcs. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00254">boundaryvalues.h:254</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a29e7c8ab2a0ee2327321fb9495670b3c"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a29e7c8ab2a0ee2327321fb9495670b3c">Forest::BoundaryValues::m_dofs_in_bc</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; m_dofs_in_bc</div><div class="ttdoc">Significant dofs for the incoming flux for every direction. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00257">boundaryvalues.h:257</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a7e2527ac3d0fc92736bfe8c4fe0ca8c1"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">Forest::BoundaryValues::m_i_faces</a></div><div class="ttdeci">std::vector&lt; std::multimap&lt; c_iter, unsigned int &gt; &gt; m_i_faces</div><div class="ttdoc">Container for the incoming faces. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00239">boundaryvalues.h:239</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a965cc443482b36db1801948586d9bc2a"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a965cc443482b36db1801948586d9bc2a">Forest::BoundaryValues::m_o_faces</a></div><div class="ttdeci">std::vector&lt; std::multimap&lt; c_iter, unsigned int &gt; &gt; m_o_faces</div><div class="ttdoc">Container for the outgoing faces. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00242">boundaryvalues.h:242</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6d1460ff156fa76397c913f74b7eb6f3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;unsigned int&gt;&amp; <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::get_block_sizes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Significant dofs for the incoming flux for every direction. </p>
<dl class="section return"><dt>Returns</dt><dd>A <code>n_angles</code> vector with the significant dofs for each direction. </dd></dl>

<p>Definition at line <a class="el" href="boundaryvalues_8h_source.html#l00367">367</a> of file <a class="el" href="boundaryvalues_8h_source.html">boundaryvalues.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classForest_1_1BoundaryValues.html#a29e7c8ab2a0ee2327321fb9495670b3c">m_dofs_in_bc</a>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div><div class="ttc" id="classForest_1_1BoundaryValues_html_a29e7c8ab2a0ee2327321fb9495670b3c"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a29e7c8ab2a0ee2327321fb9495670b3c">Forest::BoundaryValues::m_dofs_in_bc</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; m_dofs_in_bc</div><div class="ttdoc">Significant dofs for the incoming flux for every direction. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00257">boundaryvalues.h:257</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a98b03d6ef11409df3e521ddd22846e3d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::get_block_sizes </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>i_ord</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the number of degrees of freedom for direction <code>i_ord</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i_ord</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>significant dofs for direction <code>i_ord</code>. </dd></dl>

<p>Definition at line <a class="el" href="boundaryvalues_8h_source.html#l00378">378</a> of file <a class="el" href="boundaryvalues_8h_source.html">boundaryvalues.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classForest_1_1BoundaryValues.html#a29e7c8ab2a0ee2327321fb9495670b3c">m_dofs_in_bc</a>[i_ord];</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div><div class="ttc" id="classForest_1_1BoundaryValues_html_a29e7c8ab2a0ee2327321fb9495670b3c"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a29e7c8ab2a0ee2327321fb9495670b3c">Forest::BoundaryValues::m_dofs_in_bc</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; m_dofs_in_bc</div><div class="ttdoc">Significant dofs for the incoming flux for every direction. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00257">boundaryvalues.h:257</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8666bcf626564f9aa7ba335ad9262a74"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializing the data. </p>
<p>Necessary before using the class.</p>
<p>Here we use the information in quadrature and geom to set which faces are incoming faces for a particular direction, and the dofs are saved to apply the bcs faster in the next iterations. </p>

<p>Definition at line <a class="el" href="boundaryvalues_8cc_source.html#l00066">66</a> of file <a class="el" href="boundaryvalues_8cc_source.html">boundaryvalues.cc</a>.</p>

<p>Referenced by <a class="el" href="boundaryvalues_8cc_source.html#l00038">Forest::BoundaryValues&lt; dim &gt;::BoundaryValues()</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">const</span> <a class="code" href="classdealii_1_1FiniteElement.html">FiniteElement&lt;dim, dim&gt;</a> &amp; fe (<a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.get_fe ());</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_angles = <a class="code" href="classForest_1_1BoundaryValues.html#a71667d3e2d6389cf0ea75933018b0bd2">mp_ord</a>-&gt;get_n_angles ();</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">/* Fill the containers with the incoming faces and owners. */</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">m_i_faces</a>.resize (n_angles);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_angles; ++i)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="classForest_1_1BoundaryValues.html#a10ea25aaae629a54d139efe08446e58e">set_incoming_faces</a> (i);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">/* Fill the containers with the outgoing faces and owners. */</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="classForest_1_1BoundaryValues.html#a965cc443482b36db1801948586d9bc2a">m_o_faces</a>.resize (n_angles);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_angles; ++i)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <a class="code" href="classForest_1_1BoundaryValues.html#a7663664c05d831ca86c3e0c99f6f1271">set_outgoing_faces</a> (i);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">/* This is a check. If this is not fulfilled, something is wrong. */</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="comment">/* Count total number of incoming faces per energy group. */</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_faces_per_group = 0;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> o_faces_per_group = 0;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_angles; ++i)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        i_faces_per_group += <a class="code" href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">m_i_faces</a>[i].size ();</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        o_faces_per_group += <a class="code" href="classForest_1_1BoundaryValues.html#a965cc443482b36db1801948586d9bc2a">m_o_faces</a>[i].size ();</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="comment">/* Incoming and outgoing should be the same number. */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      Assert(i_faces_per_group == o_faces_per_group,</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;          ExcMessage(<span class="stringliteral">&quot;Incoming faces different from outgoing faces.&quot;</span>));</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="comment">/* After the check, we liberate the space used by m_o_faces. */</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <a class="code" href="classForest_1_1BoundaryValues.html#a965cc443482b36db1801948586d9bc2a">m_o_faces</a>.clear ();</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">/* Number of dofs per direction for the boundary conditions data. */</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_face = std::pow(fe.degree + 1, dim-1);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="classForest_1_1BoundaryValues.html#a29e7c8ab2a0ee2327321fb9495670b3c">m_dofs_in_bc</a>.resize (n_angles);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_angles; ++i)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <a class="code" href="classForest_1_1BoundaryValues.html#a29e7c8ab2a0ee2327321fb9495670b3c">m_dofs_in_bc</a>[i] = <a class="code" href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">m_i_faces</a>[i].size () * dofs_per_face;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">/* Set the global_to_bc_data vector. */</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="classForest_1_1BoundaryValues.html#ad23ad159d9575db6e871aa735cf9bb6a">m_g2s_dofs</a>.resize (n_angles);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; n_angles; ++i)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <a class="code" href="classForest_1_1BoundaryValues.html#ae1b3e901a3367f63eaef282c144d822e">set_global_to_bc_data</a> (i);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div><div class="ttc" id="classForest_1_1BoundaryValues_html_a7663664c05d831ca86c3e0c99f6f1271"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a7663664c05d831ca86c3e0c99f6f1271">Forest::BoundaryValues::set_outgoing_faces</a></div><div class="ttdeci">void set_outgoing_faces(unsigned int i_ord)</div><div class="ttdoc">Collect the albedo faces for direction i_ord. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8cc_source.html#l00185">boundaryvalues.cc:185</a></div></div>
<div class="ttc" id="classdealii_1_1FiniteElement_html"><div class="ttname"><a href="classdealii_1_1FiniteElement.html">dealii::FiniteElement&lt; dim, dim &gt;</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_ae1b3e901a3367f63eaef282c144d822e"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#ae1b3e901a3367f63eaef282c144d822e">Forest::BoundaryValues::set_global_to_bc_data</a></div><div class="ttdeci">void set_global_to_bc_data(unsigned int i_ord)</div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8cc_source.html#l00249">boundaryvalues.cc:249</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_ad23ad159d9575db6e871aa735cf9bb6a"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#ad23ad159d9575db6e871aa735cf9bb6a">Forest::BoundaryValues::m_g2s_dofs</a></div><div class="ttdeci">std::vector&lt; std::map&lt; unsigned int, unsigned int &gt; &gt; m_g2s_dofs</div><div class="ttdoc">The matrix  extracting significant dofs for bcs. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00254">boundaryvalues.h:254</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a62fbb23a2de5168fab1b19df83845703"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">Forest::BoundaryValues::mp_state</a></div><div class="ttdeci">State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Pointer to state object. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00215">boundaryvalues.h:215</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a29e7c8ab2a0ee2327321fb9495670b3c"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a29e7c8ab2a0ee2327321fb9495670b3c">Forest::BoundaryValues::m_dofs_in_bc</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; m_dofs_in_bc</div><div class="ttdoc">Significant dofs for the incoming flux for every direction. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00257">boundaryvalues.h:257</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a10ea25aaae629a54d139efe08446e58e"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a10ea25aaae629a54d139efe08446e58e">Forest::BoundaryValues::set_incoming_faces</a></div><div class="ttdeci">void set_incoming_faces(unsigned int i_ord)</div><div class="ttdoc">Collect the albedo faces for direction i_ord. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8cc_source.html#l00121">boundaryvalues.cc:121</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a7e2527ac3d0fc92736bfe8c4fe0ca8c1"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">Forest::BoundaryValues::m_i_faces</a></div><div class="ttdeci">std::vector&lt; std::multimap&lt; c_iter, unsigned int &gt; &gt; m_i_faces</div><div class="ttdoc">Container for the incoming faces. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00239">boundaryvalues.h:239</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a71667d3e2d6389cf0ea75933018b0bd2"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a71667d3e2d6389cf0ea75933018b0bd2">Forest::BoundaryValues::mp_ord</a></div><div class="ttdeci">std::shared_ptr&lt; QuadratureBase&lt; dim &gt; &gt; &amp; mp_ord</div><div class="ttdoc">Pointer to quadrature object. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00218">boundaryvalues.h:218</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a965cc443482b36db1801948586d9bc2a"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a965cc443482b36db1801948586d9bc2a">Forest::BoundaryValues::m_o_faces</a></div><div class="ttdeci">std::vector&lt; std::multimap&lt; c_iter, unsigned int &gt; &gt; m_o_faces</div><div class="ttdoc">Container for the outgoing faces. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00242">boundaryvalues.h:242</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1BoundaryValues_a8666bcf626564f9aa7ba335ad9262a74_cgraph.png" border="0" usemap="#classForest_1_1BoundaryValues_a8666bcf626564f9aa7ba335ad9262a74_cgraph" alt=""/></div>
<map name="classForest_1_1BoundaryValues_a8666bcf626564f9aa7ba335ad9262a74_cgraph" id="classForest_1_1BoundaryValues_a8666bcf626564f9aa7ba335ad9262a74_cgraph">
<area shape="rect" id="node2" href="classForest_1_1BoundaryValues.html#a10ea25aaae629a54d139efe08446e58e" title="Collect the albedo faces for direction i_ord. " alt="" coords="216,5,379,47"/>
<area shape="rect" id="node3" href="classForest_1_1BoundaryValues.html#a7663664c05d831ca86c3e0c99f6f1271" title="Collect the albedo faces for direction i_ord. " alt="" coords="216,71,379,112"/>
<area shape="rect" id="node4" href="classForest_1_1BoundaryValues.html#ae1b3e901a3367f63eaef282c144d822e" title="Forest::BoundaryValues\l::set_global_to_bc_data" alt="" coords="216,136,379,177"/>
</map>
</div>
</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1BoundaryValues_a8666bcf626564f9aa7ba335ad9262a74_icgraph.png" border="0" usemap="#classForest_1_1BoundaryValues_a8666bcf626564f9aa7ba335ad9262a74_icgraph" alt=""/></div>
<map name="classForest_1_1BoundaryValues_a8666bcf626564f9aa7ba335ad9262a74_icgraph" id="classForest_1_1BoundaryValues_a8666bcf626564f9aa7ba335ad9262a74_icgraph">
<area shape="rect" id="node2" href="classForest_1_1BoundaryValues.html#aca15ecc7c018ae04b11fc45e14f99378" title="Constructor using the information in state. " alt="" coords="216,5,379,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a10ea25aaae629a54d139efe08446e58e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::set_incoming_faces </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>i_ord</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Collect the albedo faces for direction i_ord. </p>
<p>When a face is albedo, we store the cell iterator of this face, together with the index representing this face for the cell, in a vector, for a particular direction. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i_ord</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="boundaryvalues_8cc_source.html#l00121">121</a> of file <a class="el" href="boundaryvalues_8cc_source.html">boundaryvalues.cc</a>.</p>

<p>Referenced by <a class="el" href="boundaryvalues_8cc_source.html#l00066">Forest::BoundaryValues&lt; dim &gt;::init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    std::multimap&lt;c_iter, unsigned int&gt; &amp; b_faces = <a class="code" href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">m_i_faces</a>[i_ord];</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    Point&lt;dim&gt; beta = vector_to_point&lt;dim&gt; (<a class="code" href="classForest_1_1BoundaryValues.html#a71667d3e2d6389cf0ea75933018b0bd2">mp_ord</a>-&gt;get_q (i_ord));</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">const</span> <a class="code" href="classdealii_1_1FiniteElement.html">FiniteElement&lt;dim, dim&gt;</a> &amp; fe (<a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.get_fe ());</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keyword">const</span> MappingQ1&lt;dim&gt; &amp; mapping (<a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.get_mapping ());</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    QGauss&lt;dim - 1&gt; face_quadrature (fe.degree + 1);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keyword">const</span> UpdateFlags face_update_flags = update_quadrature_points</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        | update_normal_vectors;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    FEFaceValues&lt;dim&gt; fe_values_face (mapping, fe, face_quadrature,</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        face_update_flags);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">/* clear the container before adding new elements with insert. */</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    b_faces.clear ();</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keyword">typename</span> <a class="code" href="classdealii_1_1DoFHandler.html">DoFHandler&lt;dim, dim&gt;::active_cell_iterator</a> cell, endc;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    cell = <a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.get_dof_handler ().begin_active ();</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    endc = <a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.get_dof_handler ().end ();</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">for</span> (; cell != endc; ++cell)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; GeometryInfo&lt;dim&gt;::faces_per_cell; ++f)</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="comment">/* face is the element we are interested. */</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="classForest_1_1BoundaryValues.html#ab0b027500ccb031c3a7352d3e5ae15d3">f_iter</a> face = cell-&gt;face (f);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">/* if face is not in a boundary we are not interested. */</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span> (not face-&gt;at_boundary ())</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="comment">/* If boundary face, but is not albedo, not interested. */</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment">/* unsigned int fbi = face-&gt;boundary_id ();</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">         if (mp_state.mp_data.mp_geom.core.bcs[fbi] != 2)</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">         {</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">         continue;</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">         } */</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="comment">/* Get normal outward vector to the face. */</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        fe_values_face.reinit (cell, f);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">/* if we are parallel to the boundary we are not interested. */</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keyword">const</span> Tensor&lt;1, dim&gt; &amp;n0 = fe_values_face.normal_vector (0);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">if</span> (std::abs (beta * n0) &lt; 1.e-10)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="comment">/* if it is an outgoing boundary we are not interested. */</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">if</span> (beta * n0 &gt; 0)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="comment">/* if passing all tests, the face is incoming or albedo boundary. */</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        b_faces.insert (std::pair&lt;c_iter, unsigned int&gt; (cell, f));</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div><div class="ttc" id="classForest_1_1BoundaryValues_html_ab0b027500ccb031c3a7352d3e5ae15d3"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#ab0b027500ccb031c3a7352d3e5ae15d3">Forest::BoundaryValues::f_iter</a></div><div class="ttdeci">DoFHandler&lt; dim, dim &gt;::face_iterator f_iter</div><div class="ttdoc">Short name for the face iterator. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00209">boundaryvalues.h:209</a></div></div>
<div class="ttc" id="classdealii_1_1FiniteElement_html"><div class="ttname"><a href="classdealii_1_1FiniteElement.html">dealii::FiniteElement&lt; dim, dim &gt;</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a62fbb23a2de5168fab1b19df83845703"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">Forest::BoundaryValues::mp_state</a></div><div class="ttdeci">State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Pointer to state object. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00215">boundaryvalues.h:215</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a7e2527ac3d0fc92736bfe8c4fe0ca8c1"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">Forest::BoundaryValues::m_i_faces</a></div><div class="ttdeci">std::vector&lt; std::multimap&lt; c_iter, unsigned int &gt; &gt; m_i_faces</div><div class="ttdoc">Container for the incoming faces. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00239">boundaryvalues.h:239</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a71667d3e2d6389cf0ea75933018b0bd2"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a71667d3e2d6389cf0ea75933018b0bd2">Forest::BoundaryValues::mp_ord</a></div><div class="ttdeci">std::shared_ptr&lt; QuadratureBase&lt; dim &gt; &gt; &amp; mp_ord</div><div class="ttdoc">Pointer to quadrature object. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00218">boundaryvalues.h:218</a></div></div>
<div class="ttc" id="classdealii_1_1DoFHandler_html"><div class="ttname"><a href="classdealii_1_1DoFHandler.html">dealii::DoFHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="diff__op__matrix__built_8h_source.html#l00026">diff_op_matrix_built.h:26</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1BoundaryValues_a10ea25aaae629a54d139efe08446e58e_icgraph.png" border="0" usemap="#classForest_1_1BoundaryValues_a10ea25aaae629a54d139efe08446e58e_icgraph" alt=""/></div>
<map name="classForest_1_1BoundaryValues_a10ea25aaae629a54d139efe08446e58e_icgraph" id="classForest_1_1BoundaryValues_a10ea25aaae629a54d139efe08446e58e_icgraph">
<area shape="rect" id="node2" href="classForest_1_1BoundaryValues.html#a8666bcf626564f9aa7ba335ad9262a74" title="Initializing the data. " alt="" coords="216,5,379,47"/>
<area shape="rect" id="node3" href="classForest_1_1BoundaryValues.html#aca15ecc7c018ae04b11fc45e14f99378" title="Constructor using the information in state. " alt="" coords="427,5,589,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7663664c05d831ca86c3e0c99f6f1271"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::set_outgoing_faces </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>i_ord</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Collect the albedo faces for direction i_ord. </p>
<p>Similar to <a class="el" href="classForest_1_1BoundaryValues.html#a10ea25aaae629a54d139efe08446e58e">set_incoming_faces</a>. For the moment, it is used only for checking that the ingoing faces are the same number of the outgoing faces. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i_ord</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="boundaryvalues_8cc_source.html#l00185">185</a> of file <a class="el" href="boundaryvalues_8cc_source.html">boundaryvalues.cc</a>.</p>

<p>Referenced by <a class="el" href="boundaryvalues_8cc_source.html#l00066">Forest::BoundaryValues&lt; dim &gt;::init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    std::multimap&lt;c_iter, unsigned int&gt; &amp; b_faces = <a class="code" href="classForest_1_1BoundaryValues.html#a965cc443482b36db1801948586d9bc2a">m_o_faces</a>[i_ord];</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    Point&lt;dim&gt; beta = vector_to_point&lt;dim&gt; (<a class="code" href="classForest_1_1BoundaryValues.html#a71667d3e2d6389cf0ea75933018b0bd2">mp_ord</a>-&gt;get_q (i_ord));</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keyword">const</span> <a class="code" href="classdealii_1_1FiniteElement.html">FiniteElement&lt;dim, dim&gt;</a> &amp; fe (<a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.get_fe ());</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keyword">const</span> MappingQ1&lt;dim&gt; &amp; mapping (<a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.get_mapping ());</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    QGauss&lt;dim - 1&gt; face_quadrature (fe.degree + 1);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keyword">const</span> UpdateFlags face_update_flags = update_quadrature_points</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        | update_normal_vectors;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    FEFaceValues&lt;dim&gt; fe_values_face (mapping, fe, face_quadrature,</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        face_update_flags);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// clear the container before adding new elements with insert</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    b_faces.clear ();</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keyword">typename</span> <a class="code" href="classdealii_1_1DoFHandler.html">DoFHandler&lt;dim, dim&gt;::active_cell_iterator</a> cell, endc;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    cell = <a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.get_dof_handler ().begin_active ();</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    endc = <a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.get_dof_handler ().end ();</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">for</span> (; cell != endc; ++cell)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; GeometryInfo&lt;dim&gt;::faces_per_cell; ++f)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment">/* Face is the element we are interested in. */</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <a class="code" href="classForest_1_1BoundaryValues.html#ab0b027500ccb031c3a7352d3e5ae15d3">f_iter</a> face = cell-&gt;face (f);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="comment">/* If face is not in a boundary we are not interested. */</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">if</span> (not face-&gt;at_boundary ())</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="comment">/* If boundary face, but is not incoming (or albedo), not interested. */</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="comment">/* unsigned int fbi = face-&gt;boundary_id ();</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">         if (mp_state.mp_data.mp_geom.core.bcs[fbi] != 2)</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">         {</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">         continue;</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">         } */</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="comment">/* Get normal outward vector to the face. */</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        fe_values_face.reinit (cell, f);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keyword">const</span> Tensor&lt;1, dim&gt; &amp;n0 = fe_values_face.normal_vector (0);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">/* if we are parallel to the boundary we are not interested. */</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">if</span> (std::abs (beta * n0) &lt; 1.e-10)</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="comment">/* If it is an incoming boundary we are not interested. */</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">if</span> (beta * n0 &lt; 0)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="comment">// after passing all the previous tests, the face should be an</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="comment">// incoming or albedo boundary for the present direction, so we add</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="comment">// it to the container</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        b_faces.insert (std::pair&lt;c_iter, unsigned int&gt; (cell, f));</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  }</div><div class="ttc" id="classForest_1_1BoundaryValues_html_ab0b027500ccb031c3a7352d3e5ae15d3"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#ab0b027500ccb031c3a7352d3e5ae15d3">Forest::BoundaryValues::f_iter</a></div><div class="ttdeci">DoFHandler&lt; dim, dim &gt;::face_iterator f_iter</div><div class="ttdoc">Short name for the face iterator. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00209">boundaryvalues.h:209</a></div></div>
<div class="ttc" id="classdealii_1_1FiniteElement_html"><div class="ttname"><a href="classdealii_1_1FiniteElement.html">dealii::FiniteElement&lt; dim, dim &gt;</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a62fbb23a2de5168fab1b19df83845703"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">Forest::BoundaryValues::mp_state</a></div><div class="ttdeci">State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Pointer to state object. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00215">boundaryvalues.h:215</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a71667d3e2d6389cf0ea75933018b0bd2"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a71667d3e2d6389cf0ea75933018b0bd2">Forest::BoundaryValues::mp_ord</a></div><div class="ttdeci">std::shared_ptr&lt; QuadratureBase&lt; dim &gt; &gt; &amp; mp_ord</div><div class="ttdoc">Pointer to quadrature object. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00218">boundaryvalues.h:218</a></div></div>
<div class="ttc" id="classdealii_1_1DoFHandler_html"><div class="ttname"><a href="classdealii_1_1DoFHandler.html">dealii::DoFHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="diff__op__matrix__built_8h_source.html#l00026">diff_op_matrix_built.h:26</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a965cc443482b36db1801948586d9bc2a"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a965cc443482b36db1801948586d9bc2a">Forest::BoundaryValues::m_o_faces</a></div><div class="ttdeci">std::vector&lt; std::multimap&lt; c_iter, unsigned int &gt; &gt; m_o_faces</div><div class="ttdoc">Container for the outgoing faces. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00242">boundaryvalues.h:242</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1BoundaryValues_a7663664c05d831ca86c3e0c99f6f1271_icgraph.png" border="0" usemap="#classForest_1_1BoundaryValues_a7663664c05d831ca86c3e0c99f6f1271_icgraph" alt=""/></div>
<map name="classForest_1_1BoundaryValues_a7663664c05d831ca86c3e0c99f6f1271_icgraph" id="classForest_1_1BoundaryValues_a7663664c05d831ca86c3e0c99f6f1271_icgraph">
<area shape="rect" id="node2" href="classForest_1_1BoundaryValues.html#a8666bcf626564f9aa7ba335ad9262a74" title="Initializing the data. " alt="" coords="216,5,379,47"/>
<area shape="rect" id="node3" href="classForest_1_1BoundaryValues.html#aca15ecc7c018ae04b11fc45e14f99378" title="Constructor using the information in state. " alt="" coords="427,5,589,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae1b3e901a3367f63eaef282c144d822e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::set_global_to_bc_data </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>i_ord</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i_ord</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="boundaryvalues_8cc_source.html#l00249">249</a> of file <a class="el" href="boundaryvalues_8cc_source.html">boundaryvalues.cc</a>.</p>

<p>Referenced by <a class="el" href="boundaryvalues_8cc_source.html#l00066">Forest::BoundaryValues&lt; dim &gt;::init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    std::map&lt;unsigned int, unsigned int&gt; &amp; map_dofs = <a class="code" href="classForest_1_1BoundaryValues.html#ad23ad159d9575db6e871aa735cf9bb6a">m_g2s_dofs</a>[i_ord];</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    std::multimap&lt;c_iter, unsigned int&gt; &amp; b_faces = <a class="code" href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">m_i_faces</a>[i_ord];</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// clear the container before adding new elements with push_back</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    map_dofs.clear ();</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">/* Temporary vector with the local dofs indices. */</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keyword">const</span> <a class="code" href="classdealii_1_1FiniteElement.html">FiniteElement&lt;dim, dim&gt;</a> &amp; fe (<a class="code" href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">mp_state</a>.get_fe ());</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    std::vector&lt;types::global_dof_index&gt; l_dof_ind (fe.dofs_per_cell);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bc_ind = 0; <span class="comment">/* A different index for each dofs in the bc. */</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keyword">typename</span> std::multimap&lt;c_iter, unsigned int&gt;::iterator it;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">for</span> (it = b_faces.begin (); it != b_faces.end (); ++it)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    {</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <a class="code" href="classForest_1_1BoundaryValues.html#a9b1d07829097331ddaba5b1fcecdff1f">c_iter</a> cell = it-&gt;first;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = it-&gt;second;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <a class="code" href="classForest_1_1BoundaryValues.html#ab0b027500ccb031c3a7352d3e5ae15d3">f_iter</a> face = cell-&gt;face (f);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      cell-&gt;get_dof_indices (l_dof_ind);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">m_fe_sup_on_face</a>[f].size (); ++i, ++bc_ind)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = <a class="code" href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">m_fe_sup_on_face</a>[f][i];</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="comment">/* map_dofs.insert (</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">         *  std::pair&lt;unsigned int, unsigned int&gt; (l_dof_ind[ii], bc_ind)); */</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">/* make_pair implicitly deduce the type of the arguments. */</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        map_dofs.insert (std::make_pair (l_dof_ind[ii], bc_ind));</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  }</div><div class="ttc" id="classForest_1_1BoundaryValues_html_ab0b027500ccb031c3a7352d3e5ae15d3"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#ab0b027500ccb031c3a7352d3e5ae15d3">Forest::BoundaryValues::f_iter</a></div><div class="ttdeci">DoFHandler&lt; dim, dim &gt;::face_iterator f_iter</div><div class="ttdoc">Short name for the face iterator. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00209">boundaryvalues.h:209</a></div></div>
<div class="ttc" id="classdealii_1_1FiniteElement_html"><div class="ttname"><a href="classdealii_1_1FiniteElement.html">dealii::FiniteElement&lt; dim, dim &gt;</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_ad23ad159d9575db6e871aa735cf9bb6a"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#ad23ad159d9575db6e871aa735cf9bb6a">Forest::BoundaryValues::m_g2s_dofs</a></div><div class="ttdeci">std::vector&lt; std::map&lt; unsigned int, unsigned int &gt; &gt; m_g2s_dofs</div><div class="ttdoc">The matrix  extracting significant dofs for bcs. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00254">boundaryvalues.h:254</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a62fbb23a2de5168fab1b19df83845703"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a62fbb23a2de5168fab1b19df83845703">Forest::BoundaryValues::mp_state</a></div><div class="ttdeci">State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Pointer to state object. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00215">boundaryvalues.h:215</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a9b1d07829097331ddaba5b1fcecdff1f"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a9b1d07829097331ddaba5b1fcecdff1f">Forest::BoundaryValues::c_iter</a></div><div class="ttdeci">DoFHandler&lt; dim, dim &gt;::active_cell_iterator c_iter</div><div class="ttdoc">Short name for the cell iterator. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00212">boundaryvalues.h:212</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_a7e2527ac3d0fc92736bfe8c4fe0ca8c1"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">Forest::BoundaryValues::m_i_faces</a></div><div class="ttdeci">std::vector&lt; std::multimap&lt; c_iter, unsigned int &gt; &gt; m_i_faces</div><div class="ttdoc">Container for the incoming faces. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00239">boundaryvalues.h:239</a></div></div>
<div class="ttc" id="classForest_1_1BoundaryValues_html_adc790104b7688c60713072116ed8f5c6"><div class="ttname"><a href="classForest_1_1BoundaryValues.html#adc790104b7688c60713072116ed8f5c6">Forest::BoundaryValues::m_fe_sup_on_face</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; unsigned int &gt; &gt; m_fe_sup_on_face</div><div class="ttdoc">For running over the dofs of the face and skipping the interiors. </div><div class="ttdef"><b>Definition:</b> <a href="boundaryvalues_8h_source.html#l00225">boundaryvalues.h:225</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1BoundaryValues_ae1b3e901a3367f63eaef282c144d822e_icgraph.png" border="0" usemap="#classForest_1_1BoundaryValues_ae1b3e901a3367f63eaef282c144d822e_icgraph" alt=""/></div>
<map name="classForest_1_1BoundaryValues_ae1b3e901a3367f63eaef282c144d822e_icgraph" id="classForest_1_1BoundaryValues_ae1b3e901a3367f63eaef282c144d822e_icgraph">
<area shape="rect" id="node2" href="classForest_1_1BoundaryValues.html#a8666bcf626564f9aa7ba335ad9262a74" title="Initializing the data. " alt="" coords="216,5,379,47"/>
<area shape="rect" id="node3" href="classForest_1_1BoundaryValues.html#aca15ecc7c018ae04b11fc45e14f99378" title="Constructor using the information in state. " alt="" coords="427,5,589,47"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a62fbb23a2de5168fab1b19df83845703"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1State.html">State</a>&lt;dim&gt;&amp; <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::mp_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to state object. </p>

<p>Definition at line <a class="el" href="boundaryvalues_8h_source.html#l00215">215</a> of file <a class="el" href="boundaryvalues_8h_source.html">boundaryvalues.h</a>.</p>

<p>Referenced by <a class="el" href="boundaryvalues_8cc_source.html#l00284">Forest::BoundaryValues&lt; dim &gt;::apply_reflective()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00038">Forest::BoundaryValues&lt; dim &gt;::BoundaryValues()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00379">Forest::BoundaryValues&lt; dim &gt;::get_reflective()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00066">Forest::BoundaryValues&lt; dim &gt;::init()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00249">Forest::BoundaryValues&lt; dim &gt;::set_global_to_bc_data()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00121">Forest::BoundaryValues&lt; dim &gt;::set_incoming_faces()</a>, and <a class="el" href="boundaryvalues_8cc_source.html#l00185">Forest::BoundaryValues&lt; dim &gt;::set_outgoing_faces()</a>.</p>

</div>
</div>
<a class="anchor" id="a71667d3e2d6389cf0ea75933018b0bd2"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classForest_1_1QuadratureBase.html">QuadratureBase</a>&lt;dim&gt; &gt;&amp; <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::mp_ord</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to quadrature object. </p>

<p>Definition at line <a class="el" href="boundaryvalues_8h_source.html#l00218">218</a> of file <a class="el" href="boundaryvalues_8h_source.html">boundaryvalues.h</a>.</p>

<p>Referenced by <a class="el" href="boundaryvalues_8cc_source.html#l00284">Forest::BoundaryValues&lt; dim &gt;::apply_reflective()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00379">Forest::BoundaryValues&lt; dim &gt;::get_reflective()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00066">Forest::BoundaryValues&lt; dim &gt;::init()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00121">Forest::BoundaryValues&lt; dim &gt;::set_incoming_faces()</a>, and <a class="el" href="boundaryvalues_8cc_source.html#l00185">Forest::BoundaryValues&lt; dim &gt;::set_outgoing_faces()</a>.</p>

</div>
</div>
<a class="anchor" id="adc790104b7688c60713072116ed8f5c6"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;unsigned int&gt; &gt; <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::m_fe_sup_on_face</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For running over the dofs of the face and skipping the interiors. </p>
<p>For the indices f,i representing the face and the local dof for the face, it returns the dofs for the cell. </p>

<p>Definition at line <a class="el" href="boundaryvalues_8h_source.html#l00225">225</a> of file <a class="el" href="boundaryvalues_8h_source.html">boundaryvalues.h</a>.</p>

<p>Referenced by <a class="el" href="boundaryvalues_8cc_source.html#l00284">Forest::BoundaryValues&lt; dim &gt;::apply_reflective()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00038">Forest::BoundaryValues&lt; dim &gt;::BoundaryValues()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00379">Forest::BoundaryValues&lt; dim &gt;::get_reflective()</a>, and <a class="el" href="boundaryvalues_8cc_source.html#l00249">Forest::BoundaryValues&lt; dim &gt;::set_global_to_bc_data()</a>.</p>

</div>
</div>
<a class="anchor" id="a7e2527ac3d0fc92736bfe8c4fe0ca8c1"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::multimap&lt;<a class="el" href="classForest_1_1BoundaryValues.html#a9b1d07829097331ddaba5b1fcecdff1f">c_iter</a>, unsigned int&gt; &gt; <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::m_i_faces</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Container for the incoming faces. </p>
<p>This is intended to be used with an iterator for each direction <code>i</code> </p><div class="fragment"><div class="line"><span class="keyword">typename</span> std::multimap&lt;c_iter, unsigned int&gt;::iterator it;</div><div class="line"><span class="keywordflow">for</span> (it = <a class="code" href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">m_i_faces</a>[i].begin (); it != <a class="code" href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">m_i_faces</a>[i].end (); ++it)</div><div class="line">{</div><div class="line"><a class="code" href="classForest_1_1BoundaryValues.html#a9b1d07829097331ddaba5b1fcecdff1f">c_iter</a> cell = it-&gt;first;</div><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face_no = it-&gt;second;</div><div class="line">}</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="boundaryvalues_8h_source.html#l00239">239</a> of file <a class="el" href="boundaryvalues_8h_source.html">boundaryvalues.h</a>.</p>

<p>Referenced by <a class="el" href="boundaryvalues_8cc_source.html#l00284">Forest::BoundaryValues&lt; dim &gt;::apply_reflective()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00379">Forest::BoundaryValues&lt; dim &gt;::get_reflective()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00066">Forest::BoundaryValues&lt; dim &gt;::init()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00249">Forest::BoundaryValues&lt; dim &gt;::set_global_to_bc_data()</a>, and <a class="el" href="boundaryvalues_8cc_source.html#l00121">Forest::BoundaryValues&lt; dim &gt;::set_incoming_faces()</a>.</p>

</div>
</div>
<a class="anchor" id="a965cc443482b36db1801948586d9bc2a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::multimap&lt;<a class="el" href="classForest_1_1BoundaryValues.html#a9b1d07829097331ddaba5b1fcecdff1f">c_iter</a>, unsigned int&gt; &gt; <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::m_o_faces</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Container for the outgoing faces. </p>
<p>See <a class="el" href="classForest_1_1BoundaryValues.html#a7e2527ac3d0fc92736bfe8c4fe0ca8c1">m_i_faces</a> . </p>

<p>Definition at line <a class="el" href="boundaryvalues_8h_source.html#l00242">242</a> of file <a class="el" href="boundaryvalues_8h_source.html">boundaryvalues.h</a>.</p>

<p>Referenced by <a class="el" href="boundaryvalues_8cc_source.html#l00066">Forest::BoundaryValues&lt; dim &gt;::init()</a>, and <a class="el" href="boundaryvalues_8cc_source.html#l00185">Forest::BoundaryValues&lt; dim &gt;::set_outgoing_faces()</a>.</p>

</div>
</div>
<a class="anchor" id="ad23ad159d9575db6e871aa735cf9bb6a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::map&lt;unsigned int, unsigned int&gt; &gt; <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::m_g2s_dofs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The matrix \( P \) extracting significant dofs for bcs. </p>
<p>For a given direction <code>dir</code> , and a given dofs <code>i</code>, it gives me the significant index <code>i_s</code> to collect the dofs </p><div class="fragment"><div class="line">i_s = m_global_to_bc_data[dir][i]</div><div class="line">psi_s[dir][i_s] == psi[dir][i]</div></div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The notation is a short version of m_global_to_significant_dofs </dd></dl>

<p>Definition at line <a class="el" href="boundaryvalues_8h_source.html#l00254">254</a> of file <a class="el" href="boundaryvalues_8h_source.html">boundaryvalues.h</a>.</p>

<p>Referenced by <a class="el" href="boundaryvalues_8cc_source.html#l00284">Forest::BoundaryValues&lt; dim &gt;::apply_reflective()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00379">Forest::BoundaryValues&lt; dim &gt;::get_reflective()</a>, <a class="el" href="boundaryvalues_8cc_source.html#l00066">Forest::BoundaryValues&lt; dim &gt;::init()</a>, and <a class="el" href="boundaryvalues_8cc_source.html#l00249">Forest::BoundaryValues&lt; dim &gt;::set_global_to_bc_data()</a>.</p>

</div>
</div>
<a class="anchor" id="a29e7c8ab2a0ee2327321fb9495670b3c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;unsigned int&gt; <a class="el" href="classForest_1_1BoundaryValues.html">Forest::BoundaryValues</a>&lt; dim &gt;::m_dofs_in_bc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Significant dofs for the incoming flux for every direction. </p>

<p>Definition at line <a class="el" href="boundaryvalues_8h_source.html#l00257">257</a> of file <a class="el" href="boundaryvalues_8h_source.html">boundaryvalues.h</a>.</p>

<p>Referenced by <a class="el" href="boundaryvalues_8cc_source.html#l00066">Forest::BoundaryValues&lt; dim &gt;::init()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/lns/Codes/forest-public/mylib/include/algebra/<a class="el" href="eq__transport_8h_source.html">eq_transport.h</a></li>
<li>/home/lns/Codes/forest-public/mylib/include/neutronics/<a class="el" href="boundaryvalues_8h_source.html">boundaryvalues.h</a></li>
<li>/home/lns/Codes/forest-public/mylib/src/neutronics/<a class="el" href="boundaryvalues_8cc_source.html">boundaryvalues.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceForest.html">Forest</a></li><li class="navelem"><a class="el" href="classForest_1_1BoundaryValues.html">BoundaryValues</a></li>
    <li class="footer">Generated on Tue Oct 31 2017 19:23:33 for FOREST by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
