<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>FOREST: Forest::ExtractBV&lt; dim &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="forest_icon.png" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="forest_icon.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">FOREST
   </div>
   <div id="projectbrief">Framework Oriented for REactor SimulaTions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="pages.html"><span>pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="../../index.html"><span>FOREST&#160;Documentation</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classForest_1_1ExtractBV.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classForest_1_1ExtractBV-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Forest::ExtractBV&lt; dim &gt; Class Template Reference<div class="ingroups"><a class="el" href="group__ForestNeutronics.html">ForestNeutronics</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Extracts boundary values for the system.  
 <a href="classForest_1_1ExtractBV.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="extract__bv_8h_source.html">/home/lns/Codes/forest-public/mylib/include/neutronics/extract_bv.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8279c4e6a40335cebc2c26db7241af60"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a8279c4e6a40335cebc2c26db7241af60">ExtractBV</a> (const <a class="el" href="classForest_1_1State.html">State</a>&lt; dim &gt; &amp;state)</td></tr>
<tr class="memdesc:a8279c4e6a40335cebc2c26db7241af60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a8279c4e6a40335cebc2c26db7241af60">More...</a><br /></td></tr>
<tr class="separator:a8279c4e6a40335cebc2c26db7241af60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a250c6d8962e9b7d646ccd424cfb4edcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf">initialize</a> ()</td></tr>
<tr class="memdesc:a250c6d8962e9b7d646ccd424cfb4edcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Intialize the members of the class that need it.  <a href="#a250c6d8962e9b7d646ccd424cfb4edcf">More...</a><br /></td></tr>
<tr class="separator:a250c6d8962e9b7d646ccd424cfb4edcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fa88b5ebb1a098120bbbad12e4c6001"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a7fa88b5ebb1a098120bbbad12e4c6001">memory_consumption</a> () const </td></tr>
<tr class="memdesc:a7fa88b5ebb1a098120bbbad12e4c6001"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the memory consumption of an object of this class.  <a href="#a7fa88b5ebb1a098120bbbad12e4c6001">More...</a><br /></td></tr>
<tr class="separator:a7fa88b5ebb1a098120bbbad12e4c6001"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2380fccc89d3f3c8d507445dda9736d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#ae2380fccc89d3f3c8d507445dda9736d">set_pin_bc</a> ()</td></tr>
<tr class="memdesc:ae2380fccc89d3f3c8d507445dda9736d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identifying and storing the boundary cells for each pin.  <a href="#ae2380fccc89d3f3c8d507445dda9736d">More...</a><br /></td></tr>
<tr class="separator:ae2380fccc89d3f3c8d507445dda9736d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3656ff6b3559c8300be5459ddb225d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#aa3656ff6b3559c8300be5459ddb225d5">set_pin_bw</a> ()</td></tr>
<tr class="memdesc:aa3656ff6b3559c8300be5459ddb225d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill the boundary weights.  <a href="#aa3656ff6b3559c8300be5459ddb225d5">More...</a><br /></td></tr>
<tr class="separator:aa3656ff6b3559c8300be5459ddb225d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6ac6165e3c778f4dba03317a3cb7449"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#ae6ac6165e3c778f4dba03317a3cb7449">set_pin_bv</a> ()</td></tr>
<tr class="memdesc:ae6ac6165e3c778f4dba03317a3cb7449"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract the boundary conditions for the pins.  <a href="#ae6ac6165e3c778f4dba03317a3cb7449">More...</a><br /></td></tr>
<tr class="separator:ae6ac6165e3c778f4dba03317a3cb7449"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b2316461095ae7f588c219cc247c254"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a5b2316461095ae7f588c219cc247c254">set_pin_bv_g_n</a> (const <a class="el" href="classdealii_1_1Vector.html">Vector</a>&lt; double &gt; &amp;psi_n, const unsigned int g, const unsigned int n)</td></tr>
<tr class="memdesc:a5b2316461095ae7f588c219cc247c254"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill the containers for the bcs.  <a href="#a5b2316461095ae7f588c219cc247c254">More...</a><br /></td></tr>
<tr class="separator:a5b2316461095ae7f588c219cc247c254"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6de59ddd52559f4858dba74f033aa102"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a6de59ddd52559f4858dba74f033aa102">set_ass_bc</a> ()</td></tr>
<tr class="memdesc:a6de59ddd52559f4858dba74f033aa102"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identifying and storing the boundary cells for each assembly.  <a href="#a6de59ddd52559f4858dba74f033aa102">More...</a><br /></td></tr>
<tr class="separator:a6de59ddd52559f4858dba74f033aa102"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0064ed3afe6d28e4a92f418d582d0128"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a0064ed3afe6d28e4a92f418d582d0128">set_ass2pin</a> ()</td></tr>
<tr class="memdesc:a0064ed3afe6d28e4a92f418d582d0128"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identifying the pin indices over the boundary of the assembly.  <a href="#a0064ed3afe6d28e4a92f418d582d0128">More...</a><br /></td></tr>
<tr class="separator:a0064ed3afe6d28e4a92f418d582d0128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80dcb45dd9493e06022c4901e58933a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a80dcb45dd9493e06022c4901e58933a0">print_ass_bc</a> ()</td></tr>
<tr class="memdesc:a80dcb45dd9493e06022c4901e58933a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">print assembly boundary pointers.  <a href="#a80dcb45dd9493e06022c4901e58933a0">More...</a><br /></td></tr>
<tr class="separator:a80dcb45dd9493e06022c4901e58933a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6e2f36c01f6685bfc60a359f9492f67"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#ac6e2f36c01f6685bfc60a359f9492f67">set_ass_bw</a> ()</td></tr>
<tr class="memdesc:ac6e2f36c01f6685bfc60a359f9492f67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill the boundary weights.  <a href="#ac6e2f36c01f6685bfc60a359f9492f67">More...</a><br /></td></tr>
<tr class="separator:ac6e2f36c01f6685bfc60a359f9492f67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dea05d81fcbbf6603e3fdb3899122aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a9dea05d81fcbbf6603e3fdb3899122aa">set_ass_bv</a> ()</td></tr>
<tr class="memdesc:a9dea05d81fcbbf6603e3fdb3899122aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill the boundary values.  <a href="#a9dea05d81fcbbf6603e3fdb3899122aa">More...</a><br /></td></tr>
<tr class="separator:a9dea05d81fcbbf6603e3fdb3899122aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9125303a5919fd4c5782de90b37ca568"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a9125303a5919fd4c5782de90b37ca568">calculate_current_pin</a> ()</td></tr>
<tr class="memdesc:a9125303a5919fd4c5782de90b37ca568"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate neutron current.  <a href="#a9125303a5919fd4c5782de90b37ca568">More...</a><br /></td></tr>
<tr class="separator:a9125303a5919fd4c5782de90b37ca568"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65cb8788beb5a3e749dc749e0d6a5a2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a65cb8788beb5a3e749dc749e0d6a5a2a">calculate_current_ass</a> ()</td></tr>
<tr class="separator:a65cb8788beb5a3e749dc749e0d6a5a2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cbd0f00f7dba7e5fd09c5e5e8e99022"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a0cbd0f00f7dba7e5fd09c5e5e8e99022">calculate_moments_pin</a> ()</td></tr>
<tr class="separator:a0cbd0f00f7dba7e5fd09c5e5e8e99022"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae25c13e3567d2af093bae8ac64a2d4bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#ae25c13e3567d2af093bae8ac64a2d4bb">calculate_moments_ass</a> ()</td></tr>
<tr class="separator:ae25c13e3567d2af093bae8ac64a2d4bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45a7a28e1ec1b6fb4ce1dc265d887b7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a45a7a28e1ec1b6fb4ce1dc265d887b7c">coarsening_angular</a> ()</td></tr>
<tr class="memdesc:a45a7a28e1ec1b6fb4ce1dc265d887b7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate the coarser angular representation for the bv.  <a href="#a45a7a28e1ec1b6fb4ce1dc265d887b7c">More...</a><br /></td></tr>
<tr class="separator:a45a7a28e1ec1b6fb4ce1dc265d887b7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ab04dca6066e72aa131aec8174b403d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a9ab04dca6066e72aa131aec8174b403d">coarsening_spatial</a> ()</td></tr>
<tr class="memdesc:a9ab04dca6066e72aa131aec8174b403d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate the coarser spatial representation for the bv.  <a href="#a9ab04dca6066e72aa131aec8174b403d">More...</a><br /></td></tr>
<tr class="separator:a9ab04dca6066e72aa131aec8174b403d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8edb62daa0379fd038a69dad14fad114"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a8edb62daa0379fd038a69dad14fad114">read_ass_bv</a> ()</td></tr>
<tr class="memdesc:a8edb62daa0379fd038a69dad14fad114"><td class="mdescLeft">&#160;</td><td class="mdescRight">read the bv from a file.  <a href="#a8edb62daa0379fd038a69dad14fad114">More...</a><br /></td></tr>
<tr class="separator:a8edb62daa0379fd038a69dad14fad114"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad95181783224f491043d97f5abcc5faa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#ad95181783224f491043d97f5abcc5faa">print_ass_bv</a> (const std::string &amp;filename_prefix) const </td></tr>
<tr class="memdesc:ad95181783224f491043d97f5abcc5faa"><td class="mdescLeft">&#160;</td><td class="mdescRight">print the bv to a file.  <a href="#ad95181783224f491043d97f5abcc5faa">More...</a><br /></td></tr>
<tr class="separator:ad95181783224f491043d97f5abcc5faa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d3df1dd673f4d18a508ef478e626ef6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a> (const double scaling)</td></tr>
<tr class="memdesc:a6d3df1dd673f4d18a508ef478e626ef6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scale the interface values with a given scaling factor.  <a href="#a6d3df1dd673f4d18a508ef478e626ef6">More...</a><br /></td></tr>
<tr class="separator:a6d3df1dd673f4d18a508ef478e626ef6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6125e651ca0f77edc13d675d9f55e26e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a6125e651ca0f77edc13d675d9f55e26e">scaling_moments</a> (const double <a class="el" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>)</td></tr>
<tr class="memdesc:a6125e651ca0f77edc13d675d9f55e26e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scale the interface values with a given scaling factor.  <a href="#a6125e651ca0f77edc13d675d9f55e26e">More...</a><br /></td></tr>
<tr class="separator:a6125e651ca0f77edc13d675d9f55e26e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a92b060da2496bd32ec17d4796c7f9190"><td class="memItemLeft" align="right" valign="top">std::vector&lt; unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a92b060da2496bd32ec17d4796c7f9190">m_bcs_order</a></td></tr>
<tr class="memdesc:a92b060da2496bd32ec17d4796c7f9190"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains the spherical harmonics order for the bcs.  <a href="#a92b060da2496bd32ec17d4796c7f9190">More...</a><br /></td></tr>
<tr class="separator:a92b060da2496bd32ec17d4796c7f9190"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr class="memitem:ac1f52b84cf1905c1626d5b0af3d7a688"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a></td></tr>
<tr class="memdesc:ac1f52b84cf1905c1626d5b0af3d7a688"><td class="mdescLeft">&#160;</td><td class="mdescRight">shortcut for std::vector&lt;double&gt;  <a href="#ac1f52b84cf1905c1626d5b0af3d7a688">More...</a><br /></td></tr>
<tr class="separator:ac1f52b84cf1905c1626d5b0af3d7a688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae767775a85397eb408e80f7f746e64ae"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; <a class="el" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a></td></tr>
<tr class="memdesc:ae767775a85397eb408e80f7f746e64ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">recursive shortcut for std::vector&lt;std_vd1&gt;  <a href="#ae767775a85397eb408e80f7f746e64ae">More...</a><br /></td></tr>
<tr class="separator:ae767775a85397eb408e80f7f746e64ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35b18eb8254953070491cb4709354451"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; <a class="el" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a></td></tr>
<tr class="memdesc:a35b18eb8254953070491cb4709354451"><td class="mdescLeft">&#160;</td><td class="mdescRight">recursive shortcut for std::vector&lt;std_vd2&gt;  <a href="#a35b18eb8254953070491cb4709354451">More...</a><br /></td></tr>
<tr class="separator:a35b18eb8254953070491cb4709354451"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f51e208613155f983c9c99907ca781a"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; <a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a4f51e208613155f983c9c99907ca781a">stdvd4</a></td></tr>
<tr class="memdesc:a4f51e208613155f983c9c99907ca781a"><td class="mdescLeft">&#160;</td><td class="mdescRight">recursive shortcut for std::vector&lt;std_vd3&gt;  <a href="#a4f51e208613155f983c9c99907ca781a">More...</a><br /></td></tr>
<tr class="separator:a4f51e208613155f983c9c99907ca781a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e4aeb54b28fbedef308f4267d802330"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a9e4aeb54b28fbedef308f4267d802330">std_vui1</a></td></tr>
<tr class="memdesc:a9e4aeb54b28fbedef308f4267d802330"><td class="mdescLeft">&#160;</td><td class="mdescRight">shortcut for std::vector&lt;unsigned int&gt;  <a href="#a9e4aeb54b28fbedef308f4267d802330">More...</a><br /></td></tr>
<tr class="separator:a9e4aeb54b28fbedef308f4267d802330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2b26c31ae2dbed1d98556ec7c2c6b0a"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; <a class="el" href="classForest_1_1ExtractBV.html#a9e4aeb54b28fbedef308f4267d802330">std_vui1</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#ae2b26c31ae2dbed1d98556ec7c2c6b0a">std_vui2</a></td></tr>
<tr class="memdesc:ae2b26c31ae2dbed1d98556ec7c2c6b0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">recursive shortcut for std::vector&lt;std_vui1&gt;  <a href="#ae2b26c31ae2dbed1d98556ec7c2c6b0a">More...</a><br /></td></tr>
<tr class="separator:ae2b26c31ae2dbed1d98556ec7c2c6b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e8d7a7dd4efffe2213e1d526c6314b3"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; <a class="el" href="classForest_1_1ExtractBV.html#ae2b26c31ae2dbed1d98556ec7c2c6b0a">std_vui2</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a2e8d7a7dd4efffe2213e1d526c6314b3">std_vui3</a></td></tr>
<tr class="memdesc:a2e8d7a7dd4efffe2213e1d526c6314b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">recursive shortcut for std::vector&lt;std_vui2&gt;  <a href="#a2e8d7a7dd4efffe2213e1d526c6314b3">More...</a><br /></td></tr>
<tr class="separator:a2e8d7a7dd4efffe2213e1d526c6314b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac44bcd4083987a3238473c3addc20fac"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; <a class="el" href="classForest_1_1ExtractBV.html#a2e8d7a7dd4efffe2213e1d526c6314b3">std_vui3</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#ac44bcd4083987a3238473c3addc20fac">std_vui4</a></td></tr>
<tr class="memdesc:ac44bcd4083987a3238473c3addc20fac"><td class="mdescLeft">&#160;</td><td class="mdescRight">recursive shortcut for std::vector&lt;std_vui3&gt;  <a href="#ac44bcd4083987a3238473c3addc20fac">More...</a><br /></td></tr>
<tr class="separator:ac44bcd4083987a3238473c3addc20fac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97d76e898d530f2406efe3ec5716bac9"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classdealii_1_1DoFHandler.html">DoFHandler</a>&lt; dim, dim &gt;::active_cell_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">c_iter</a></td></tr>
<tr class="memdesc:a97d76e898d530f2406efe3ec5716bac9"><td class="mdescLeft">&#160;</td><td class="mdescRight">shortcut for the cell_iterator type  <a href="#a97d76e898d530f2406efe3ec5716bac9">More...</a><br /></td></tr>
<tr class="separator:a97d76e898d530f2406efe3ec5716bac9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cd32560420878a05248db7bc13890e1"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a7cd32560420878a05248db7bc13890e1">map_cf</a> = std::map&lt; <a class="el" href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">c_iter</a>, unsigned int &gt;</td></tr>
<tr class="memdesc:a7cd32560420878a05248db7bc13890e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">shortcut for the map &lt;cell_iterator, face&gt;  <a href="#a7cd32560420878a05248db7bc13890e1">More...</a><br /></td></tr>
<tr class="separator:a7cd32560420878a05248db7bc13890e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a58b31a2d3c8293eb687368f71d0659be"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="classForest_1_1ExtractBV.html#a7cd32560420878a05248db7bc13890e1">map_cf</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a58b31a2d3c8293eb687368f71d0659be">m_pin_bc</a></td></tr>
<tr class="memdesc:a58b31a2d3c8293eb687368f71d0659be"><td class="mdescLeft">&#160;</td><td class="mdescRight">m_pin_bc[pin][face] is a map containing the pairs pair(cell,f), so we can easily find the cells and faces inside a triangulation defining the boundary <code>face</code> of the pin <code>pin</code>  <a href="#a58b31a2d3c8293eb687368f71d0659be">More...</a><br /></td></tr>
<tr class="separator:a58b31a2d3c8293eb687368f71d0659be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a601c8ad25bfa0d43984c2cf2b5cd8a50"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a601c8ad25bfa0d43984c2cf2b5cd8a50">m_pin_bw</a></td></tr>
<tr class="memdesc:a601c8ad25bfa0d43984c2cf2b5cd8a50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the pin faces boundary weight.  <a href="#a601c8ad25bfa0d43984c2cf2b5cd8a50">More...</a><br /></td></tr>
<tr class="separator:a601c8ad25bfa0d43984c2cf2b5cd8a50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20d4126d42f8027c6f1e4df21943a8d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a4f51e208613155f983c9c99907ca781a">stdvd4</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a></td></tr>
<tr class="memdesc:a20d4126d42f8027c6f1e4df21943a8d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the pin faces boundary values.  <a href="#a20d4126d42f8027c6f1e4df21943a8d4">More...</a><br /></td></tr>
<tr class="separator:a20d4126d42f8027c6f1e4df21943a8d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fc848227ff4977e81bf80067c592bc7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a4f51e208613155f983c9c99907ca781a">stdvd4</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a6fc848227ff4977e81bf80067c592bc7">m_pin_bvm</a></td></tr>
<tr class="memdesc:a6fc848227ff4977e81bf80067c592bc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the pin faces boundary values.  <a href="#a6fc848227ff4977e81bf80067c592bc7">More...</a><br /></td></tr>
<tr class="separator:a6fc848227ff4977e81bf80067c592bc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d8ab0ab3b7d3bfa34d4042760890b63"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::set&lt; unsigned int &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a6d8ab0ab3b7d3bfa34d4042760890b63">m_ass2pin</a></td></tr>
<tr class="memdesc:a6d8ab0ab3b7d3bfa34d4042760890b63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pins over the boundary of the assembly.  <a href="#a6d8ab0ab3b7d3bfa34d4042760890b63">More...</a><br /></td></tr>
<tr class="separator:a6d8ab0ab3b7d3bfa34d4042760890b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21d3a9bbcde5245008763f732c27e4ce"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="classForest_1_1ExtractBV.html#a7cd32560420878a05248db7bc13890e1">map_cf</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a></td></tr>
<tr class="memdesc:a21d3a9bbcde5245008763f732c27e4ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">boundary container for the assembly sorting cells and faces  <a href="#a21d3a9bbcde5245008763f732c27e4ce">More...</a><br /></td></tr>
<tr class="separator:a21d3a9bbcde5245008763f732c27e4ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec313821f23b0f8521a1fc06d8d70bc1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#aec313821f23b0f8521a1fc06d8d70bc1">m_ass_bw</a></td></tr>
<tr class="memdesc:aec313821f23b0f8521a1fc06d8d70bc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the ass faces boundary weight.  <a href="#aec313821f23b0f8521a1fc06d8d70bc1">More...</a><br /></td></tr>
<tr class="separator:aec313821f23b0f8521a1fc06d8d70bc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23a390ddb4807d3fd585526881b0b877"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a4f51e208613155f983c9c99907ca781a">stdvd4</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a></td></tr>
<tr class="memdesc:a23a390ddb4807d3fd585526881b0b877"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the boundary values for the assembly.  <a href="#a23a390ddb4807d3fd585526881b0b877">More...</a><br /></td></tr>
<tr class="separator:a23a390ddb4807d3fd585526881b0b877"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ebb32675c1888817632918917e36709"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a4f51e208613155f983c9c99907ca781a">stdvd4</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a3ebb32675c1888817632918917e36709">m_ass_bvm</a></td></tr>
<tr class="memdesc:a3ebb32675c1888817632918917e36709"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the boundary values for the assembly.  <a href="#a3ebb32675c1888817632918917e36709">More...</a><br /></td></tr>
<tr class="separator:a3ebb32675c1888817632918917e36709"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2ec657fef942c86ce29a07178435e6f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#ab2ec657fef942c86ce29a07178435e6f">m_phi0_pin</a></td></tr>
<tr class="memdesc:ab2ec657fef942c86ce29a07178435e6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the boundary values for the flux.  <a href="#ab2ec657fef942c86ce29a07178435e6f">More...</a><br /></td></tr>
<tr class="separator:ab2ec657fef942c86ce29a07178435e6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c5cba2999422814170f891cb707d1a0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a0c5cba2999422814170f891cb707d1a0">m_phi0_ass</a></td></tr>
<tr class="separator:a0c5cba2999422814170f891cb707d1a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4f9100e9dce4a8c4275abdeebd15487"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#aa4f9100e9dce4a8c4275abdeebd15487">m_jp_o_pin</a></td></tr>
<tr class="memdesc:aa4f9100e9dce4a8c4275abdeebd15487"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the values for the outgoing partial current.  <a href="#aa4f9100e9dce4a8c4275abdeebd15487">More...</a><br /></td></tr>
<tr class="separator:aa4f9100e9dce4a8c4275abdeebd15487"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a155f5b3d28bfe916661fb56c0d9fe5cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a155f5b3d28bfe916661fb56c0d9fe5cb">m_jp_o_ass</a></td></tr>
<tr class="separator:a155f5b3d28bfe916661fb56c0d9fe5cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3a86c811e9da115d39ce36d972e9a9a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#ae3a86c811e9da115d39ce36d972e9a9a">m_jp_i_pin</a></td></tr>
<tr class="memdesc:ae3a86c811e9da115d39ce36d972e9a9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the values for the incoming partial current.  <a href="#ae3a86c811e9da115d39ce36d972e9a9a">More...</a><br /></td></tr>
<tr class="separator:ae3a86c811e9da115d39ce36d972e9a9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a187bacdfe10d7de8fd46fab9ed802ace"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a187bacdfe10d7de8fd46fab9ed802ace">m_jp_i_ass</a></td></tr>
<tr class="separator:a187bacdfe10d7de8fd46fab9ed802ace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9c71737f27c0d7a213b8ba05642ef51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a4f51e208613155f983c9c99907ca781a">stdvd4</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#aa9c71737f27c0d7a213b8ba05642ef51">m_jnet_pin</a></td></tr>
<tr class="memdesc:aa9c71737f27c0d7a213b8ba05642ef51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the boundary values for the net current.  <a href="#aa9c71737f27c0d7a213b8ba05642ef51">More...</a><br /></td></tr>
<tr class="separator:aa9c71737f27c0d7a213b8ba05642ef51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7672e0dfe0d102c2b9ec7d776892ad3d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a4f51e208613155f983c9c99907ca781a">stdvd4</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a7672e0dfe0d102c2b9ec7d776892ad3d">m_jnet_ass</a></td></tr>
<tr class="separator:a7672e0dfe0d102c2b9ec7d776892ad3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15d1cfa4b83507500b2ab17e7f98750d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a15d1cfa4b83507500b2ab17e7f98750d">m_j_pin</a></td></tr>
<tr class="memdesc:a15d1cfa4b83507500b2ab17e7f98750d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the boundary values for the net current.  <a href="#a15d1cfa4b83507500b2ab17e7f98750d">More...</a><br /></td></tr>
<tr class="separator:a15d1cfa4b83507500b2ab17e7f98750d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1399ae53002bef64f107a18c1dadde3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#af1399ae53002bef64f107a18c1dadde3">m_j_ass</a></td></tr>
<tr class="separator:af1399ae53002bef64f107a18c1dadde3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0db15dad2fdc0027f77e122c2503d328"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a0db15dad2fdc0027f77e122c2503d328">m_phi2_pin</a></td></tr>
<tr class="memdesc:a0db15dad2fdc0027f77e122c2503d328"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the boundary values for the second moment flux.  <a href="#a0db15dad2fdc0027f77e122c2503d328">More...</a><br /></td></tr>
<tr class="separator:a0db15dad2fdc0027f77e122c2503d328"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a114e7cbb9584babbbd6758c097d8715f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a114e7cbb9584babbbd6758c097d8715f">m_phi2_ass</a></td></tr>
<tr class="separator:a114e7cbb9584babbbd6758c097d8715f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:af6ab5e3132ab03a469ccca76952378a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">m_verbose</a></td></tr>
<tr class="memdesc:af6ab5e3132ab03a469ccca76952378a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicating the level of verbose: 0 = none; 1 = everything.  <a href="#af6ab5e3132ab03a469ccca76952378a3">More...</a><br /></td></tr>
<tr class="separator:af6ab5e3132ab03a469ccca76952378a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd57835ed1e2c7414f83078efce7ffbf"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classForest_1_1State.html">State</a>&lt; dim &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a></td></tr>
<tr class="memdesc:abd57835ed1e2c7414f83078efce7ffbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference to the state object.  <a href="#abd57835ed1e2c7414f83078efce7ffbf">More...</a><br /></td></tr>
<tr class="separator:abd57835ed1e2c7414f83078efce7ffbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af29b71d47daaad7709879135b04f394c"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classForest_1_1QuadratureBase.html">QuadratureBase</a>&lt; dim &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">m_ord</a></td></tr>
<tr class="memdesc:af29b71d47daaad7709879135b04f394c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Angular quadrature.  <a href="#af29b71d47daaad7709879135b04f394c">More...</a><br /></td></tr>
<tr class="separator:af29b71d47daaad7709879135b04f394c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8bbac2fc100dde23aade6c1a492c96e"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classForest_1_1ProbGeom.html">ProbGeom</a>&lt; dim &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a></td></tr>
<tr class="memdesc:ae8bbac2fc100dde23aade6c1a492c96e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Geometry.  <a href="#ae8bbac2fc100dde23aade6c1a492c96e">More...</a><br /></td></tr>
<tr class="separator:ae8bbac2fc100dde23aade6c1a492c96e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adce3387da7a39374002770c2edd25daa"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classdealii_1_1DoFHandler.html">DoFHandler</a>&lt; dim, dim &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#adce3387da7a39374002770c2edd25daa">m_dof_handler</a></td></tr>
<tr class="separator:adce3387da7a39374002770c2edd25daa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58b15e427a438a6b8b95e259d26105ab"><td class="memItemLeft" align="right" valign="top">const unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a58b15e427a438a6b8b95e259d26105ab">m_n_groups</a></td></tr>
<tr class="separator:a58b15e427a438a6b8b95e259d26105ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5973ec1792ae1bbc91ffec9feeab23fd"><td class="memItemLeft" align="right" valign="top">const unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">m_n_angles</a></td></tr>
<tr class="separator:a5973ec1792ae1bbc91ffec9feeab23fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:ab554683822d192e266bd3373c7b60b9b"><td class="memItemLeft" align="right" valign="top">static const unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#ab554683822d192e266bd3373c7b60b9b">m_n_leg_mom</a> = 1</td></tr>
<tr class="separator:ab554683822d192e266bd3373c7b60b9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:aa10dcb39cdc6c5526050e232fa52ab35"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#aa10dcb39cdc6c5526050e232fa52ab35">Homogenization&lt; dim &gt;</a></td></tr>
<tr class="separator:aa10dcb39cdc6c5526050e232fa52ab35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaebbe654eda55f3f9797a0002de1288e"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1ExtractBV.html#aaebbe654eda55f3f9797a0002de1288e">HomData&lt; dim &gt;</a></td></tr>
<tr class="separator:aaebbe654eda55f3f9797a0002de1288e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;int dim&gt;<br />
class Forest::ExtractBV&lt; dim &gt;</h3>

<p>Extracts boundary values for the system. </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00038">38</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="ac1f52b84cf1905c1626d5b0af3d7a688"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;double&gt; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::<a class="el" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>shortcut for std::vector&lt;double&gt; </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00305">305</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae767775a85397eb408e80f7f746e64ae"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a>&gt; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::<a class="el" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>recursive shortcut for std::vector&lt;std_vd1&gt; </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00307">307</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

</div>
</div>
<a class="anchor" id="a35b18eb8254953070491cb4709354451"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a>&gt; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::<a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>recursive shortcut for std::vector&lt;std_vd2&gt; </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00309">309</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4f51e208613155f983c9c99907ca781a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a>&gt; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::<a class="el" href="classForest_1_1ExtractBV.html#a4f51e208613155f983c9c99907ca781a">stdvd4</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>recursive shortcut for std::vector&lt;std_vd3&gt; </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00311">311</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9e4aeb54b28fbedef308f4267d802330"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;unsigned int&gt; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::<a class="el" href="classForest_1_1ExtractBV.html#a9e4aeb54b28fbedef308f4267d802330">std_vui1</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>shortcut for std::vector&lt;unsigned int&gt; </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00314">314</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae2b26c31ae2dbed1d98556ec7c2c6b0a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="classForest_1_1ExtractBV.html#a9e4aeb54b28fbedef308f4267d802330">std_vui1</a>&gt; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::<a class="el" href="classForest_1_1ExtractBV.html#ae2b26c31ae2dbed1d98556ec7c2c6b0a">std_vui2</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>recursive shortcut for std::vector&lt;std_vui1&gt; </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00316">316</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2e8d7a7dd4efffe2213e1d526c6314b3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="classForest_1_1ExtractBV.html#ae2b26c31ae2dbed1d98556ec7c2c6b0a">std_vui2</a>&gt; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::<a class="el" href="classForest_1_1ExtractBV.html#a2e8d7a7dd4efffe2213e1d526c6314b3">std_vui3</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>recursive shortcut for std::vector&lt;std_vui2&gt; </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00318">318</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac44bcd4083987a3238473c3addc20fac"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="classForest_1_1ExtractBV.html#a2e8d7a7dd4efffe2213e1d526c6314b3">std_vui3</a>&gt; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::<a class="el" href="classForest_1_1ExtractBV.html#ac44bcd4083987a3238473c3addc20fac">std_vui4</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>recursive shortcut for std::vector&lt;std_vui3&gt; </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00320">320</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

</div>
</div>
<a class="anchor" id="a97d76e898d530f2406efe3ec5716bac9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classdealii_1_1DoFHandler.html">DoFHandler</a>&lt;dim, dim&gt;::active_cell_iterator <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::<a class="el" href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">c_iter</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>shortcut for the cell_iterator type </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00323">323</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7cd32560420878a05248db7bc13890e1"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::<a class="el" href="classForest_1_1ExtractBV.html#a7cd32560420878a05248db7bc13890e1">map_cf</a> =  std::map&lt;<a class="el" href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">c_iter</a>, unsigned int&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>shortcut for the map &lt;cell_iterator, face&gt; </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00326">326</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a8279c4e6a40335cebc2c26db7241af60"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::<a class="el" href="classForest_1_1ExtractBV.html">ExtractBV</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classForest_1_1State.html">State</a>&lt; dim &gt; &amp;&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>This is not an empty constructor, but only initialize references. It should be initialize before the object is used for something else. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00049">49</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  : <a class="code" href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">m_verbose</a> (<span class="keyword">false</span>),</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a> (state),</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">m_ord</a> (<a class="code" href="classForest_1_1QuadratureFactory.html#aaa4c6266cbe10756746ec2e10d6320d4">QuadratureFactory&lt;dim&gt;::build</a> (</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.mp_data.mp_settings.get_sn_order (),</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.mp_data.mp_settings.get_quad_name ())),</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a> (<a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.mp_geom),</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="classForest_1_1ExtractBV.html#adce3387da7a39374002770c2edd25daa">m_dof_handler</a> (<a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_dof_handler ()),</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <a class="code" href="classForest_1_1ExtractBV.html#a58b15e427a438a6b8b95e259d26105ab">m_n_groups</a> (<a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_n_groups ()),</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">m_n_angles</a> (<a class="code" href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">m_ord</a>-&gt;get_n_angles ())</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a92b060da2496bd32ec17d4796c7f9190">m_bcs_order</a>.resize (1, 0);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    this-&gt;<a class="code" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf">initialize</a> ();</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_a92b060da2496bd32ec17d4796c7f9190"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a92b060da2496bd32ec17d4796c7f9190">Forest::ExtractBV::m_bcs_order</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; m_bcs_order</div><div class="ttdoc">Contains the spherical harmonics order for the bcs. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00472">extract_bv.h:472</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_adce3387da7a39374002770c2edd25daa"><div class="ttname"><a href="classForest_1_1ExtractBV.html#adce3387da7a39374002770c2edd25daa">Forest::ExtractBV::m_dof_handler</a></div><div class="ttdeci">const DoFHandler&lt; dim, dim &gt; &amp; m_dof_handler</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00068">extract_bv.h:68</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_abd57835ed1e2c7414f83078efce7ffbf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">Forest::ExtractBV::mp_state</a></div><div class="ttdeci">const State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference to the state object. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00061">extract_bv.h:61</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a58b15e427a438a6b8b95e259d26105ab"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a58b15e427a438a6b8b95e259d26105ab">Forest::ExtractBV::m_n_groups</a></div><div class="ttdeci">const unsigned int m_n_groups</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00069">extract_bv.h:69</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af29b71d47daaad7709879135b04f394c"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">Forest::ExtractBV::m_ord</a></div><div class="ttdeci">std::shared_ptr&lt; QuadratureBase&lt; dim &gt; &gt; m_ord</div><div class="ttdoc">Angular quadrature. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00064">extract_bv.h:64</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af6ab5e3132ab03a469ccca76952378a3"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">Forest::ExtractBV::m_verbose</a></div><div class="ttdeci">bool m_verbose</div><div class="ttdoc">Indicating the level of verbose: 0 = none; 1 = everything. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00058">extract_bv.h:58</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a250c6d8962e9b7d646ccd424cfb4edcf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf">Forest::ExtractBV::initialize</a></div><div class="ttdeci">void initialize()</div><div class="ttdoc">Intialize the members of the class that need it. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00066">extract_bv.cc:66</a></div></div>
<div class="ttc" id="classForest_1_1QuadratureFactory_html_aaa4c6266cbe10756746ec2e10d6320d4"><div class="ttname"><a href="classForest_1_1QuadratureFactory.html#aaa4c6266cbe10756746ec2e10d6320d4">Forest::QuadratureFactory::build</a></div><div class="ttdeci">static QuadraturePtr&lt; dim &gt; build(const std::vector&lt; unsigned int &gt; &amp;order_, const std::string &amp;type=&quot;ChebyshevLegendre&quot;)</div><div class="ttdoc">Build the quadrature. </div><div class="ttdef"><b>Definition:</b> <a href="quadrature__factory_8cc_source.html#l00050">quadrature_factory.cc:50</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a5973ec1792ae1bbc91ffec9feeab23fd"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">Forest::ExtractBV::m_n_angles</a></div><div class="ttdeci">const unsigned int m_n_angles</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00070">extract_bv.h:70</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a8279c4e6a40335cebc2c26db7241af60_cgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a8279c4e6a40335cebc2c26db7241af60_cgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a8279c4e6a40335cebc2c26db7241af60_cgraph" id="classForest_1_1ExtractBV_a8279c4e6a40335cebc2c26db7241af60_cgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf" title="Intialize the members of the class that need it. " alt="" coords="188,365,323,407"/>
<area shape="rect" id="node3" href="classForest_1_1ExtractBV.html#ae2380fccc89d3f3c8d507445dda9736d" title="Identifying and storing the boundary cells for each pin. " alt="" coords="385,5,519,47"/>
<area shape="rect" id="node4" href="classForest_1_1ExtractBV.html#aa3656ff6b3559c8300be5459ddb225d5" title="Fill the boundary weights. " alt="" coords="385,71,519,112"/>
<area shape="rect" id="node5" href="classForest_1_1ExtractBV.html#ae6ac6165e3c778f4dba03317a3cb7449" title="Extract the boundary conditions for the pins. " alt="" coords="385,136,519,177"/>
<area shape="rect" id="node6" href="classForest_1_1ExtractBV.html#a6de59ddd52559f4858dba74f033aa102" title="Identifying and storing the boundary cells for each assembly. " alt="" coords="385,201,519,243"/>
<area shape="rect" id="node7" href="classForest_1_1ExtractBV.html#a0064ed3afe6d28e4a92f418d582d0128" title="Identifying the pin indices over the boundary of the assembly. " alt="" coords="385,267,519,308"/>
<area shape="rect" id="node8" href="classForest_1_1ExtractBV.html#ac6e2f36c01f6685bfc60a359f9492f67" title="Fill the boundary weights. " alt="" coords="385,332,519,373"/>
<area shape="rect" id="node9" href="classForest_1_1ExtractBV.html#a9dea05d81fcbbf6603e3fdb3899122aa" title="Fill the boundary values. " alt="" coords="385,397,519,439"/>
<area shape="rect" id="node10" href="classForest_1_1ExtractBV.html#a9125303a5919fd4c5782de90b37ca568" title="Calculate neutron current. " alt="" coords="379,463,525,504"/>
<area shape="rect" id="node11" href="classForest_1_1ExtractBV.html#a65cb8788beb5a3e749dc749e0d6a5a2a" title="Forest::ExtractBV::\lcalculate_current_ass" alt="" coords="377,528,527,569"/>
<area shape="rect" id="node12" href="classForest_1_1ExtractBV.html#a0cbd0f00f7dba7e5fd09c5e5e8e99022" title="Forest::ExtractBV::\lcalculate_moments_pin" alt="" coords="373,593,531,635"/>
<area shape="rect" id="node13" href="classForest_1_1ExtractBV.html#ae25c13e3567d2af093bae8ac64a2d4bb" title="Forest::ExtractBV::\lcalculate_moments_ass" alt="" coords="371,659,533,700"/>
<area shape="rect" id="node14" href="classForest_1_1ExtractBV.html#a80dcb45dd9493e06022c4901e58933a0" title="print assembly boundary pointers. " alt="" coords="385,724,519,765"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a250c6d8962e9b7d646ccd424cfb4edcf"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Intialize the members of the class that need it. </p>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00066">66</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00049">Forest::ExtractBV&lt; dim &gt;::ExtractBV()</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// This three functions must be called in this order, so I must lock it.</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    this-&gt;<a class="code" href="classForest_1_1ExtractBV.html#ae2380fccc89d3f3c8d507445dda9736d">set_pin_bc</a> ();<span class="comment">// Set the container for the pin boundaries: (cell, f)</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    this-&gt;<a class="code" href="classForest_1_1ExtractBV.html#aa3656ff6b3559c8300be5459ddb225d5">set_pin_bw</a> ();<span class="comment">// Set the weights for each pin face</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    this-&gt;<a class="code" href="classForest_1_1ExtractBV.html#ae6ac6165e3c778f4dba03317a3cb7449">set_pin_bv</a> ();<span class="comment">// Extract the boundary flux</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    this-&gt;<a class="code" href="classForest_1_1ExtractBV.html#a6de59ddd52559f4858dba74f033aa102">set_ass_bc</a> ();<span class="comment">// Set the container for the ass boundaries: (ass, f)</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    this-&gt;<a class="code" href="classForest_1_1ExtractBV.html#a0064ed3afe6d28e4a92f418d582d0128">set_ass2pin</a> ();<span class="comment">// Set pointers (assembly,face) to (pin, counter)</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    this-&gt;<a class="code" href="classForest_1_1ExtractBV.html#ac6e2f36c01f6685bfc60a359f9492f67">set_ass_bw</a> ();<span class="comment">// Set the weights for each ass face</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    this-&gt;<a class="code" href="classForest_1_1ExtractBV.html#a9dea05d81fcbbf6603e3fdb3899122aa">set_ass_bv</a> ();<span class="comment">// Extract the boundary flux</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// Calculate the values for the partial currents and fluxes over boundaries</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    this-&gt;<a class="code" href="classForest_1_1ExtractBV.html#a9125303a5919fd4c5782de90b37ca568">calculate_current_pin</a> ();</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    this-&gt;<a class="code" href="classForest_1_1ExtractBV.html#a65cb8788beb5a3e749dc749e0d6a5a2a">calculate_current_ass</a> ();</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// This is the new information for the boundary values (at least for 1d)</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    this-&gt;<a class="code" href="classForest_1_1ExtractBV.html#a0cbd0f00f7dba7e5fd09c5e5e8e99022">calculate_moments_pin</a> ();</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    this-&gt;<a class="code" href="classForest_1_1ExtractBV.html#ae25c13e3567d2af093bae8ac64a2d4bb">calculate_moments_ass</a> ();</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// We print some information if required</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">m_verbose</a>)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    this-&gt;<a class="code" href="classForest_1_1ExtractBV.html#a80dcb45dd9493e06022c4901e58933a0">print_ass_bc</a> ();</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// Read values from file?</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">     if (mp_state.mp_data.mp_settings.get_bcs_from_file ())</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">     this-&gt;read_ass_bv ();</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_a9125303a5919fd4c5782de90b37ca568"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a9125303a5919fd4c5782de90b37ca568">Forest::ExtractBV::calculate_current_pin</a></div><div class="ttdeci">void calculate_current_pin()</div><div class="ttdoc">Calculate neutron current. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00545">extract_bv.cc:545</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af6ab5e3132ab03a469ccca76952378a3"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">Forest::ExtractBV::m_verbose</a></div><div class="ttdeci">bool m_verbose</div><div class="ttdoc">Indicating the level of verbose: 0 = none; 1 = everything. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00058">extract_bv.h:58</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a6de59ddd52559f4858dba74f033aa102"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a6de59ddd52559f4858dba74f033aa102">Forest::ExtractBV::set_ass_bc</a></div><div class="ttdeci">void set_ass_bc()</div><div class="ttdoc">Identifying and storing the boundary cells for each assembly. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00166">extract_bv.cc:166</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a9dea05d81fcbbf6603e3fdb3899122aa"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a9dea05d81fcbbf6603e3fdb3899122aa">Forest::ExtractBV::set_ass_bv</a></div><div class="ttdeci">void set_ass_bv()</div><div class="ttdoc">Fill the boundary values. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00515">extract_bv.cc:515</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae25c13e3567d2af093bae8ac64a2d4bb"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae25c13e3567d2af093bae8ac64a2d4bb">Forest::ExtractBV::calculate_moments_ass</a></div><div class="ttdeci">void calculate_moments_ass()</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00728">extract_bv.cc:728</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_aa3656ff6b3559c8300be5459ddb225d5"><div class="ttname"><a href="classForest_1_1ExtractBV.html#aa3656ff6b3559c8300be5459ddb225d5">Forest::ExtractBV::set_pin_bw</a></div><div class="ttdeci">void set_pin_bw()</div><div class="ttdoc">Fill the boundary weights. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00332">extract_bv.cc:332</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a65cb8788beb5a3e749dc749e0d6a5a2a"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a65cb8788beb5a3e749dc749e0d6a5a2a">Forest::ExtractBV::calculate_current_ass</a></div><div class="ttdeci">void calculate_current_ass()</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00620">extract_bv.cc:620</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ac6e2f36c01f6685bfc60a359f9492f67"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ac6e2f36c01f6685bfc60a359f9492f67">Forest::ExtractBV::set_ass_bw</a></div><div class="ttdeci">void set_ass_bw()</div><div class="ttdoc">Fill the boundary weights. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00463">extract_bv.cc:463</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a0064ed3afe6d28e4a92f418d582d0128"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a0064ed3afe6d28e4a92f418d582d0128">Forest::ExtractBV::set_ass2pin</a></div><div class="ttdeci">void set_ass2pin()</div><div class="ttdoc">Identifying the pin indices over the boundary of the assembly. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00237">extract_bv.cc:237</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a0cbd0f00f7dba7e5fd09c5e5e8e99022"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a0cbd0f00f7dba7e5fd09c5e5e8e99022">Forest::ExtractBV::calculate_moments_pin</a></div><div class="ttdeci">void calculate_moments_pin()</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00685">extract_bv.cc:685</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a80dcb45dd9493e06022c4901e58933a0"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a80dcb45dd9493e06022c4901e58933a0">Forest::ExtractBV::print_ass_bc</a></div><div class="ttdeci">void print_ass_bc()</div><div class="ttdoc">print assembly boundary pointers. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00271">extract_bv.cc:271</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae6ac6165e3c778f4dba03317a3cb7449"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae6ac6165e3c778f4dba03317a3cb7449">Forest::ExtractBV::set_pin_bv</a></div><div class="ttdeci">void set_pin_bv()</div><div class="ttdoc">Extract the boundary conditions for the pins. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00383">extract_bv.cc:383</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae2380fccc89d3f3c8d507445dda9736d"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae2380fccc89d3f3c8d507445dda9736d">Forest::ExtractBV::set_pin_bc</a></div><div class="ttdeci">void set_pin_bc()</div><div class="ttdoc">Identifying and storing the boundary cells for each pin. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00101">extract_bv.cc:101</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a250c6d8962e9b7d646ccd424cfb4edcf_cgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a250c6d8962e9b7d646ccd424cfb4edcf_cgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a250c6d8962e9b7d646ccd424cfb4edcf_cgraph" id="classForest_1_1ExtractBV_a250c6d8962e9b7d646ccd424cfb4edcf_cgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#ae2380fccc89d3f3c8d507445dda9736d" title="Identifying and storing the boundary cells for each pin. " alt="" coords="202,5,337,47"/>
<area shape="rect" id="node4" href="classForest_1_1ExtractBV.html#aa3656ff6b3559c8300be5459ddb225d5" title="Fill the boundary weights. " alt="" coords="202,136,337,177"/>
<area shape="rect" id="node5" href="classForest_1_1ExtractBV.html#ae6ac6165e3c778f4dba03317a3cb7449" title="Extract the boundary conditions for the pins. " alt="" coords="202,201,337,243"/>
<area shape="rect" id="node7" href="classForest_1_1ExtractBV.html#a6de59ddd52559f4858dba74f033aa102" title="Identifying and storing the boundary cells for each assembly. " alt="" coords="202,71,337,112"/>
<area shape="rect" id="node8" href="classForest_1_1ExtractBV.html#a0064ed3afe6d28e4a92f418d582d0128" title="Identifying the pin indices over the boundary of the assembly. " alt="" coords="202,267,337,308"/>
<area shape="rect" id="node9" href="classForest_1_1ExtractBV.html#ac6e2f36c01f6685bfc60a359f9492f67" title="Fill the boundary weights. " alt="" coords="202,332,337,373"/>
<area shape="rect" id="node10" href="classForest_1_1ExtractBV.html#a9dea05d81fcbbf6603e3fdb3899122aa" title="Fill the boundary values. " alt="" coords="202,397,337,439"/>
<area shape="rect" id="node11" href="classForest_1_1ExtractBV.html#a9125303a5919fd4c5782de90b37ca568" title="Calculate neutron current. " alt="" coords="197,463,342,504"/>
<area shape="rect" id="node13" href="classForest_1_1ExtractBV.html#a65cb8788beb5a3e749dc749e0d6a5a2a" title="Forest::ExtractBV::\lcalculate_current_ass" alt="" coords="195,528,344,569"/>
<area shape="rect" id="node14" href="classForest_1_1ExtractBV.html#a0cbd0f00f7dba7e5fd09c5e5e8e99022" title="Forest::ExtractBV::\lcalculate_moments_pin" alt="" coords="190,593,349,635"/>
<area shape="rect" id="node19" href="classForest_1_1ExtractBV.html#ae25c13e3567d2af093bae8ac64a2d4bb" title="Forest::ExtractBV::\lcalculate_moments_ass" alt="" coords="188,659,351,700"/>
<area shape="rect" id="node20" href="classForest_1_1ExtractBV.html#a80dcb45dd9493e06022c4901e58933a0" title="print assembly boundary pointers. " alt="" coords="202,724,337,765"/>
<area shape="rect" id="node3" href="namespaceForest.html#a8fd2956242af117d63dbef3e7cfcbc5f" title="Find the face for which the vector is an outgoing vector. " alt="" coords="421,46,560,73"/>
<area shape="rect" id="node6" href="classForest_1_1ExtractBV.html#a5b2316461095ae7f588c219cc247c254" title="Fill the containers for the bcs. " alt="" coords="423,201,558,243"/>
<area shape="rect" id="node12" href="namespaceForest.html#ad32ead9259e9e648897dd5fc7c7a7ebd" title="Forest::p_normal" alt="" coords="431,473,551,499"/>
<area shape="rect" id="node15" href="classForest_1_1MomentIndexer.html#a9e95d49b9835e10c3f411a6076130b60" title="Return number of moments. " alt="" coords="402,724,579,765"/>
<area shape="rect" id="node16" href="classForest_1_1MomentIndexer.html#a9d1d2f573d0a986d807ed206a94156a8" title="Returns l value. " alt="" coords="412,528,569,569"/>
<area shape="rect" id="node17" href="classForest_1_1MomentIndexer.html#aec7c97dd4cb24620e8028f057f3a2069" title="Return m value. " alt="" coords="412,593,569,635"/>
<area shape="rect" id="node18" href="classForest_1_1SphericalHarmonics.html#aa170c9bc04b989b005cb28fa92eb532a" title="Calculate &#160;given &#160;and &#160;. " alt="" coords="399,659,583,700"/>
</map>
</div>
</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a250c6d8962e9b7d646ccd424cfb4edcf_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a250c6d8962e9b7d646ccd424cfb4edcf_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a250c6d8962e9b7d646ccd424cfb4edcf_icgraph" id="classForest_1_1ExtractBV_a250c6d8962e9b7d646ccd424cfb4edcf_icgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a8279c4e6a40335cebc2c26db7241af60" title="Constructor. " alt="" coords="188,5,323,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7fa88b5ebb1a098120bbbad12e4c6001"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::memory_consumption </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the memory consumption of an object of this class. </p>
<dl class="section return"><dt>Returns</dt><dd>The memory consumption </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000101">Todo:</a></b></dt><dd>prepare this function for the members of this class? </dd></dl>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00083">83</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="classForest_1_1ExtractBV.html#a7fa88b5ebb1a098120bbbad12e4c6001">memory_consumption</a> = 0;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classForest_1_1ExtractBV.html#a7fa88b5ebb1a098120bbbad12e4c6001">memory_consumption</a>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div><div class="ttc" id="classForest_1_1ExtractBV_html_a7fa88b5ebb1a098120bbbad12e4c6001"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a7fa88b5ebb1a098120bbbad12e4c6001">Forest::ExtractBV::memory_consumption</a></div><div class="ttdeci">double memory_consumption() const </div><div class="ttdoc">Return the memory consumption of an object of this class. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00083">extract_bv.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae2380fccc89d3f3c8d507445dda9736d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::set_pin_bc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Identifying and storing the boundary cells for each pin. </p>
<p>The information is store in m_pin_bc, which is a map containing the pairs </p><div class="fragment"><div class="line">std::pair&lt;c_iter, unsigned int&gt; (cell,f)</div></div><!-- fragment --><p> for easy access through an iterator </p><div class="fragment"><div class="line"><span class="keyword">typename</span> std::map&lt;c_iter, unsigned int&gt;::iterator it, end;</div><div class="line">it = <a class="code" href="classForest_1_1ExtractBV.html#a58b31a2d3c8293eb687368f71d0659be">m_pin_bc</a>[pin][face].begin ();</div><div class="line">end = <a class="code" href="classForest_1_1ExtractBV.html#a58b31a2d3c8293eb687368f71d0659be">m_pin_bc</a>[pin][face].end ();</div><div class="line"><span class="keywordflow">for</span> (; it != end; ++it)</div><div class="line">{</div><div class="line">  <a class="code" href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">c_iter</a> cell = it.first;</div><div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = it.second;</div><div class="line">}</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00101">101</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00066">Forest::ExtractBV&lt; dim &gt;::initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// We use some constants</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_pins = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_pins ();</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// Alias for the map</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">//typename std::map&lt;c_iter, unsigned int&gt; map_cf;</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keyword">using</span> <a class="code" href="classForest_1_1ExtractBV.html#a7cd32560420878a05248db7bc13890e1">map_cf</a> = std::map&lt;c_iter, unsigned int&gt;;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// We resize the container with</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a58b31a2d3c8293eb687368f71d0659be">m_pin_bc</a>.resize (n_pins, std::vector&lt;map_cf&gt; (n_faces));</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// We use the finite element to obtain the normal vector</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keyword">const</span> FiniteElement&lt;dim, dim&gt; &amp; fe (<a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_fe ());</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    QGauss&lt;dim - 1&gt; face_quadrature (fe.degree + 1);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keyword">const</span> UpdateFlags face_update_flags = update_quadrature_points</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    | update_normal_vectors;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    FEFaceValues&lt;dim&gt; fe_vface (fe, face_quadrature, face_update_flags);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// We define the iterators an run over all the cells</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">c_iter</a> cell_it = <a class="code" href="classForest_1_1ExtractBV.html#adce3387da7a39374002770c2edd25daa">m_dof_handler</a>.begin_active (), endc = <a class="code" href="classForest_1_1ExtractBV.html#adce3387da7a39374002770c2edd25daa">m_dof_handler</a>.end ();</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">for</span> (; cell_it != endc; ++cell_it)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell = cell_it-&gt;user_index ();</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pin = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_cell2pin (cell);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="comment">// Now we run over all the faces</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">if</span> (cell_it-&gt;face(f)-&gt;at_boundary())</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          fe_vface.reinit (cell_it, f);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          <span class="keyword">const</span> Tensor&lt;1,dim&gt; &amp;normal0 = fe_vface.normal_vector (0);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = <a class="code" href="namespaceForest.html#a8fd2956242af117d63dbef3e7cfcbc5f">normal2face</a> (normal0);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a58b31a2d3c8293eb687368f71d0659be">m_pin_bc</a>[pin][face].insert (std::make_pair (cell_it, f));</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell_neigh;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">if</span> (cell_it-&gt;neighbor(f)-&gt;has_children())</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          cell_neigh = cell_it-&gt;neighbor(f)-&gt;child_index(0);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          cell_neigh = cell_it-&gt;neighbor(f)-&gt;user_index();</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pin_neigh = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_cell2pin (cell_neigh);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">// If the neighbor cell belong to a different pin, we want its face</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span> (pin != pin_neigh)</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          fe_vface.reinit (cell_it, f);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor">#if DEAL_II_VERSION_GTE(8,4,0)</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          <span class="keyword">const</span> Tensor&lt;1,dim&gt; &amp;normal0 = fe_vface.normal_vector (0);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          <span class="keyword">const</span> Point&lt;dim&gt; &amp;normal0 = fe_vface.normal_vector (0);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = <a class="code" href="namespaceForest.html#a8fd2956242af117d63dbef3e7cfcbc5f">normal2face</a> (normal0);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a58b31a2d3c8293eb687368f71d0659be">m_pin_bc</a>[pin][face].insert (std::make_pair (cell_it, f));</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_adce3387da7a39374002770c2edd25daa"><div class="ttname"><a href="classForest_1_1ExtractBV.html#adce3387da7a39374002770c2edd25daa">Forest::ExtractBV::m_dof_handler</a></div><div class="ttdeci">const DoFHandler&lt; dim, dim &gt; &amp; m_dof_handler</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00068">extract_bv.h:68</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a58b31a2d3c8293eb687368f71d0659be"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a58b31a2d3c8293eb687368f71d0659be">Forest::ExtractBV::m_pin_bc</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; map_cf &gt; &gt; m_pin_bc</div><div class="ttdoc">m_pin_bc[pin][face] is a map containing the pairs pair(cell,f), so we can easily find the cells and f...</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00333">extract_bv.h:333</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_abd57835ed1e2c7414f83078efce7ffbf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">Forest::ExtractBV::mp_state</a></div><div class="ttdeci">const State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference to the state object. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00061">extract_bv.h:61</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="namespaceForest_html_a8fd2956242af117d63dbef3e7cfcbc5f"><div class="ttname"><a href="namespaceForest.html#a8fd2956242af117d63dbef3e7cfcbc5f">Forest::normal2face</a></div><div class="ttdeci">unsigned int normal2face(const Tensor&lt; 1, dim &gt; &amp;normal)</div><div class="ttdoc">Find the face for which the vector is an outgoing vector. </div><div class="ttdef"><b>Definition:</b> <a href="forest__utils__dealii_8h_source.html#l00217">forest_utils_dealii.h:217</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a97d76e898d530f2406efe3ec5716bac9"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">Forest::ExtractBV::c_iter</a></div><div class="ttdeci">DoFHandler&lt; dim, dim &gt;::active_cell_iterator c_iter</div><div class="ttdoc">shortcut for the cell_iterator type </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00323">extract_bv.h:323</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a7cd32560420878a05248db7bc13890e1"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a7cd32560420878a05248db7bc13890e1">Forest::ExtractBV::map_cf</a></div><div class="ttdeci">std::map&lt; c_iter, unsigned int &gt; map_cf</div><div class="ttdoc">shortcut for the map &lt;cell_iterator, face&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00326">extract_bv.h:326</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_ae2380fccc89d3f3c8d507445dda9736d_cgraph.png" border="0" usemap="#classForest_1_1ExtractBV_ae2380fccc89d3f3c8d507445dda9736d_cgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_ae2380fccc89d3f3c8d507445dda9736d_cgraph" id="classForest_1_1ExtractBV_ae2380fccc89d3f3c8d507445dda9736d_cgraph">
<area shape="rect" id="node2" href="namespaceForest.html#a8fd2956242af117d63dbef3e7cfcbc5f" title="Find the face for which the vector is an outgoing vector. " alt="" coords="188,13,327,39"/>
</map>
</div>
</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_ae2380fccc89d3f3c8d507445dda9736d_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_ae2380fccc89d3f3c8d507445dda9736d_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_ae2380fccc89d3f3c8d507445dda9736d_icgraph" id="classForest_1_1ExtractBV_ae2380fccc89d3f3c8d507445dda9736d_icgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf" title="Intialize the members of the class that need it. " alt="" coords="188,5,323,47"/>
<area shape="rect" id="node3" href="classForest_1_1ExtractBV.html#a8279c4e6a40335cebc2c26db7241af60" title="Constructor. " alt="" coords="371,5,505,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa3656ff6b3559c8300be5459ddb225d5"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::set_pin_bw </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill the boundary weights. </p>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00332">332</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00066">Forest::ExtractBV&lt; dim &gt;::initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">// We need some constants</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_pins = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_pins ();</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// We resize the containers</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a601c8ad25bfa0d43984c2cf2b5cd8a50">m_pin_bw</a>.resize (n_pins, std::vector&lt;double&gt; (n_faces, 0.));</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// Finite element things</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keyword">const</span> FiniteElement&lt;dim, dim&gt; &amp; fe (<a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_fe ());</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    QGauss&lt;dim - 1&gt; face_quadrature (fe.degree + 1);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keyword">const</span> UpdateFlags face_update_flags = update_values | update_JxW_values</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    | update_quadrature_points</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    | update_normal_vectors;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    FEFaceValues&lt;dim&gt; fe_values_face (<a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_mapping (), fe,</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        face_quadrature, face_update_flags);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q = fe_values_face.n_quadrature_points;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// Run over the pin faces to extract average values per group and angle</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pin = 0; pin &lt; n_pins; ++pin)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="comment">// In order to store average spatial values, we calculate the measure</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="comment">// of the pin face to divide the integral of the flux by this value</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <a class="code" href="classForest_1_1ExtractBV.html#a601c8ad25bfa0d43984c2cf2b5cd8a50">m_pin_bw</a>[pin][f] = 0.;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="comment">// We run over the cells composing this pin face and integrate</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keyword">typename</span> map_cf::iterator it, end;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      it = <a class="code" href="classForest_1_1ExtractBV.html#a58b31a2d3c8293eb687368f71d0659be">m_pin_bc</a>[pin][f].begin ();</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      end = <a class="code" href="classForest_1_1ExtractBV.html#a58b31a2d3c8293eb687368f71d0659be">m_pin_bc</a>[pin][f].end ();</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keywordflow">for</span> (; it != end; ++it)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">c_iter</a> cell_it = it-&gt;first;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f2 = it-&gt;second;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="comment">// Update fem face information</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        fe_values_face.reinit (cell_it, f2);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keyword">const</span> std::vector&lt;double&gt; &amp;JxW = fe_values_face.get_JxW_values ();</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment">// Cumulative contribution of the cell face length</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordtype">double</span> cell_f_measure = 0;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_q; ++q)</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        cell_f_measure += JxW[q];</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#a601c8ad25bfa0d43984c2cf2b5cd8a50">m_pin_bw</a>[pin][f] += cell_f_measure;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_a58b31a2d3c8293eb687368f71d0659be"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a58b31a2d3c8293eb687368f71d0659be">Forest::ExtractBV::m_pin_bc</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; map_cf &gt; &gt; m_pin_bc</div><div class="ttdoc">m_pin_bc[pin][face] is a map containing the pairs pair(cell,f), so we can easily find the cells and f...</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00333">extract_bv.h:333</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_abd57835ed1e2c7414f83078efce7ffbf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">Forest::ExtractBV::mp_state</a></div><div class="ttdeci">const State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference to the state object. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00061">extract_bv.h:61</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a601c8ad25bfa0d43984c2cf2b5cd8a50"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a601c8ad25bfa0d43984c2cf2b5cd8a50">Forest::ExtractBV::m_pin_bw</a></div><div class="ttdeci">stdvd2 m_pin_bw</div><div class="ttdoc">Container for the pin faces boundary weight. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00343">extract_bv.h:343</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a97d76e898d530f2406efe3ec5716bac9"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">Forest::ExtractBV::c_iter</a></div><div class="ttdeci">DoFHandler&lt; dim, dim &gt;::active_cell_iterator c_iter</div><div class="ttdoc">shortcut for the cell_iterator type </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00323">extract_bv.h:323</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_aa3656ff6b3559c8300be5459ddb225d5_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_aa3656ff6b3559c8300be5459ddb225d5_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_aa3656ff6b3559c8300be5459ddb225d5_icgraph" id="classForest_1_1ExtractBV_aa3656ff6b3559c8300be5459ddb225d5_icgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf" title="Intialize the members of the class that need it. " alt="" coords="188,5,323,47"/>
<area shape="rect" id="node3" href="classForest_1_1ExtractBV.html#a8279c4e6a40335cebc2c26db7241af60" title="Constructor. " alt="" coords="371,5,505,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae6ac6165e3c778f4dba03317a3cb7449"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::set_pin_bv </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract the boundary conditions for the pins. </p>
<p>We take the scalar flux and its moments, we converted to the angular flux with the moments-to-directions operator, and extract the flux from there. </p><dl class="section warning"><dt>Warning</dt><dd>This should be done when the flux is already converged, so the angular flux has the right value at the boundaries that can be extracted, without solving again the problem. This is based on the assumption that <p class="formulaDsp">
\begin{align} MD \approx I \end{align}
</p>
 so we have the approximation <p class="formulaDsp">
\begin{align} \Psi\approx MD \Psi = M \phi , \end{align}
</p>
 what in general is absolutely ** not ** true. </dd></dl>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00383">383</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00066">Forest::ExtractBV&lt; dim &gt;::initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">// We need some constants</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">//const unsigned int n_ass = mp_geom.get_n_assemblies ();</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_pins = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_pins ();</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_groups = <a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_n_groups ();</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">// Resize the container</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>.resize (n_pins,</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_groups, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (<a class="code" href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">m_n_angles</a>, 0.))));</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">// Approximate psi_n and then extract the boundary values with fill_bv_g_n</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> g = 0; g &lt; n_groups; ++g)</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">m_n_angles</a>; ++n)</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="comment">// pointer to the angular flux for group g and direction n</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keyword">const</span> Vector&lt;double&gt; &amp; psi_g_n = <a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.m_psi.m_data[g].block(n);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="comment">// get the bv for this group and angle</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      this-&gt;<a class="code" href="classForest_1_1ExtractBV.html#a5b2316461095ae7f588c219cc247c254">set_pin_bv_g_n</a> (psi_g_n, g, n);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_a20d4126d42f8027c6f1e4df21943a8d4"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">Forest::ExtractBV::m_pin_bv</a></div><div class="ttdeci">stdvd4 m_pin_bv</div><div class="ttdoc">Container for the pin faces boundary values. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00355">extract_bv.h:355</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a5b2316461095ae7f588c219cc247c254"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a5b2316461095ae7f588c219cc247c254">Forest::ExtractBV::set_pin_bv_g_n</a></div><div class="ttdeci">void set_pin_bv_g_n(const Vector&lt; double &gt; &amp;psi_n, const unsigned int g, const unsigned int n)</div><div class="ttdoc">Fill the containers for the bcs. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00408">extract_bv.cc:408</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_abd57835ed1e2c7414f83078efce7ffbf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">Forest::ExtractBV::mp_state</a></div><div class="ttdeci">const State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference to the state object. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00061">extract_bv.h:61</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a35b18eb8254953070491cb4709354451"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">Forest::ExtractBV::stdvd3</a></div><div class="ttdeci">std::vector&lt; stdvd2 &gt; stdvd3</div><div class="ttdoc">recursive shortcut for std::vector&lt;std_vd2&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00309">extract_bv.h:309</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae767775a85397eb408e80f7f746e64ae"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">Forest::ExtractBV::stdvd2</a></div><div class="ttdeci">std::vector&lt; stdvd1 &gt; stdvd2</div><div class="ttdoc">recursive shortcut for std::vector&lt;std_vd1&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00307">extract_bv.h:307</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ac1f52b84cf1905c1626d5b0af3d7a688"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">Forest::ExtractBV::stdvd1</a></div><div class="ttdeci">std::vector&lt; double &gt; stdvd1</div><div class="ttdoc">shortcut for std::vector&lt;double&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00305">extract_bv.h:305</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a5973ec1792ae1bbc91ffec9feeab23fd"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">Forest::ExtractBV::m_n_angles</a></div><div class="ttdeci">const unsigned int m_n_angles</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00070">extract_bv.h:70</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_ae6ac6165e3c778f4dba03317a3cb7449_cgraph.png" border="0" usemap="#classForest_1_1ExtractBV_ae6ac6165e3c778f4dba03317a3cb7449_cgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_ae6ac6165e3c778f4dba03317a3cb7449_cgraph" id="classForest_1_1ExtractBV_ae6ac6165e3c778f4dba03317a3cb7449_cgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a5b2316461095ae7f588c219cc247c254" title="Fill the containers for the bcs. " alt="" coords="188,5,323,47"/>
</map>
</div>
</p>

<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_ae6ac6165e3c778f4dba03317a3cb7449_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_ae6ac6165e3c778f4dba03317a3cb7449_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_ae6ac6165e3c778f4dba03317a3cb7449_icgraph" id="classForest_1_1ExtractBV_ae6ac6165e3c778f4dba03317a3cb7449_icgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf" title="Intialize the members of the class that need it. " alt="" coords="188,5,323,47"/>
<area shape="rect" id="node3" href="classForest_1_1ExtractBV.html#a8279c4e6a40335cebc2c26db7241af60" title="Constructor. " alt="" coords="371,5,505,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5b2316461095ae7f588c219cc247c254"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::set_pin_bv_g_n </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classdealii_1_1Vector.html">Vector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>psi_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill the containers for the bcs. </p>
<p>with its values. </p>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00408">408</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00383">Forest::ExtractBV&lt; dim &gt;::set_pin_bv()</a>.</p>
<div class="fragment"><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// We need some constants</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_pins = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_pins ();</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">// Finite element things</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keyword">const</span> FiniteElement&lt;dim, dim&gt; &amp; fe (<a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_fe ());</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    QGauss&lt;dim - 1&gt; face_quadrature (fe.degree + 1);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keyword">const</span> UpdateFlags face_update_flags = update_values | update_JxW_values</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    | update_quadrature_points</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    | update_normal_vectors;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    FEFaceValues&lt;dim&gt; fe_values_face (<a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_mapping (), fe,</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        face_quadrature, face_update_flags);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q = fe_values_face.n_quadrature_points;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    std::vector&lt;unsigned int&gt; local_dof_indices (fe.dofs_per_cell);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// Run over the pin faces to extract average values per group and angle</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pin = 0; pin &lt; n_pins; ++pin)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; GeometryInfo&lt;dim&gt;::faces_per_cell; ++f)</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="comment">// We run over the cells composing this pin face and integrate</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keyword">typename</span> map_cf::iterator it, end;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      it = <a class="code" href="classForest_1_1ExtractBV.html#a58b31a2d3c8293eb687368f71d0659be">m_pin_bc</a>[pin][f].begin ();</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      end = <a class="code" href="classForest_1_1ExtractBV.html#a58b31a2d3c8293eb687368f71d0659be">m_pin_bc</a>[pin][f].end ();</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keywordflow">for</span> (; it != end; ++it)</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      {</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">c_iter</a> cell_it = it-&gt;first;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f2 = it-&gt;second;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">// Update fem face information</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        fe_values_face.reinit (cell_it, f2);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keyword">const</span> std::vector&lt;double&gt; &amp;JxW = fe_values_face.get_JxW_values ();</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        cell_it-&gt;get_dof_indices (local_dof_indices);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="comment">// Cumulative contribution of the flux per cell face</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordtype">double</span> value = 0;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_q; ++q)</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; fe.dofs_per_cell; ++j)</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        value += psi_n (local_dof_indices[j])</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        * fe_values_face.shape_value (j, q) * JxW[q];</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="comment">//[pin][face][group_g][angle]</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>[pin][f][g][n] += value;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      }</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="comment">// divide by the length of the interval to obtain the normalized value</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>[pin][f][g][n] = <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>[pin][f][g][n] / <a class="code" href="classForest_1_1ExtractBV.html#a601c8ad25bfa0d43984c2cf2b5cd8a50">m_pin_bw</a>[pin][f];</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      Assert(numbers::is_finite(<a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>[pin][f][g][n]),</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;             ExcMessage(<span class="stringliteral">&quot;Not finite number found&quot;</span>));</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_a20d4126d42f8027c6f1e4df21943a8d4"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">Forest::ExtractBV::m_pin_bv</a></div><div class="ttdeci">stdvd4 m_pin_bv</div><div class="ttdoc">Container for the pin faces boundary values. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00355">extract_bv.h:355</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a58b31a2d3c8293eb687368f71d0659be"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a58b31a2d3c8293eb687368f71d0659be">Forest::ExtractBV::m_pin_bc</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; map_cf &gt; &gt; m_pin_bc</div><div class="ttdoc">m_pin_bc[pin][face] is a map containing the pairs pair(cell,f), so we can easily find the cells and f...</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00333">extract_bv.h:333</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_abd57835ed1e2c7414f83078efce7ffbf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">Forest::ExtractBV::mp_state</a></div><div class="ttdeci">const State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference to the state object. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00061">extract_bv.h:61</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a601c8ad25bfa0d43984c2cf2b5cd8a50"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a601c8ad25bfa0d43984c2cf2b5cd8a50">Forest::ExtractBV::m_pin_bw</a></div><div class="ttdeci">stdvd2 m_pin_bw</div><div class="ttdoc">Container for the pin faces boundary weight. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00343">extract_bv.h:343</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a97d76e898d530f2406efe3ec5716bac9"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">Forest::ExtractBV::c_iter</a></div><div class="ttdeci">DoFHandler&lt; dim, dim &gt;::active_cell_iterator c_iter</div><div class="ttdoc">shortcut for the cell_iterator type </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00323">extract_bv.h:323</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a5b2316461095ae7f588c219cc247c254_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a5b2316461095ae7f588c219cc247c254_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a5b2316461095ae7f588c219cc247c254_icgraph" id="classForest_1_1ExtractBV_a5b2316461095ae7f588c219cc247c254_icgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#ae6ac6165e3c778f4dba03317a3cb7449" title="Extract the boundary conditions for the pins. " alt="" coords="188,5,323,47"/>
<area shape="rect" id="node3" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf" title="Intialize the members of the class that need it. " alt="" coords="371,5,505,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6de59ddd52559f4858dba74f033aa102"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::set_ass_bc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Identifying and storing the boundary cells for each assembly. </p>
<p>The information is store in m_ass_bc, which is a map containing the pairs </p><div class="fragment"><div class="line">std::pair&lt;c_iter, unsigned int&gt; (cell,f)</div></div><!-- fragment --><p> for easy access through an iterator </p><div class="fragment"><div class="line"><span class="keyword">typename</span> std::map&lt;c_iter, unsigned int&gt;::iterator it, end;</div><div class="line">it = <a class="code" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a>[ass][face].begin ();</div><div class="line">end = <a class="code" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a>[ass][face].end ();</div><div class="line"><span class="keywordflow">for</span> (; it != end; ++it)</div><div class="line">{</div><div class="line">  <a class="code" href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">c_iter</a> cell = it.first;</div><div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = it.second;</div><div class="line">}</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00166">166</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00066">Forest::ExtractBV&lt; dim &gt;::initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// We talk</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">m_verbose</a>)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot; set_ass_boundary &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// We use some constants</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_ass = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_assemblies ();</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// We resize the container with</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a>.resize (n_ass,</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        std::vector&lt;std::map&lt;c_iter, unsigned int&gt; &gt; (n_faces));</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// We use the finite element to obtain the normal vector</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keyword">const</span> FiniteElement&lt;dim, dim&gt; &amp; fe (<a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_fe ());</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    QGauss&lt;dim - 1&gt; face_quadrature (fe.degree + 1);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keyword">const</span> UpdateFlags face_update_flags = update_quadrature_points</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    | update_normal_vectors;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    FEFaceValues&lt;dim&gt; fe_vface (fe, face_quadrature, face_update_flags);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// We define the iterators an run over all the cells</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">c_iter</a> cell_it = <a class="code" href="classForest_1_1ExtractBV.html#adce3387da7a39374002770c2edd25daa">m_dof_handler</a>.begin_active (), endc = <a class="code" href="classForest_1_1ExtractBV.html#adce3387da7a39374002770c2edd25daa">m_dof_handler</a>.end ();</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">for</span> (; cell_it != endc; ++cell_it)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell = cell_it-&gt;user_index ();</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pin = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_cell2pin (cell);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ass = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_pin2assembly (pin);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="comment">// Now we run over all the faces</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">if</span> (cell_it-&gt;face(f)-&gt;at_boundary())</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          fe_vface.reinit (cell_it, f);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">#if DEAL_II_VERSION_GTE(8,4,0)</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          <span class="keyword">const</span> Tensor&lt;1,dim&gt; &amp;normal0 = fe_vface.normal_vector (0);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          <span class="keyword">const</span> Point&lt;dim&gt; &amp;normal0 = fe_vface.normal_vector (0);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = <a class="code" href="namespaceForest.html#a8fd2956242af117d63dbef3e7cfcbc5f">normal2face</a> (normal0);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a>[ass][face].insert (std::make_pair (cell_it, f));</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell_neigh;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">if</span> (cell_it-&gt;neighbor(f)-&gt;has_children())</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          cell_neigh = cell_it-&gt;neighbor(f)-&gt;child_index(0);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          cell_neigh = cell_it-&gt;neighbor(f)-&gt;user_index();</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ass_neigh = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_cell2assembly (cell_neigh);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="comment">// If the neighbor cell belong to a different assembly, we want its face</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">if</span> (ass != ass_neigh)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          fe_vface.reinit (cell_it, f);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">#if DEAL_II_VERSION_GTE(8,4,0)</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          <span class="keyword">const</span> Tensor&lt;1,dim&gt; &amp;normal0 = fe_vface.normal_vector (0);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          <span class="keyword">const</span> Point&lt;dim&gt; &amp;normal0 = fe_vface.normal_vector (0);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = <a class="code" href="namespaceForest.html#a8fd2956242af117d63dbef3e7cfcbc5f">normal2face</a> (normal0);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a>[ass][face].insert (std::make_pair (cell_it, f));</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_adce3387da7a39374002770c2edd25daa"><div class="ttname"><a href="classForest_1_1ExtractBV.html#adce3387da7a39374002770c2edd25daa">Forest::ExtractBV::m_dof_handler</a></div><div class="ttdeci">const DoFHandler&lt; dim, dim &gt; &amp; m_dof_handler</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00068">extract_bv.h:68</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_abd57835ed1e2c7414f83078efce7ffbf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">Forest::ExtractBV::mp_state</a></div><div class="ttdeci">const State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference to the state object. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00061">extract_bv.h:61</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af6ab5e3132ab03a469ccca76952378a3"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">Forest::ExtractBV::m_verbose</a></div><div class="ttdeci">bool m_verbose</div><div class="ttdoc">Indicating the level of verbose: 0 = none; 1 = everything. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00058">extract_bv.h:58</a></div></div>
<div class="ttc" id="namespaceForest_html_a8fd2956242af117d63dbef3e7cfcbc5f"><div class="ttname"><a href="namespaceForest.html#a8fd2956242af117d63dbef3e7cfcbc5f">Forest::normal2face</a></div><div class="ttdeci">unsigned int normal2face(const Tensor&lt; 1, dim &gt; &amp;normal)</div><div class="ttdoc">Find the face for which the vector is an outgoing vector. </div><div class="ttdef"><b>Definition:</b> <a href="forest__utils__dealii_8h_source.html#l00217">forest_utils_dealii.h:217</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a97d76e898d530f2406efe3ec5716bac9"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">Forest::ExtractBV::c_iter</a></div><div class="ttdeci">DoFHandler&lt; dim, dim &gt;::active_cell_iterator c_iter</div><div class="ttdoc">shortcut for the cell_iterator type </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00323">extract_bv.h:323</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a21d3a9bbcde5245008763f732c27e4ce"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">Forest::ExtractBV::m_ass_bc</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; map_cf &gt; &gt; m_ass_bc</div><div class="ttdoc">boundary container for the assembly sorting cells and faces </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00384">extract_bv.h:384</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a6de59ddd52559f4858dba74f033aa102_cgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a6de59ddd52559f4858dba74f033aa102_cgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a6de59ddd52559f4858dba74f033aa102_cgraph" id="classForest_1_1ExtractBV_a6de59ddd52559f4858dba74f033aa102_cgraph">
<area shape="rect" id="node2" href="namespaceForest.html#a8fd2956242af117d63dbef3e7cfcbc5f" title="Find the face for which the vector is an outgoing vector. " alt="" coords="188,13,327,39"/>
</map>
</div>
</p>

<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a6de59ddd52559f4858dba74f033aa102_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a6de59ddd52559f4858dba74f033aa102_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a6de59ddd52559f4858dba74f033aa102_icgraph" id="classForest_1_1ExtractBV_a6de59ddd52559f4858dba74f033aa102_icgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf" title="Intialize the members of the class that need it. " alt="" coords="188,5,323,47"/>
<area shape="rect" id="node3" href="classForest_1_1ExtractBV.html#a8279c4e6a40335cebc2c26db7241af60" title="Constructor. " alt="" coords="371,5,505,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0064ed3afe6d28e4a92f418d582d0128"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::set_ass2pin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Identifying the pin indices over the boundary of the assembly. </p>
<p>The information is store in m_ass2pin, which is a map containing the pairs </p><div class="fragment"><div class="line">std::pair&lt;unsigned int, unsigned int&gt; (pin, counter)</div></div><!-- fragment --><p> for easy access through an iterator </p><div class="fragment"><div class="line"><span class="keyword">typename</span> std::map&lt;unsigned int, unsigned int&gt;::iterator it, end;</div><div class="line">it = <a class="code" href="classForest_1_1ExtractBV.html#a6d8ab0ab3b7d3bfa34d4042760890b63">m_ass2pin</a>[ass][face].begin ();</div><div class="line">end = <a class="code" href="classForest_1_1ExtractBV.html#a6d8ab0ab3b7d3bfa34d4042760890b63">m_ass2pin</a>[ass][face].end ();</div><div class="line"><span class="keywordflow">for</span> (; it != end; ++it)</div><div class="line">{</div><div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pin = it.first;</div><div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> counter = it.second;</div><div class="line">}</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00237">237</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00066">Forest::ExtractBV&lt; dim &gt;::initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// We talk</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">m_verbose</a>)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot; set_assembly_boundary_pins &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// We use some constants</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_ass = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_assemblies ();</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// We resize the container with</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a6d8ab0ab3b7d3bfa34d4042760890b63">m_ass2pin</a>.resize (n_ass,</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        std::vector&lt;std::set&lt;unsigned int&gt; &gt; (n_faces));</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// We run over all the assemblies and faces of each assembly</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ass = 0; ass &lt; n_ass; ++ass)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="comment">// We define the iterators an run over all the cells</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keyword">typename</span> std::map&lt;c_iter, unsigned int&gt;::iterator it, end;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      it = <a class="code" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a>[ass][f].begin ();</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      end = <a class="code" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a>[ass][f].end ();</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">for</span> (; it != end; ++it)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="comment">// We extract the id of the pin the cell belongs to and store it</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell = it-&gt;first-&gt;user_index ();</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pin = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_cell2pin (cell);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#a6d8ab0ab3b7d3bfa34d4042760890b63">m_ass2pin</a>[ass][f].insert (pin);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af6ab5e3132ab03a469ccca76952378a3"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">Forest::ExtractBV::m_verbose</a></div><div class="ttdeci">bool m_verbose</div><div class="ttdoc">Indicating the level of verbose: 0 = none; 1 = everything. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00058">extract_bv.h:58</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a6d8ab0ab3b7d3bfa34d4042760890b63"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a6d8ab0ab3b7d3bfa34d4042760890b63">Forest::ExtractBV::m_ass2pin</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::set&lt; unsigned int &gt; &gt; &gt; m_ass2pin</div><div class="ttdoc">Pins over the boundary of the assembly. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00376">extract_bv.h:376</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a21d3a9bbcde5245008763f732c27e4ce"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">Forest::ExtractBV::m_ass_bc</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; map_cf &gt; &gt; m_ass_bc</div><div class="ttdoc">boundary container for the assembly sorting cells and faces </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00384">extract_bv.h:384</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a0064ed3afe6d28e4a92f418d582d0128_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a0064ed3afe6d28e4a92f418d582d0128_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a0064ed3afe6d28e4a92f418d582d0128_icgraph" id="classForest_1_1ExtractBV_a0064ed3afe6d28e4a92f418d582d0128_icgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf" title="Intialize the members of the class that need it. " alt="" coords="188,5,323,47"/>
<area shape="rect" id="node3" href="classForest_1_1ExtractBV.html#a8279c4e6a40335cebc2c26db7241af60" title="Constructor. " alt="" coords="371,5,505,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a80dcb45dd9493e06022c4901e58933a0"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::print_ass_bc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>print assembly boundary pointers. </p>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00271">271</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00066">Forest::ExtractBV&lt; dim &gt;::initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// We talk</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">m_verbose</a>)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot; print_ass_boundary &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// We use some constants</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_ass = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_assemblies ();</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">// We run over all the assemblies and faces of each assembly</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">m_verbose</a>)</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ass = 0; ass &lt; n_ass; ++ass)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;ass , f = &quot;</span> &lt;&lt; ass &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; f &lt;&lt; std::endl;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keyword">typename</span> std::map&lt;c_iter, unsigned int&gt;::iterator it, end;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      it = <a class="code" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a>[ass][f].begin ();</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      end = <a class="code" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a>[ass][f].end ();</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">for</span> (; it != end; ++it)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell = it-&gt;first-&gt;user_index ();</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = it-&gt;second;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  cell,face = &quot;</span> &lt;&lt; cell &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; face &lt;&lt; std::endl;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">m_verbose</a>)</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ass = 0; ass &lt; n_ass; ++ass)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;m_ass_bc[ass][f].size() = &quot;</span> &lt;&lt; <a class="code" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a>[ass][f].size ()</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      &lt;&lt; std::endl;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keyword">typename</span> std::map&lt;c_iter, unsigned int&gt;::iterator it, end;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      it = <a class="code" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a>[ass][f].begin ();</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      end = <a class="code" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a>[ass][f].end ();</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">for</span> (; it != end; ++it)</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell = it-&gt;first-&gt;user_index ();</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = it-&gt;second;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  cell,face = &quot;</span> &lt;&lt; cell &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; face &lt;&lt; std::endl;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">m_verbose</a>)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ass = 0; ass &lt; n_ass; ++ass)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;m_ass2pin[ass][f].size() = &quot;</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      &lt;&lt; <a class="code" href="classForest_1_1ExtractBV.html#a6d8ab0ab3b7d3bfa34d4042760890b63">m_ass2pin</a>[ass][f].size () &lt;&lt; std::endl;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keyword">typename</span> std::set&lt;unsigned int&gt;::iterator it, end;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      it = <a class="code" href="classForest_1_1ExtractBV.html#a6d8ab0ab3b7d3bfa34d4042760890b63">m_ass2pin</a>[ass][f].begin ();</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      end = <a class="code" href="classForest_1_1ExtractBV.html#a6d8ab0ab3b7d3bfa34d4042760890b63">m_ass2pin</a>[ass][f].end ();</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keywordflow">for</span> (; it != end; ++it)</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pin = *it;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;  pin = &quot;</span> &lt;&lt; pin &lt;&lt; std::endl;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af6ab5e3132ab03a469ccca76952378a3"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">Forest::ExtractBV::m_verbose</a></div><div class="ttdeci">bool m_verbose</div><div class="ttdoc">Indicating the level of verbose: 0 = none; 1 = everything. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00058">extract_bv.h:58</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a6d8ab0ab3b7d3bfa34d4042760890b63"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a6d8ab0ab3b7d3bfa34d4042760890b63">Forest::ExtractBV::m_ass2pin</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::set&lt; unsigned int &gt; &gt; &gt; m_ass2pin</div><div class="ttdoc">Pins over the boundary of the assembly. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00376">extract_bv.h:376</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a21d3a9bbcde5245008763f732c27e4ce"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">Forest::ExtractBV::m_ass_bc</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; map_cf &gt; &gt; m_ass_bc</div><div class="ttdoc">boundary container for the assembly sorting cells and faces </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00384">extract_bv.h:384</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a80dcb45dd9493e06022c4901e58933a0_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a80dcb45dd9493e06022c4901e58933a0_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a80dcb45dd9493e06022c4901e58933a0_icgraph" id="classForest_1_1ExtractBV_a80dcb45dd9493e06022c4901e58933a0_icgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf" title="Intialize the members of the class that need it. " alt="" coords="188,5,323,47"/>
<area shape="rect" id="node3" href="classForest_1_1ExtractBV.html#a8279c4e6a40335cebc2c26db7241af60" title="Constructor. " alt="" coords="371,5,505,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac6e2f36c01f6685bfc60a359f9492f67"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::set_ass_bw </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill the boundary weights. </p>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00463">463</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00066">Forest::ExtractBV&lt; dim &gt;::initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// We need some constants</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_ass = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_assemblies ();</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">// We resize the containers</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#aec313821f23b0f8521a1fc06d8d70bc1">m_ass_bw</a>.resize (n_ass, std::vector&lt;double&gt; (n_faces, 0.));</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">// Finite element things</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keyword">const</span> FiniteElement&lt;dim, dim&gt; &amp; fe (<a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_fe ());</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    QGauss&lt;dim - 1&gt; face_quadrature (fe.degree + 1);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keyword">const</span> UpdateFlags face_update_flags = update_values | update_JxW_values</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    | update_quadrature_points</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    | update_normal_vectors;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    FEFaceValues&lt;dim&gt; fe_values_face (<a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_mapping (), fe,</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        face_quadrature, face_update_flags);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q = fe_values_face.n_quadrature_points;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// Run over the pin faces to extract average values per group and angle</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ass = 0; ass &lt; n_ass; ++ass)</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="comment">// In order to store average spatial values, we calculate the measure</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="comment">// of the ass face to divide the integral of the flux by this value</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <a class="code" href="classForest_1_1ExtractBV.html#aec313821f23b0f8521a1fc06d8d70bc1">m_ass_bw</a>[ass][f] = 0.;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="comment">// We run over the cells composing this ass face and integrate</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keyword">typename</span> map_cf::iterator it, end;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      it = <a class="code" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a>[ass][f].begin ();</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      end = <a class="code" href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">m_ass_bc</a>[ass][f].end ();</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keywordflow">for</span> (; it != end; ++it)</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">c_iter</a> cell_it = it-&gt;first;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f2 = it-&gt;second;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="comment">// Update fem face information</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        fe_values_face.reinit (cell_it, f2);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keyword">const</span> std::vector&lt;double&gt; &amp;JxW = fe_values_face.get_JxW_values ();</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="comment">// Cumulative contribution of the cell face length</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordtype">double</span> cell_f_measure = 0;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_q; ++q)</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        cell_f_measure += JxW[q];</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#aec313821f23b0f8521a1fc06d8d70bc1">m_ass_bw</a>[ass][f] += cell_f_measure;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_abd57835ed1e2c7414f83078efce7ffbf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">Forest::ExtractBV::mp_state</a></div><div class="ttdeci">const State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference to the state object. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00061">extract_bv.h:61</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_aec313821f23b0f8521a1fc06d8d70bc1"><div class="ttname"><a href="classForest_1_1ExtractBV.html#aec313821f23b0f8521a1fc06d8d70bc1">Forest::ExtractBV::m_ass_bw</a></div><div class="ttdeci">stdvd2 m_ass_bw</div><div class="ttdoc">Container for the ass faces boundary weight. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00393">extract_bv.h:393</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a97d76e898d530f2406efe3ec5716bac9"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a97d76e898d530f2406efe3ec5716bac9">Forest::ExtractBV::c_iter</a></div><div class="ttdeci">DoFHandler&lt; dim, dim &gt;::active_cell_iterator c_iter</div><div class="ttdoc">shortcut for the cell_iterator type </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00323">extract_bv.h:323</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a21d3a9bbcde5245008763f732c27e4ce"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a21d3a9bbcde5245008763f732c27e4ce">Forest::ExtractBV::m_ass_bc</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; map_cf &gt; &gt; m_ass_bc</div><div class="ttdoc">boundary container for the assembly sorting cells and faces </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00384">extract_bv.h:384</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_ac6e2f36c01f6685bfc60a359f9492f67_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_ac6e2f36c01f6685bfc60a359f9492f67_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_ac6e2f36c01f6685bfc60a359f9492f67_icgraph" id="classForest_1_1ExtractBV_ac6e2f36c01f6685bfc60a359f9492f67_icgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf" title="Intialize the members of the class that need it. " alt="" coords="188,5,323,47"/>
<area shape="rect" id="node3" href="classForest_1_1ExtractBV.html#a8279c4e6a40335cebc2c26db7241af60" title="Constructor. " alt="" coords="371,5,505,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9dea05d81fcbbf6603e3fdb3899122aa"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::set_ass_bv </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill the boundary values. </p>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00515">515</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00066">Forest::ExtractBV&lt; dim &gt;::initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">// We need some constants</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_ass = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_assemblies ();</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_groups = <a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_n_groups ();</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">// Resize the container</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a>.resize (n_ass,</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_groups, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (<a class="code" href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">m_n_angles</a>, 0.))));</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ass = 0; ass &lt; n_ass; ++ass)</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keyword">typename</span> std::set&lt;unsigned int&gt;::iterator it, end;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      it = <a class="code" href="classForest_1_1ExtractBV.html#a6d8ab0ab3b7d3bfa34d4042760890b63">m_ass2pin</a>[ass][f].begin ();</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      end = <a class="code" href="classForest_1_1ExtractBV.html#a6d8ab0ab3b7d3bfa34d4042760890b63">m_ass2pin</a>[ass][f].end ();</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keywordflow">for</span> (; it != end; ++it)</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pin = *it;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> weight = <a class="code" href="classForest_1_1ExtractBV.html#a601c8ad25bfa0d43984c2cf2b5cd8a50">m_pin_bw</a>[pin][f] / <a class="code" href="classForest_1_1ExtractBV.html#aec313821f23b0f8521a1fc06d8d70bc1">m_ass_bw</a>[ass][f];</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> g = 0; g &lt; n_groups; ++g)</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">m_n_angles</a>; ++n)</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a>[ass][f][g][n] += <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>[pin][f][g][n] * weight;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      }</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_a20d4126d42f8027c6f1e4df21943a8d4"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">Forest::ExtractBV::m_pin_bv</a></div><div class="ttdeci">stdvd4 m_pin_bv</div><div class="ttdoc">Container for the pin faces boundary values. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00355">extract_bv.h:355</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_abd57835ed1e2c7414f83078efce7ffbf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">Forest::ExtractBV::mp_state</a></div><div class="ttdeci">const State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference to the state object. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00061">extract_bv.h:61</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a35b18eb8254953070491cb4709354451"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">Forest::ExtractBV::stdvd3</a></div><div class="ttdeci">std::vector&lt; stdvd2 &gt; stdvd3</div><div class="ttdoc">recursive shortcut for std::vector&lt;std_vd2&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00309">extract_bv.h:309</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a601c8ad25bfa0d43984c2cf2b5cd8a50"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a601c8ad25bfa0d43984c2cf2b5cd8a50">Forest::ExtractBV::m_pin_bw</a></div><div class="ttdeci">stdvd2 m_pin_bw</div><div class="ttdoc">Container for the pin faces boundary weight. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00343">extract_bv.h:343</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae767775a85397eb408e80f7f746e64ae"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">Forest::ExtractBV::stdvd2</a></div><div class="ttdeci">std::vector&lt; stdvd1 &gt; stdvd2</div><div class="ttdoc">recursive shortcut for std::vector&lt;std_vd1&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00307">extract_bv.h:307</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_aec313821f23b0f8521a1fc06d8d70bc1"><div class="ttname"><a href="classForest_1_1ExtractBV.html#aec313821f23b0f8521a1fc06d8d70bc1">Forest::ExtractBV::m_ass_bw</a></div><div class="ttdeci">stdvd2 m_ass_bw</div><div class="ttdoc">Container for the ass faces boundary weight. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00393">extract_bv.h:393</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a6d8ab0ab3b7d3bfa34d4042760890b63"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a6d8ab0ab3b7d3bfa34d4042760890b63">Forest::ExtractBV::m_ass2pin</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::set&lt; unsigned int &gt; &gt; &gt; m_ass2pin</div><div class="ttdoc">Pins over the boundary of the assembly. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00376">extract_bv.h:376</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a23a390ddb4807d3fd585526881b0b877"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">Forest::ExtractBV::m_ass_bv</a></div><div class="ttdeci">stdvd4 m_ass_bv</div><div class="ttdoc">Container for the boundary values for the assembly. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00402">extract_bv.h:402</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ac1f52b84cf1905c1626d5b0af3d7a688"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">Forest::ExtractBV::stdvd1</a></div><div class="ttdeci">std::vector&lt; double &gt; stdvd1</div><div class="ttdoc">shortcut for std::vector&lt;double&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00305">extract_bv.h:305</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a5973ec1792ae1bbc91ffec9feeab23fd"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">Forest::ExtractBV::m_n_angles</a></div><div class="ttdeci">const unsigned int m_n_angles</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00070">extract_bv.h:70</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a9dea05d81fcbbf6603e3fdb3899122aa_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a9dea05d81fcbbf6603e3fdb3899122aa_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a9dea05d81fcbbf6603e3fdb3899122aa_icgraph" id="classForest_1_1ExtractBV_a9dea05d81fcbbf6603e3fdb3899122aa_icgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf" title="Intialize the members of the class that need it. " alt="" coords="188,5,323,47"/>
<area shape="rect" id="node3" href="classForest_1_1ExtractBV.html#a8279c4e6a40335cebc2c26db7241af60" title="Constructor. " alt="" coords="371,5,505,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9125303a5919fd4c5782de90b37ca568"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::calculate_current_pin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate neutron current. </p>
<p>Knowing the angular flux \( \Psi \), the net current is readily available through integration as follows</p>
<p class="formulaDsp">
\begin{align*} \vec{J} &amp; = \int \Omega \Psi(\mathbf{r},\Omega) \ \text{d}\Omega \approx \sum_{n} \omega_{n} \Omega_{n} \Psi_{n}(\mathbf{r}) \end{align*}
</p>
<p>In a similar way, the partial currents for incoming and outgoing directions over a face can be calculated as</p>
<p class="formulaDsp">
\begin{align*} J_{-} &amp; = \int_{\vec{n} \cdot \Omega &lt; 0} (- \vec{n} \cdot \Omega)\Psi(\mathbf{r},\Omega) \ \text{d}\Omega \approx \sum_{\vec{n} \cdot \Omega &lt; 0} \omega_{n} (- \vec{n} \cdot \Omega_{n}) \Psi_{n}(\mathbf{r}) \end{align*}
</p>
<p>and</p>
<p class="formulaDsp">
\begin{align*} J_{+} &amp; = \int_{\vec{n} \cdot \Omega &gt; 0} (\vec{n} \cdot \Omega) \Psi(\mathbf{r},\Omega) \ \text{d}\Omega \approx \sum_{\vec{n} \cdot \Omega &gt; 0} \omega_{n} (\vec{n} \cdot \Omega_{n}) \Psi_{n}(\mathbf{r}) \end{align*}
</p>
<p>where \( \vec{n} \) is the outward vector over the boundary of the domain. We ca use the previous definitions to calculate the normal component of the net current over the direction of the outward direction perpendicular to the face as follows</p>
<p class="formulaDsp">
\begin{align*} \vec{J} \cdot \vec{n} &amp; = \int (\vec{n}\cdot \Omega)\Psi(\mathbf{r},\Omega) \ \text{d}\Omega \\ &amp; = \int_{\vec{n} \cdot \Omega &gt; 0} (\vec{n} \cdot \Omega) \Psi(\mathbf{r},\Omega) \ \text{d}\Omega - \int_{\vec{n} \cdot \Omega &lt; 0} (- \vec{n} \cdot \Omega) \Psi(\mathbf{r},\Omega) \ \text{d}\Omega = J^{+} - J^{-} \end{align*}
</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000102">Todo:</a></b></dt><dd>The angular flux is obtained approximately from the scalar flux. It should be correctly implemented with the right angular flux. </dd></dl>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00545">545</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00066">Forest::ExtractBV&lt; dim &gt;::initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  {</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// We need some constants</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_groups = <a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_n_groups ();</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_pins = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_pins ();</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">// We need some constants for the quadrature</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keyword">const</span> std::vector&lt;double&gt; &amp; w = <a class="code" href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">m_ord</a>-&gt;get_w ();</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;double&gt; &gt; &amp; q = <a class="code" href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">m_ord</a>-&gt;get_q ();</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> eps = 1.e-10;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">// Resize the containers and initialize to zero</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#ab2ec657fef942c86ce29a07178435e6f">m_phi0_pin</a>.resize (n_pins, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (n_groups, 0.)));</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#aa4f9100e9dce4a8c4275abdeebd15487">m_jp_o_pin</a>.resize (n_pins, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (n_groups, 0.)));</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#ae3a86c811e9da115d39ce36d972e9a9a">m_jp_i_pin</a>.resize (n_pins, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (n_groups, 0.)));</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#aa9c71737f27c0d7a213b8ba05642ef51">m_jnet_pin</a>.resize (n_pins,</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_groups, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (dim, 0.))));</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a15d1cfa4b83507500b2ab17e7f98750d">m_j_pin</a>.resize (n_pins, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (n_groups, 0.)));</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a0db15dad2fdc0027f77e122c2503d328">m_phi2_pin</a>.resize (n_pins, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (n_groups, 0.)));</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pin = 0; pin &lt; n_pins; ++pin)</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      Point&lt;dim&gt; <a class="code" href="namespaceForest.html#ad32ead9259e9e648897dd5fc7c7a7ebd">p_normal</a> (p_normal&lt;dim&gt; (f));</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> normal_norm = std::sqrt (<a class="code" href="namespaceForest.html#ad32ead9259e9e648897dd5fc7c7a7ebd">p_normal</a>.square ());</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> g = 0; g &lt; n_groups; ++g)</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      {</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">m_n_angles</a>; ++n)</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;          <span class="comment">// Generate the scalar flux phi0</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#ab2ec657fef942c86ce29a07178435e6f">m_phi0_pin</a>[pin][f][g] += w[n] * <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>[pin][f][g][n];</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;          <span class="comment">// Generate the net current vector</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; dim; ++d)</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#aa9c71737f27c0d7a213b8ba05642ef51">m_jnet_pin</a>[pin][f][g][d] += w[n] * q[n][d] * m_pin_bv[pin][f][g][n];</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          <span class="comment">// Generate the outgoing and incoming partial current J+ J-</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> q_dot_n = vector_to_point&lt;dim&gt; (q[n]) * <a class="code" href="namespaceForest.html#ad32ead9259e9e648897dd5fc7c7a7ebd">p_normal</a>;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;          <span class="keywordflow">if</span> (q_dot_n &gt; eps)</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#aa4f9100e9dce4a8c4275abdeebd15487">m_jp_o_pin</a>[pin][f][g] += w[n] * (q_dot_n) * m_pin_bv[pin][f][g][n];</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#ae3a86c811e9da115d39ce36d972e9a9a">m_jp_i_pin</a>[pin][f][g] += w[n] * (-q_dot_n) * m_pin_bv[pin][f][g][n];</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#a15d1cfa4b83507500b2ab17e7f98750d">m_j_pin</a>[pin][f][g] = <a class="code" href="classForest_1_1ExtractBV.html#aa4f9100e9dce4a8c4275abdeebd15487">m_jp_o_pin</a>[pin][f][g] - <a class="code" href="classForest_1_1ExtractBV.html#ae3a86c811e9da115d39ce36d972e9a9a">m_jp_i_pin</a>[pin][f][g];</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="comment">// cosinus between the net current and the outgoing normal</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        Point&lt;dim&gt; p_jnet (vector_to_point&lt;dim&gt; (<a class="code" href="classForest_1_1ExtractBV.html#aa9c71737f27c0d7a213b8ba05642ef51">m_jnet_pin</a>[pin][f][g]));</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> jnet_dot_norm = p_jnet * <a class="code" href="namespaceForest.html#ad32ead9259e9e648897dd5fc7c7a7ebd">p_normal</a>;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> jnet_norm = std::sqrt (p_jnet.square ());</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordtype">double</span> costheta = 0.0;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="comment">// if theta == 0, then costheta^2 = 1, then p2(costheta) = 1</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordflow">if</span> (jnet_norm &lt; eps)</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;          costheta = 1;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;          costheta = jnet_dot_norm / (jnet_norm * normal_norm);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="comment">// second order legendre polynomial 1/2*(3*x^2-1)</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> p2costheta = 1. / 2 * (3 * std::pow (costheta, 2) - 1.);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#a0db15dad2fdc0027f77e122c2503d328">m_phi2_pin</a>[pin][f][g] =</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        3. / (5. * p2costheta) * (<a class="code" href="classForest_1_1ExtractBV.html#aa4f9100e9dce4a8c4275abdeebd15487">m_jp_o_pin</a>[pin][f][g] + m_jp_i_pin[pin][f][g]</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            - <a class="code" href="classForest_1_1ExtractBV.html#ab2ec657fef942c86ce29a07178435e6f">m_phi0_pin</a>[pin][f][g] / 2.);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">         std::cout &lt;&lt; &quot;m_jp_o[pin][f][g] = &quot; &lt;&lt; std::setprecision(10) &lt;&lt; m_jp_o[pin][f][g] &lt;&lt; std::endl;</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">         std::cout &lt;&lt; &quot;m_jp_i[pin][f][g] = &quot; &lt;&lt; std::setprecision(10) &lt;&lt; m_jp_i[pin][f][g] &lt;&lt; std::endl;</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">         std::cout &lt;&lt; &quot;p_jnet = &quot; &lt;&lt; p_jnet &lt;&lt; std::endl;</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">         std::cout &lt;&lt; &quot;jnet_dot_norm = &quot; &lt;&lt; std::setprecision(10) &lt;&lt; jnet_dot_norm &lt;&lt; std::endl;</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">         std::cout &lt;&lt; &quot;jnet_norm = &quot; &lt;&lt; std::setprecision(10) &lt;&lt; jnet_norm &lt;&lt; std::endl;</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">         std::cout &lt;&lt; &quot;costheta = &quot; &lt;&lt; costheta &lt;&lt; std::endl;</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">         std::cout &lt;&lt; &quot;m_phi2[pin][f][g] = &quot; &lt;&lt; m_phi2[pin][f][g] &lt;&lt; std::endl;</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">         std::cout &lt;&lt; std::endl;*/</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  }</div><div class="ttc" id="namespaceForest_html_ad32ead9259e9e648897dd5fc7c7a7ebd"><div class="ttname"><a href="namespaceForest.html#ad32ead9259e9e648897dd5fc7c7a7ebd">Forest::p_normal</a></div><div class="ttdeci">Tensor&lt; 1, dim &gt; p_normal(unsigned int f)</div><div class="ttdef"><b>Definition:</b> <a href="forest__utils__dealii_8h_source.html#l00191">forest_utils_dealii.h:191</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a20d4126d42f8027c6f1e4df21943a8d4"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">Forest::ExtractBV::m_pin_bv</a></div><div class="ttdeci">stdvd4 m_pin_bv</div><div class="ttdoc">Container for the pin faces boundary values. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00355">extract_bv.h:355</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a0db15dad2fdc0027f77e122c2503d328"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a0db15dad2fdc0027f77e122c2503d328">Forest::ExtractBV::m_phi2_pin</a></div><div class="ttdeci">stdvd3 m_phi2_pin</div><div class="ttdoc">Container for the boundary values for the second moment flux. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00466">extract_bv.h:466</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae3a86c811e9da115d39ce36d972e9a9a"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae3a86c811e9da115d39ce36d972e9a9a">Forest::ExtractBV::m_jp_i_pin</a></div><div class="ttdeci">stdvd3 m_jp_i_pin</div><div class="ttdoc">Container for the values for the incoming partial current. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00438">extract_bv.h:438</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_abd57835ed1e2c7414f83078efce7ffbf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">Forest::ExtractBV::mp_state</a></div><div class="ttdeci">const State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference to the state object. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00061">extract_bv.h:61</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af29b71d47daaad7709879135b04f394c"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">Forest::ExtractBV::m_ord</a></div><div class="ttdeci">std::shared_ptr&lt; QuadratureBase&lt; dim &gt; &gt; m_ord</div><div class="ttdoc">Angular quadrature. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00064">extract_bv.h:64</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a35b18eb8254953070491cb4709354451"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">Forest::ExtractBV::stdvd3</a></div><div class="ttdeci">std::vector&lt; stdvd2 &gt; stdvd3</div><div class="ttdoc">recursive shortcut for std::vector&lt;std_vd2&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00309">extract_bv.h:309</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae767775a85397eb408e80f7f746e64ae"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">Forest::ExtractBV::stdvd2</a></div><div class="ttdeci">std::vector&lt; stdvd1 &gt; stdvd2</div><div class="ttdoc">recursive shortcut for std::vector&lt;std_vd1&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00307">extract_bv.h:307</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a15d1cfa4b83507500b2ab17e7f98750d"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a15d1cfa4b83507500b2ab17e7f98750d">Forest::ExtractBV::m_j_pin</a></div><div class="ttdeci">stdvd3 m_j_pin</div><div class="ttdoc">Container for the boundary values for the net current. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00456">extract_bv.h:456</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ab2ec657fef942c86ce29a07178435e6f"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ab2ec657fef942c86ce29a07178435e6f">Forest::ExtractBV::m_phi0_pin</a></div><div class="ttdeci">stdvd3 m_phi0_pin</div><div class="ttdoc">Container for the boundary values for the flux. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00420">extract_bv.h:420</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_aa4f9100e9dce4a8c4275abdeebd15487"><div class="ttname"><a href="classForest_1_1ExtractBV.html#aa4f9100e9dce4a8c4275abdeebd15487">Forest::ExtractBV::m_jp_o_pin</a></div><div class="ttdeci">stdvd3 m_jp_o_pin</div><div class="ttdoc">Container for the values for the outgoing partial current. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00429">extract_bv.h:429</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ac1f52b84cf1905c1626d5b0af3d7a688"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">Forest::ExtractBV::stdvd1</a></div><div class="ttdeci">std::vector&lt; double &gt; stdvd1</div><div class="ttdoc">shortcut for std::vector&lt;double&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00305">extract_bv.h:305</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a5973ec1792ae1bbc91ffec9feeab23fd"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">Forest::ExtractBV::m_n_angles</a></div><div class="ttdeci">const unsigned int m_n_angles</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00070">extract_bv.h:70</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_aa9c71737f27c0d7a213b8ba05642ef51"><div class="ttname"><a href="classForest_1_1ExtractBV.html#aa9c71737f27c0d7a213b8ba05642ef51">Forest::ExtractBV::m_jnet_pin</a></div><div class="ttdeci">stdvd4 m_jnet_pin</div><div class="ttdoc">Container for the boundary values for the net current. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00447">extract_bv.h:447</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a9125303a5919fd4c5782de90b37ca568_cgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a9125303a5919fd4c5782de90b37ca568_cgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a9125303a5919fd4c5782de90b37ca568_cgraph" id="classForest_1_1ExtractBV_a9125303a5919fd4c5782de90b37ca568_cgraph">
<area shape="rect" id="node2" href="namespaceForest.html#ad32ead9259e9e648897dd5fc7c7a7ebd" title="Forest::p_normal" alt="" coords="199,13,319,39"/>
</map>
</div>
</p>

<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a9125303a5919fd4c5782de90b37ca568_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a9125303a5919fd4c5782de90b37ca568_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a9125303a5919fd4c5782de90b37ca568_icgraph" id="classForest_1_1ExtractBV_a9125303a5919fd4c5782de90b37ca568_icgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf" title="Intialize the members of the class that need it. " alt="" coords="199,5,333,47"/>
<area shape="rect" id="node3" href="classForest_1_1ExtractBV.html#a8279c4e6a40335cebc2c26db7241af60" title="Constructor. " alt="" coords="381,5,516,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a65cb8788beb5a3e749dc749e0d6a5a2a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::calculate_current_ass </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00620">620</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00066">Forest::ExtractBV&lt; dim &gt;::initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">// We need some constants</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_groups = <a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_n_groups ();</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_ass = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_assemblies ();</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">// We need some constants for the quadrature</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keyword">const</span> std::vector&lt;double&gt; &amp; w = <a class="code" href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">m_ord</a>-&gt;get_w ();</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;double&gt; &gt; &amp; q = <a class="code" href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">m_ord</a>-&gt;get_q ();</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> eps = 1.e-10;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">// Resize the containers and initialize to zero</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a0c5cba2999422814170f891cb707d1a0">m_phi0_ass</a>.resize (n_ass, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (n_groups, 0.)));</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a155f5b3d28bfe916661fb56c0d9fe5cb">m_jp_o_ass</a>.resize (n_ass, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (n_groups, 0.)));</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a187bacdfe10d7de8fd46fab9ed802ace">m_jp_i_ass</a>.resize (n_ass, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (n_groups, 0.)));</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a7672e0dfe0d102c2b9ec7d776892ad3d">m_jnet_ass</a>.resize (n_ass,</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_groups, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (dim, 0.))));</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#af1399ae53002bef64f107a18c1dadde3">m_j_ass</a>.resize (n_ass, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (n_groups, 0.)));</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a114e7cbb9584babbbd6758c097d8715f">m_phi2_ass</a>.resize (n_ass, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (n_groups, 0.)));</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ass = 0; ass &lt; n_ass; ++ass)</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      Point&lt;dim&gt; <a class="code" href="namespaceForest.html#ad32ead9259e9e648897dd5fc7c7a7ebd">p_normal</a> (p_normal&lt;dim&gt; (f));</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> normal_norm = std::sqrt (<a class="code" href="namespaceForest.html#ad32ead9259e9e648897dd5fc7c7a7ebd">p_normal</a>.square ());</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> g = 0; g &lt; n_groups; ++g)</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">m_n_angles</a>; ++n)</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        {</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;          <span class="comment">// Generate the scalar flux phi0</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a0c5cba2999422814170f891cb707d1a0">m_phi0_ass</a>[ass][f][g] += w[n] * <a class="code" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a>[ass][f][g][n];</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;          <span class="comment">// Generate the net current vector</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; dim; ++d)</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a7672e0dfe0d102c2b9ec7d776892ad3d">m_jnet_ass</a>[ass][f][g][d] += w[n] * q[n][d] * m_ass_bv[ass][f][g][n];</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;          <span class="comment">// Generate the outgoing and incoming partial current J+ J-</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> q_dot_n = vector_to_point&lt;dim&gt; (q[n]) * <a class="code" href="namespaceForest.html#ad32ead9259e9e648897dd5fc7c7a7ebd">p_normal</a>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;          <span class="keywordflow">if</span> (q_dot_n &gt; eps)</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a155f5b3d28bfe916661fb56c0d9fe5cb">m_jp_o_ass</a>[ass][f][g] += w[n] * (q_dot_n) * m_ass_bv[ass][f][g][n];</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a187bacdfe10d7de8fd46fab9ed802ace">m_jp_i_ass</a>[ass][f][g] += w[n] * (-q_dot_n) * m_ass_bv[ass][f][g][n];</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#af1399ae53002bef64f107a18c1dadde3">m_j_ass</a>[ass][f][g] = <a class="code" href="classForest_1_1ExtractBV.html#a155f5b3d28bfe916661fb56c0d9fe5cb">m_jp_o_ass</a>[ass][f][g] - <a class="code" href="classForest_1_1ExtractBV.html#a187bacdfe10d7de8fd46fab9ed802ace">m_jp_i_ass</a>[ass][f][g];</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="comment">// cosinus between the net current and the outgoing normal</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        Point&lt;dim&gt; p_jnet (vector_to_point&lt;dim&gt; (<a class="code" href="classForest_1_1ExtractBV.html#a7672e0dfe0d102c2b9ec7d776892ad3d">m_jnet_ass</a>[ass][f][g]));</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> jnet_dot_norm = p_jnet * <a class="code" href="namespaceForest.html#ad32ead9259e9e648897dd5fc7c7a7ebd">p_normal</a>;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> jnet_norm = std::sqrt (p_jnet.square ());</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordtype">double</span> costheta = 0.0;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="comment">// if theta == 0, then costheta^2 = 1, then p2(costheta) = 1</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordflow">if</span> (jnet_norm &lt; eps)</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;          costheta = 1;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;          costheta = jnet_dot_norm / (jnet_norm * normal_norm);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="comment">// second order legendre polynomial 1/2*(3*x^2-1)</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> p2costheta = 1. / 2 * (3 * std::pow (costheta, 2) - 1.);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <a class="code" href="classForest_1_1ExtractBV.html#a114e7cbb9584babbbd6758c097d8715f">m_phi2_ass</a>[ass][f][g] =</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        3. / (5. * p2costheta) * (<a class="code" href="classForest_1_1ExtractBV.html#a155f5b3d28bfe916661fb56c0d9fe5cb">m_jp_o_ass</a>[ass][f][g] + m_jp_i_ass[ass][f][g]</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            - <a class="code" href="classForest_1_1ExtractBV.html#a0c5cba2999422814170f891cb707d1a0">m_phi0_ass</a>[ass][f][g] / 2.);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    }</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  }</div><div class="ttc" id="namespaceForest_html_ad32ead9259e9e648897dd5fc7c7a7ebd"><div class="ttname"><a href="namespaceForest.html#ad32ead9259e9e648897dd5fc7c7a7ebd">Forest::p_normal</a></div><div class="ttdeci">Tensor&lt; 1, dim &gt; p_normal(unsigned int f)</div><div class="ttdef"><b>Definition:</b> <a href="forest__utils__dealii_8h_source.html#l00191">forest_utils_dealii.h:191</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_abd57835ed1e2c7414f83078efce7ffbf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">Forest::ExtractBV::mp_state</a></div><div class="ttdeci">const State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference to the state object. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00061">extract_bv.h:61</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af1399ae53002bef64f107a18c1dadde3"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af1399ae53002bef64f107a18c1dadde3">Forest::ExtractBV::m_j_ass</a></div><div class="ttdeci">stdvd3 m_j_ass</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00457">extract_bv.h:457</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af29b71d47daaad7709879135b04f394c"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">Forest::ExtractBV::m_ord</a></div><div class="ttdeci">std::shared_ptr&lt; QuadratureBase&lt; dim &gt; &gt; m_ord</div><div class="ttdoc">Angular quadrature. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00064">extract_bv.h:64</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a7672e0dfe0d102c2b9ec7d776892ad3d"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a7672e0dfe0d102c2b9ec7d776892ad3d">Forest::ExtractBV::m_jnet_ass</a></div><div class="ttdeci">stdvd4 m_jnet_ass</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00448">extract_bv.h:448</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a0c5cba2999422814170f891cb707d1a0"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a0c5cba2999422814170f891cb707d1a0">Forest::ExtractBV::m_phi0_ass</a></div><div class="ttdeci">stdvd3 m_phi0_ass</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00421">extract_bv.h:421</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a35b18eb8254953070491cb4709354451"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">Forest::ExtractBV::stdvd3</a></div><div class="ttdeci">std::vector&lt; stdvd2 &gt; stdvd3</div><div class="ttdoc">recursive shortcut for std::vector&lt;std_vd2&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00309">extract_bv.h:309</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae767775a85397eb408e80f7f746e64ae"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">Forest::ExtractBV::stdvd2</a></div><div class="ttdeci">std::vector&lt; stdvd1 &gt; stdvd2</div><div class="ttdoc">recursive shortcut for std::vector&lt;std_vd1&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00307">extract_bv.h:307</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a187bacdfe10d7de8fd46fab9ed802ace"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a187bacdfe10d7de8fd46fab9ed802ace">Forest::ExtractBV::m_jp_i_ass</a></div><div class="ttdeci">stdvd3 m_jp_i_ass</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00439">extract_bv.h:439</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a114e7cbb9584babbbd6758c097d8715f"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a114e7cbb9584babbbd6758c097d8715f">Forest::ExtractBV::m_phi2_ass</a></div><div class="ttdeci">stdvd3 m_phi2_ass</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00467">extract_bv.h:467</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a23a390ddb4807d3fd585526881b0b877"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">Forest::ExtractBV::m_ass_bv</a></div><div class="ttdeci">stdvd4 m_ass_bv</div><div class="ttdoc">Container for the boundary values for the assembly. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00402">extract_bv.h:402</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a155f5b3d28bfe916661fb56c0d9fe5cb"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a155f5b3d28bfe916661fb56c0d9fe5cb">Forest::ExtractBV::m_jp_o_ass</a></div><div class="ttdeci">stdvd3 m_jp_o_ass</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00430">extract_bv.h:430</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ac1f52b84cf1905c1626d5b0af3d7a688"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">Forest::ExtractBV::stdvd1</a></div><div class="ttdeci">std::vector&lt; double &gt; stdvd1</div><div class="ttdoc">shortcut for std::vector&lt;double&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00305">extract_bv.h:305</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a5973ec1792ae1bbc91ffec9feeab23fd"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">Forest::ExtractBV::m_n_angles</a></div><div class="ttdeci">const unsigned int m_n_angles</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00070">extract_bv.h:70</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a65cb8788beb5a3e749dc749e0d6a5a2a_cgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a65cb8788beb5a3e749dc749e0d6a5a2a_cgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a65cb8788beb5a3e749dc749e0d6a5a2a_cgraph" id="classForest_1_1ExtractBV_a65cb8788beb5a3e749dc749e0d6a5a2a_cgraph">
<area shape="rect" id="node2" href="namespaceForest.html#ad32ead9259e9e648897dd5fc7c7a7ebd" title="Forest::p_normal" alt="" coords="203,13,323,39"/>
</map>
</div>
</p>

<p><div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a65cb8788beb5a3e749dc749e0d6a5a2a_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a65cb8788beb5a3e749dc749e0d6a5a2a_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a65cb8788beb5a3e749dc749e0d6a5a2a_icgraph" id="classForest_1_1ExtractBV_a65cb8788beb5a3e749dc749e0d6a5a2a_icgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf" title="Intialize the members of the class that need it. " alt="" coords="203,5,337,47"/>
<area shape="rect" id="node3" href="classForest_1_1ExtractBV.html#a8279c4e6a40335cebc2c26db7241af60" title="Constructor. " alt="" coords="385,5,520,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0cbd0f00f7dba7e5fd09c5e5e8e99022"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::calculate_moments_pin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00685">685</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00066">Forest::ExtractBV&lt; dim &gt;::initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">// We need some constants</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_groups = <a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_n_groups ();</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_pins = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_pins ();</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> leg_mom = 5;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">// We need some constants for the quadrature</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keyword">const</span> std::vector&lt;double&gt; &amp; w = <a class="code" href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">m_ord</a>-&gt;get_w ();</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;double&gt; &gt; &amp; q = <a class="code" href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">m_ord</a>-&gt;get_q ();</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    MomentIndexer&lt;dim&gt; ind (leg_mom);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_moments = ind.get_number_of_moments ();</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">// Resize the containers and initialize to zero</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a6fc848227ff4977e81bf80067c592bc7">m_pin_bvm</a>.resize (n_pins, <a class="code" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a>(n_moments, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (n_groups,0.))));</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// run over the pins, faces and groups to perform angular coarsening</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pin = 0; pin &lt; n_pins; ++pin)</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> g = 0; g &lt; <a class="code" href="classForest_1_1ExtractBV.html#a58b15e427a438a6b8b95e259d26105ab">m_n_groups</a>; ++g)</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    {</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <span class="comment">// short for the discrete ordinates representation of the flux</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      std::vector&lt;double&gt; &amp; flux_directions = <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>[pin][f][g];</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="comment">// we project the angular flux into the spherical harmonics moments</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m = 0; m &lt; n_moments; ++m)</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        std::vector&lt;int&gt; lm =</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        { ind.get_l (m), ind.get_m (m)};</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">m_n_angles</a>; ++n)</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> y_lm = <a class="code" href="classForest_1_1SphericalHarmonics.html#aa170c9bc04b989b005cb28fa92eb532a">SphericalHarmonics&lt;dim&gt;::Y_lm</a> (lm, q[n]);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a6fc848227ff4977e81bf80067c592bc7">m_pin_bvm</a>[pin][m][f][g] += w[n] * y_lm * flux_directions[n];</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        }</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    }</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_a20d4126d42f8027c6f1e4df21943a8d4"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">Forest::ExtractBV::m_pin_bv</a></div><div class="ttdeci">stdvd4 m_pin_bv</div><div class="ttdoc">Container for the pin faces boundary values. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00355">extract_bv.h:355</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_abd57835ed1e2c7414f83078efce7ffbf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">Forest::ExtractBV::mp_state</a></div><div class="ttdeci">const State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference to the state object. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00061">extract_bv.h:61</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a58b15e427a438a6b8b95e259d26105ab"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a58b15e427a438a6b8b95e259d26105ab">Forest::ExtractBV::m_n_groups</a></div><div class="ttdeci">const unsigned int m_n_groups</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00069">extract_bv.h:69</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af29b71d47daaad7709879135b04f394c"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">Forest::ExtractBV::m_ord</a></div><div class="ttdeci">std::shared_ptr&lt; QuadratureBase&lt; dim &gt; &gt; m_ord</div><div class="ttdoc">Angular quadrature. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00064">extract_bv.h:64</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a6fc848227ff4977e81bf80067c592bc7"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a6fc848227ff4977e81bf80067c592bc7">Forest::ExtractBV::m_pin_bvm</a></div><div class="ttdeci">stdvd4 m_pin_bvm</div><div class="ttdoc">Container for the pin faces boundary values. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00367">extract_bv.h:367</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a35b18eb8254953070491cb4709354451"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">Forest::ExtractBV::stdvd3</a></div><div class="ttdeci">std::vector&lt; stdvd2 &gt; stdvd3</div><div class="ttdoc">recursive shortcut for std::vector&lt;std_vd2&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00309">extract_bv.h:309</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae767775a85397eb408e80f7f746e64ae"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">Forest::ExtractBV::stdvd2</a></div><div class="ttdeci">std::vector&lt; stdvd1 &gt; stdvd2</div><div class="ttdoc">recursive shortcut for std::vector&lt;std_vd1&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00307">extract_bv.h:307</a></div></div>
<div class="ttc" id="classForest_1_1SphericalHarmonics_html_aa170c9bc04b989b005cb28fa92eb532a"><div class="ttname"><a href="classForest_1_1SphericalHarmonics.html#aa170c9bc04b989b005cb28fa92eb532a">Forest::SphericalHarmonics::Y_lm</a></div><div class="ttdeci">static double Y_lm(const std::vector&lt; int &gt; &amp;lm, const std::vector&lt; double &gt; &amp;omega)</div><div class="ttdoc">Calculate  given  and  . </div><div class="ttdef"><b>Definition:</b> <a href="spherical__harmonics_8cc_source.html#l00028">spherical_harmonics.cc:28</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ac1f52b84cf1905c1626d5b0af3d7a688"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">Forest::ExtractBV::stdvd1</a></div><div class="ttdeci">std::vector&lt; double &gt; stdvd1</div><div class="ttdoc">shortcut for std::vector&lt;double&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00305">extract_bv.h:305</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a5973ec1792ae1bbc91ffec9feeab23fd"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">Forest::ExtractBV::m_n_angles</a></div><div class="ttdeci">const unsigned int m_n_angles</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00070">extract_bv.h:70</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a0cbd0f00f7dba7e5fd09c5e5e8e99022_cgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a0cbd0f00f7dba7e5fd09c5e5e8e99022_cgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a0cbd0f00f7dba7e5fd09c5e5e8e99022_cgraph" id="classForest_1_1ExtractBV_a0cbd0f00f7dba7e5fd09c5e5e8e99022_cgraph">
<area shape="rect" id="node2" href="classForest_1_1MomentIndexer.html#a9e95d49b9835e10c3f411a6076130b60" title="Return number of moments. " alt="" coords="215,5,393,47"/>
<area shape="rect" id="node3" href="classForest_1_1MomentIndexer.html#a9d1d2f573d0a986d807ed206a94156a8" title="Returns l value. " alt="" coords="225,71,383,112"/>
<area shape="rect" id="node4" href="classForest_1_1MomentIndexer.html#aec7c97dd4cb24620e8028f057f3a2069" title="Return m value. " alt="" coords="225,136,383,177"/>
<area shape="rect" id="node5" href="classForest_1_1SphericalHarmonics.html#aa170c9bc04b989b005cb28fa92eb532a" title="Calculate &#160;given &#160;and &#160;. " alt="" coords="212,201,396,243"/>
</map>
</div>
</p>

<p><div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a0cbd0f00f7dba7e5fd09c5e5e8e99022_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a0cbd0f00f7dba7e5fd09c5e5e8e99022_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a0cbd0f00f7dba7e5fd09c5e5e8e99022_icgraph" id="classForest_1_1ExtractBV_a0cbd0f00f7dba7e5fd09c5e5e8e99022_icgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf" title="Intialize the members of the class that need it. " alt="" coords="212,5,347,47"/>
<area shape="rect" id="node3" href="classForest_1_1ExtractBV.html#a8279c4e6a40335cebc2c26db7241af60" title="Constructor. " alt="" coords="395,5,529,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae25c13e3567d2af093bae8ac64a2d4bb"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::calculate_moments_ass </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00728">728</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00066">Forest::ExtractBV&lt; dim &gt;::initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  {</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">// We need some constants</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_groups = <a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_n_groups ();</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_ass = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_assemblies ();</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> leg_mom = 5;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="comment">// We need some constants for the quadrature</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="keyword">const</span> std::vector&lt;double&gt; &amp; w = <a class="code" href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">m_ord</a>-&gt;get_w ();</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keyword">const</span> std::vector&lt;std::vector&lt;double&gt; &gt; &amp; q = <a class="code" href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">m_ord</a>-&gt;get_q ();</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    MomentIndexer&lt;dim&gt; ind (leg_mom);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_moments = ind.get_number_of_moments ();</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">// Resize the containers and initialize to zero</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a3ebb32675c1888817632918917e36709">m_ass_bvm</a>.resize (n_ass, <a class="code" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a>(n_moments, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">stdvd1</a> (n_groups,0.))));</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="comment">// run over the pins, faces and groups to perform angular coarsening</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ass = 0; ass &lt; n_ass; ++ass)</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> g = 0; g &lt; <a class="code" href="classForest_1_1ExtractBV.html#a58b15e427a438a6b8b95e259d26105ab">m_n_groups</a>; ++g)</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    {</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <span class="comment">// short for the discrete ordinates representation of the flux</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      std::vector&lt;double&gt; &amp; flux_directions = <a class="code" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a>[ass][f][g];</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="comment">// we project the angular flux into the spherical harmonics moments</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m = 0; m &lt; n_moments; ++m)</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      {</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        std::vector&lt;int&gt; lm =</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        { ind.get_l (m), ind.get_m (m)};</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">m_n_angles</a>; ++n)</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        {</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> y_lm = <a class="code" href="classForest_1_1SphericalHarmonics.html#aa170c9bc04b989b005cb28fa92eb532a">SphericalHarmonics&lt;dim&gt;::Y_lm</a> (lm, q[n]);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a3ebb32675c1888817632918917e36709">m_ass_bvm</a>[ass][m][f][g] += w[n] * y_lm * flux_directions[n];</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      }</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    }</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_abd57835ed1e2c7414f83078efce7ffbf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">Forest::ExtractBV::mp_state</a></div><div class="ttdeci">const State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference to the state object. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00061">extract_bv.h:61</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a58b15e427a438a6b8b95e259d26105ab"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a58b15e427a438a6b8b95e259d26105ab">Forest::ExtractBV::m_n_groups</a></div><div class="ttdeci">const unsigned int m_n_groups</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00069">extract_bv.h:69</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af29b71d47daaad7709879135b04f394c"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">Forest::ExtractBV::m_ord</a></div><div class="ttdeci">std::shared_ptr&lt; QuadratureBase&lt; dim &gt; &gt; m_ord</div><div class="ttdoc">Angular quadrature. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00064">extract_bv.h:64</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a3ebb32675c1888817632918917e36709"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a3ebb32675c1888817632918917e36709">Forest::ExtractBV::m_ass_bvm</a></div><div class="ttdeci">stdvd4 m_ass_bvm</div><div class="ttdoc">Container for the boundary values for the assembly. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00411">extract_bv.h:411</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a35b18eb8254953070491cb4709354451"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">Forest::ExtractBV::stdvd3</a></div><div class="ttdeci">std::vector&lt; stdvd2 &gt; stdvd3</div><div class="ttdoc">recursive shortcut for std::vector&lt;std_vd2&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00309">extract_bv.h:309</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae767775a85397eb408e80f7f746e64ae"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">Forest::ExtractBV::stdvd2</a></div><div class="ttdeci">std::vector&lt; stdvd1 &gt; stdvd2</div><div class="ttdoc">recursive shortcut for std::vector&lt;std_vd1&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00307">extract_bv.h:307</a></div></div>
<div class="ttc" id="classForest_1_1SphericalHarmonics_html_aa170c9bc04b989b005cb28fa92eb532a"><div class="ttname"><a href="classForest_1_1SphericalHarmonics.html#aa170c9bc04b989b005cb28fa92eb532a">Forest::SphericalHarmonics::Y_lm</a></div><div class="ttdeci">static double Y_lm(const std::vector&lt; int &gt; &amp;lm, const std::vector&lt; double &gt; &amp;omega)</div><div class="ttdoc">Calculate  given  and  . </div><div class="ttdef"><b>Definition:</b> <a href="spherical__harmonics_8cc_source.html#l00028">spherical_harmonics.cc:28</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a23a390ddb4807d3fd585526881b0b877"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">Forest::ExtractBV::m_ass_bv</a></div><div class="ttdeci">stdvd4 m_ass_bv</div><div class="ttdoc">Container for the boundary values for the assembly. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00402">extract_bv.h:402</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ac1f52b84cf1905c1626d5b0af3d7a688"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ac1f52b84cf1905c1626d5b0af3d7a688">Forest::ExtractBV::stdvd1</a></div><div class="ttdeci">std::vector&lt; double &gt; stdvd1</div><div class="ttdoc">shortcut for std::vector&lt;double&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00305">extract_bv.h:305</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a5973ec1792ae1bbc91ffec9feeab23fd"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">Forest::ExtractBV::m_n_angles</a></div><div class="ttdeci">const unsigned int m_n_angles</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00070">extract_bv.h:70</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_ae25c13e3567d2af093bae8ac64a2d4bb_cgraph.png" border="0" usemap="#classForest_1_1ExtractBV_ae25c13e3567d2af093bae8ac64a2d4bb_cgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_ae25c13e3567d2af093bae8ac64a2d4bb_cgraph" id="classForest_1_1ExtractBV_ae25c13e3567d2af093bae8ac64a2d4bb_cgraph">
<area shape="rect" id="node2" href="classForest_1_1MomentIndexer.html#a9e95d49b9835e10c3f411a6076130b60" title="Return number of moments. " alt="" coords="219,5,397,47"/>
<area shape="rect" id="node3" href="classForest_1_1MomentIndexer.html#a9d1d2f573d0a986d807ed206a94156a8" title="Returns l value. " alt="" coords="229,71,387,112"/>
<area shape="rect" id="node4" href="classForest_1_1MomentIndexer.html#aec7c97dd4cb24620e8028f057f3a2069" title="Return m value. " alt="" coords="229,136,387,177"/>
<area shape="rect" id="node5" href="classForest_1_1SphericalHarmonics.html#aa170c9bc04b989b005cb28fa92eb532a" title="Calculate &#160;given &#160;and &#160;. " alt="" coords="216,201,400,243"/>
</map>
</div>
</p>

<p><div id="dynsection-22" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_ae25c13e3567d2af093bae8ac64a2d4bb_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_ae25c13e3567d2af093bae8ac64a2d4bb_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_ae25c13e3567d2af093bae8ac64a2d4bb_icgraph" id="classForest_1_1ExtractBV_ae25c13e3567d2af093bae8ac64a2d4bb_icgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a250c6d8962e9b7d646ccd424cfb4edcf" title="Intialize the members of the class that need it. " alt="" coords="216,5,351,47"/>
<area shape="rect" id="node3" href="classForest_1_1ExtractBV.html#a8279c4e6a40335cebc2c26db7241af60" title="Constructor. " alt="" coords="399,5,533,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a45a7a28e1ec1b6fb4ce1dc265d887b7c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::coarsening_angular </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate the coarser angular representation for the bv. </p>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00892">892</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  {</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">// We talk</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">m_verbose</a>)</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    deallog &lt;&lt; <span class="stringliteral">&quot; coarsening_angular not implemented&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">    // We need some constants</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">    const unsigned int n_pins = mp_geom.get_n_pins ();</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">    const unsigned int n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">    // variables for the angular coarsening</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">    std::string q_type = (dim == 1 ? &quot;GaussLegendre&quot; : &quot;LevelSymType2&quot;);</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">    QuadraturePtr&lt;dim&gt; sn_coarse = QuadratureFactory&lt;dim&gt;::build (m_bcs_order,</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">        q_type);</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">    std::vector&lt;std::vector&lt;double&gt; &gt; q = sn_coarse-&gt;get_q ();</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment">    for (unsigned int n = 0; n &lt; m_n_angles; ++n)</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">    q[n][2] = std::sqrt (1 - (q[n][0] * q[n][0] + q[n][1] * q[n][1]));</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">    std::vector&lt;double&gt; w = sn_coarse-&gt;get_w ();</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">    // How many coarsenings in angle?</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">    const unsigned int ca = mp_state.mp_data.mp_settings.get_coarse_angular ();</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">    Assert(ca &lt;= sn_coarse-&gt;get_n_leg_moments (),</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">        ExcMessage(&quot;Coarsening larger that n_leg_moments provided.&quot;));</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">    // If the coarsening is different from zero, then we project the angular</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">    // distribution into a spherical harmonics bases of smaller order, and then</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">    // we project back into the discrete ordinates representation</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">    if (ca != 0)</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">    {</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">      // Moment indexer to run over the spherical harmonics moments</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">      const unsigned int n_leg_mom_coarse = sn_coarse-&gt;get_n_leg_moments ()</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">      - ca;</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">      MomentIndexer&lt;dim&gt; ind (n_leg_mom_coarse);</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">      const unsigned int n_moments = ind.get_number_of_moments ();</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">      // run over the pins, faces and groups to perform angular coarsening</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">      for (unsigned int pin = 0; pin &lt; n_pins; ++pin)</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">      for (unsigned int f = 0; f &lt; n_faces; ++f)</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">      for (unsigned int g = 0; g &lt; m_n_groups; ++g)</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">      {</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">        // short for the discrete ordinates representation of the flux</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">        std::vector&lt;double&gt; &amp; flux_directions = m_pin_bv[pin][f][g];</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">        // temporal storage for the angular flux</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">        std::vector&lt;double&gt; flux_moments (n_moments, 0.);</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">        // we project the angular flux into the spherical harmonics moments</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">        for (unsigned int m = 0; m &lt; n_moments; ++m)</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">        {</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">          std::vector&lt;int&gt; lm =</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">          { ind.get_l (m), ind.get_m (m)};</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">          for (unsigned int n = 0; n &lt; m_n_angles; ++n)</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">          {</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">            const double y_lm = SphericalHarmonics&lt;dim&gt;::Y_lm (lm, q[n]);</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">            flux_moments[m] += w[n] * y_lm * flux_directions[n];</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">          }</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">        }</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">        // clean old values for the angular flux</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">        for (unsigned int n = 0; n &lt; m_n_angles; ++n)</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">        flux_directions[n] = 0.;</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">        // project back to the discrete ordinates representation</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">        for (unsigned int m = 0; m &lt; n_moments; ++m)</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">        {</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">          const std::vector&lt;int&gt; lm =</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">          { ind.get_l (m), ind.get_m (m)};</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">          const double scal = (2 * ind.get_l (m) + 1);</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">          for (unsigned int n = 0; n &lt; m_n_angles; ++n)</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">          {</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">            const double y_lm = SphericalHarmonics&lt;dim&gt;::Y_lm (lm, q[n]);</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">            for (unsigned int pin = 0; pin &lt; n_pins; ++pin)</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">            flux_directions[n] += y_lm * scal * flux_moments[m];</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">          }</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">        }</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">      }</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_af6ab5e3132ab03a469ccca76952378a3"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">Forest::ExtractBV::m_verbose</a></div><div class="ttdeci">bool m_verbose</div><div class="ttdoc">Indicating the level of verbose: 0 = none; 1 = everything. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00058">extract_bv.h:58</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9ab04dca6066e72aa131aec8174b403d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::coarsening_spatial </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate the coarser spatial representation for the bv. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000103">Todo:</a></b></dt><dd>Automate the coarsening level and make it generic </dd></dl>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00869">869</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  {</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="comment">// We talk</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">m_verbose</a>)</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot; coarsening_spatial &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">// We use some constants</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_pins = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_pins ();</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="comment">// run over the pins, faces and groups to perform angular coarsening</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pin = 0; pin &lt; n_pins; ++pin)</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    {</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ass = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_pin2assembly (pin);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> g = 0; g &lt; <a class="code" href="classForest_1_1ExtractBV.html#a58b15e427a438a6b8b95e259d26105ab">m_n_groups</a>; ++g)</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">m_n_angles</a>; ++n)</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <a class="code" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a>[ass][f][g][n] += <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>[pin][f][g][n];</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    }</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_a20d4126d42f8027c6f1e4df21943a8d4"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">Forest::ExtractBV::m_pin_bv</a></div><div class="ttdeci">stdvd4 m_pin_bv</div><div class="ttdoc">Container for the pin faces boundary values. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00355">extract_bv.h:355</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a58b15e427a438a6b8b95e259d26105ab"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a58b15e427a438a6b8b95e259d26105ab">Forest::ExtractBV::m_n_groups</a></div><div class="ttdeci">const unsigned int m_n_groups</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00069">extract_bv.h:69</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af6ab5e3132ab03a469ccca76952378a3"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">Forest::ExtractBV::m_verbose</a></div><div class="ttdeci">bool m_verbose</div><div class="ttdoc">Indicating the level of verbose: 0 = none; 1 = everything. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00058">extract_bv.h:58</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a23a390ddb4807d3fd585526881b0b877"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">Forest::ExtractBV::m_ass_bv</a></div><div class="ttdeci">stdvd4 m_ass_bv</div><div class="ttdoc">Container for the boundary values for the assembly. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00402">extract_bv.h:402</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a5973ec1792ae1bbc91ffec9feeab23fd"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a5973ec1792ae1bbc91ffec9feeab23fd">Forest::ExtractBV::m_n_angles</a></div><div class="ttdeci">const unsigned int m_n_angles</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00070">extract_bv.h:70</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8edb62daa0379fd038a69dad14fad114"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::read_ass_bv </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read the bv from a file. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000104">Todo:</a></b></dt><dd>Change BOOST_FOREACH for new ranged-based for? ptree d = pt.get_child("boundary_conditions"); //for (const auto &amp;face : d) for (const std::pair&lt;std::string, ptree&gt; &amp;face : d) { if (face.first != "face") continue; } </dd></dl>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00815">815</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  {</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="comment">// We talk</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">m_verbose</a>)</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot; read_bv &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="comment">// We use some constants</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_ass = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_assemblies ();</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_pins = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_pins ();</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keyword">const</span> std::string f_bcs (<a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.mp_data.mp_settings.get_file_bcs ());</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="comment">// We resize the containers</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a>.resize (n_ass, <a class="code" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (<a class="code" href="classForest_1_1ExtractBV.html#a58b15e427a438a6b8b95e259d26105ab">m_n_groups</a>)));</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>.resize (n_pins, <a class="code" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> (n_faces, <a class="code" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> (<a class="code" href="classForest_1_1ExtractBV.html#a58b15e427a438a6b8b95e259d26105ab">m_n_groups</a>)));</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="comment">// We verify that it is only one assembly</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    Assert(n_ass == 1, ExcMessage(<span class="stringliteral">&quot;More than one assembly provided.&quot;</span>));</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">// Create empty property tree object</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keyword">using</span> boost::property_tree::ptree;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    ptree pt;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="comment">// Load XML file and put its contents in property tree.</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    read_xml (f_bcs, pt, boost::property_tree::xml_parser::trim_whitespace);</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    std::string bin;<span class="comment">// bin is a container to save temporal data</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    std::string indent (<span class="stringliteral">&quot;\t&quot;</span>);</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <a class="code" href="classForest_1_1ExtractBV.html#a92b060da2496bd32ec17d4796c7f9190">m_bcs_order</a>[0] = pt.get&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&gt; (</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="stringliteral">&quot;boundary_conditions.&lt;xmlattr&gt;.SN_order&quot;</span>);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="comment">// assemblies</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> std::pair&lt;std::string, ptree&gt; &amp; face : pt.get_child(<span class="stringliteral">&quot;boundary_conditions&quot;</span>))</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="keywordflow">if</span> (face.first == <span class="stringliteral">&quot;face&quot;</span>)</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      {</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> std::pair&lt;std::string, ptree&gt; &amp; group : face.second.get_child(<span class="stringliteral">&quot;&quot;</span>))</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        {</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;          <span class="keywordflow">if</span> (group.first == <span class="stringliteral">&quot;group&quot;</span>)</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;          {</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = face.second.get&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&gt; (<span class="stringliteral">&quot;&lt;xmlattr&gt;.id&quot;</span>);</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> g = group.second.get&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&gt; (<span class="stringliteral">&quot;&lt;xmlattr&gt;.id&quot;</span>);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            bin = group.second.get&lt;std::string&gt; (<span class="stringliteral">&quot;ANGxPOS&quot;</span>);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            <a class="code" href="namespaceForest.html#aaf59771c22c8737b7f9e84c9c0c96b08">Forest::string_to_vector</a> (bin, <a class="code" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a>[0][f][g]);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            bin.clear ();</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;          }</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        }</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      }</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    }</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_a92b060da2496bd32ec17d4796c7f9190"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a92b060da2496bd32ec17d4796c7f9190">Forest::ExtractBV::m_bcs_order</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; m_bcs_order</div><div class="ttdoc">Contains the spherical harmonics order for the bcs. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00472">extract_bv.h:472</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a20d4126d42f8027c6f1e4df21943a8d4"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">Forest::ExtractBV::m_pin_bv</a></div><div class="ttdeci">stdvd4 m_pin_bv</div><div class="ttdoc">Container for the pin faces boundary values. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00355">extract_bv.h:355</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_abd57835ed1e2c7414f83078efce7ffbf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">Forest::ExtractBV::mp_state</a></div><div class="ttdeci">const State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference to the state object. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00061">extract_bv.h:61</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a58b15e427a438a6b8b95e259d26105ab"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a58b15e427a438a6b8b95e259d26105ab">Forest::ExtractBV::m_n_groups</a></div><div class="ttdeci">const unsigned int m_n_groups</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00069">extract_bv.h:69</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af6ab5e3132ab03a469ccca76952378a3"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af6ab5e3132ab03a469ccca76952378a3">Forest::ExtractBV::m_verbose</a></div><div class="ttdeci">bool m_verbose</div><div class="ttdoc">Indicating the level of verbose: 0 = none; 1 = everything. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00058">extract_bv.h:58</a></div></div>
<div class="ttc" id="namespaceForest_html_aaf59771c22c8737b7f9e84c9c0c96b08"><div class="ttname"><a href="namespaceForest.html#aaf59771c22c8737b7f9e84c9c0c96b08">Forest::string_to_vector</a></div><div class="ttdeci">void string_to_vector(const std::string &amp;in, std::vector&lt; Number &gt; &amp;out)</div><div class="ttdef"><b>Definition:</b> <a href="forest__utils__base_8h_source.html#l00251">forest_utils_base.h:251</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a35b18eb8254953070491cb4709354451"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">Forest::ExtractBV::stdvd3</a></div><div class="ttdeci">std::vector&lt; stdvd2 &gt; stdvd3</div><div class="ttdoc">recursive shortcut for std::vector&lt;std_vd2&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00309">extract_bv.h:309</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae767775a85397eb408e80f7f746e64ae"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">Forest::ExtractBV::stdvd2</a></div><div class="ttdeci">std::vector&lt; stdvd1 &gt; stdvd2</div><div class="ttdoc">recursive shortcut for std::vector&lt;std_vd1&gt; </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00307">extract_bv.h:307</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a23a390ddb4807d3fd585526881b0b877"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">Forest::ExtractBV::m_ass_bv</a></div><div class="ttdeci">stdvd4 m_ass_bv</div><div class="ttdoc">Container for the boundary values for the assembly. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00402">extract_bv.h:402</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-23" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a8edb62daa0379fd038a69dad14fad114_cgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a8edb62daa0379fd038a69dad14fad114_cgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a8edb62daa0379fd038a69dad14fad114_cgraph" id="classForest_1_1ExtractBV_a8edb62daa0379fd038a69dad14fad114_cgraph">
<area shape="rect" id="node2" href="namespaceForest.html#aaf59771c22c8737b7f9e84c9c0c96b08" title="Forest::string_to_vector" alt="" coords="188,13,348,39"/>
<area shape="rect" id="node3" href="namespaceForest.html#abb918982a606146cffa9875e88994c50" title="Split string into tokens. " alt="" coords="396,13,487,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad95181783224f491043d97f5abcc5faa"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::print_ass_bv </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename_prefix</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>print the bv to a file. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000105">Todo:</a></b></dt><dd>Change BOOST_FOREACH for new ranged-based for? ptree d = pt.get_child("boundary_conditions"); //for (const auto &amp;face : d) for (const std::pair&lt;std::string, ptree&gt; &amp;face : d) { if (face.first != "face") continue; } </dd></dl>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00771">771</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  {</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">// We use some constants</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_ass = <a class="code" href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">mp_geom</a>.get_n_assemblies ();</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_faces = GeometryInfo&lt;dim&gt;::faces_per_cell;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ass = 0; ass &lt; n_ass; ++ass)</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    {</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="comment">// Create empty property tree object</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      <span class="keyword">using</span> boost::property_tree::ptree;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      ptree pt;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      std::string bin;<span class="comment">// bin is a container to save temporal data</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      std::string indent (<span class="stringliteral">&quot;\t&quot;</span>);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      pt.add (<span class="stringliteral">&quot;boundary_conditions&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      pt.put (<span class="stringliteral">&quot;boundary_conditions.&lt;xmlattr&gt;.SN_order&quot;</span>, <a class="code" href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">m_ord</a>-&gt;get_order ());</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      pt.add (<span class="stringliteral">&quot;boundary_conditions.keff&quot;</span>, <a class="code" href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">mp_state</a>.get_keff ());</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; n_faces; ++f)</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      {</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        ptree &amp; node_face = pt.add (<span class="stringliteral">&quot;boundary_conditions.face&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        node_face.put (<span class="stringliteral">&quot;&lt;xmlattr&gt;.id&quot;</span>, f);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> g = 0; g &lt; <a class="code" href="classForest_1_1ExtractBV.html#a58b15e427a438a6b8b95e259d26105ab">m_n_groups</a>; ++g)</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;          ptree &amp; node_g = node_face.add (<span class="stringliteral">&quot;group&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;          node_g.put (<span class="stringliteral">&quot;&lt;xmlattr&gt;.id&quot;</span>, g);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;          <a class="code" href="namespaceForest.html#aecc943afe0aaf2e1b00c5109034cde22">vector_to_string</a> (<a class="code" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a>[ass][f][g], bin, indent, 4);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;          node_g.add (<span class="stringliteral">&quot;ANGxPOS&quot;</span>, bin);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;          bin.clear ();</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        }</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      }</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="comment">// Write property tree to XML file (\t is a tabulator)</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="preprocessor">#if BOOST_VERSION &lt; 105500</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      boost::property_tree::xml_writer_settings&lt;char&gt; settings (<span class="charliteral">&#39; &#39;</span>, 2);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      boost::property_tree::xml_writer_settings&lt;std::string&gt; settings (<span class="charliteral">&#39; &#39;</span>, 2);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      std::string filename = filename_prefix + std::string (<span class="stringliteral">&quot;_bc_ass_&quot;</span>)</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      + <a class="code" href="namespaceForest.html#a28a8f2a5f73ce0dc2b1c1d95d0d0f905">num_to_string</a> (ass) + std::string (<span class="stringliteral">&quot;.xml&quot;</span>);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;priting to &lt;&quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot;&gt; ...&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      write_xml (filename, pt, std::locale (), settings);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  }</div><div class="ttc" id="namespaceForest_html_a28a8f2a5f73ce0dc2b1c1d95d0d0f905"><div class="ttname"><a href="namespaceForest.html#a28a8f2a5f73ce0dc2b1c1d95d0d0f905">Forest::num_to_string</a></div><div class="ttdeci">std::string num_to_string(Number val)</div><div class="ttdoc">Convert a number of different types to a string. </div><div class="ttdef"><b>Definition:</b> <a href="forest__utils__base_8h_source.html#l00235">forest_utils_base.h:235</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_abd57835ed1e2c7414f83078efce7ffbf"><div class="ttname"><a href="classForest_1_1ExtractBV.html#abd57835ed1e2c7414f83078efce7ffbf">Forest::ExtractBV::mp_state</a></div><div class="ttdeci">const State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference to the state object. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00061">extract_bv.h:61</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a58b15e427a438a6b8b95e259d26105ab"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a58b15e427a438a6b8b95e259d26105ab">Forest::ExtractBV::m_n_groups</a></div><div class="ttdeci">const unsigned int m_n_groups</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00069">extract_bv.h:69</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af29b71d47daaad7709879135b04f394c"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af29b71d47daaad7709879135b04f394c">Forest::ExtractBV::m_ord</a></div><div class="ttdeci">std::shared_ptr&lt; QuadratureBase&lt; dim &gt; &gt; m_ord</div><div class="ttdoc">Angular quadrature. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00064">extract_bv.h:64</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae8bbac2fc100dde23aade6c1a492c96e"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae8bbac2fc100dde23aade6c1a492c96e">Forest::ExtractBV::mp_geom</a></div><div class="ttdeci">const ProbGeom&lt; dim &gt; &amp; mp_geom</div><div class="ttdoc">Geometry. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00067">extract_bv.h:67</a></div></div>
<div class="ttc" id="namespaceForest_html_aecc943afe0aaf2e1b00c5109034cde22"><div class="ttname"><a href="namespaceForest.html#aecc943afe0aaf2e1b00c5109034cde22">Forest::vector_to_string</a></div><div class="ttdeci">void vector_to_string(const std::vector&lt; Number &gt; &amp;in, std::string &amp;out, const std::string &amp;indent=std::string(&quot;&quot;), const unsigned int n_indent=0, const unsigned int precision=7)</div><div class="ttdef"><b>Definition:</b> <a href="forest__utils__base_8h_source.html#l00289">forest_utils_base.h:289</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a23a390ddb4807d3fd585526881b0b877"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">Forest::ExtractBV::m_ass_bv</a></div><div class="ttdeci">stdvd4 m_ass_bv</div><div class="ttdoc">Container for the boundary values for the assembly. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00402">extract_bv.h:402</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-24" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_ad95181783224f491043d97f5abcc5faa_cgraph.png" border="0" usemap="#classForest_1_1ExtractBV_ad95181783224f491043d97f5abcc5faa_cgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_ad95181783224f491043d97f5abcc5faa_cgraph" id="classForest_1_1ExtractBV_ad95181783224f491043d97f5abcc5faa_cgraph">
<area shape="rect" id="node2" href="namespaceForest.html#aecc943afe0aaf2e1b00c5109034cde22" title="Forest::vector_to_string" alt="" coords="188,5,348,32"/>
<area shape="rect" id="node3" href="namespaceForest.html#a28a8f2a5f73ce0dc2b1c1d95d0d0f905" title="Convert a number of different types to a string. " alt="" coords="193,56,343,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6d3df1dd673f4d18a508ef478e626ef6"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::scaling </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>scaling</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scale the interface values with a given scaling factor. </p>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l00974">974</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="neutronicmodule_8cc_source.html#l00027">Forest::NeutronicModule&lt; dim &gt;::run()</a>, and <a class="el" href="extract__bv_8cc_source.html#l01022">Forest::ExtractBV&lt; dim &gt;::scaling_moments()</a>.</p>
<div class="fragment"><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  {</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="comment">// Some information about the dimensions. The same for pin and ass.</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">// double boundary_value = m_pin_bv[pin][f][group_g][angle];</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="comment">// double bv = m_jnet[pin][f][group_g][dim];</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="comment">// double bv = m_phi0[pin][f][group_g];</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="comment">// double bv = m_jp_o[pin][f][group_g];</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="comment">// double bv = m_jp_i[pin][f][group_g];</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="comment">// double bv = m_j[pin][f][group_g];</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="comment">// double bv = m_phi2[pin][f][group_g];</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">// Scaling the pin data</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>.size(); ++p)</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>[p].size(); ++f)</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> g = 0; g &lt; <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>[p][f].size(); ++g)</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>[p][f][g].size(); ++n)</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>[p][f][g][n] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; dim; ++d)</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <a class="code" href="classForest_1_1ExtractBV.html#aa9c71737f27c0d7a213b8ba05642ef51">m_jnet_pin</a>[p][f][g][d] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#ab2ec657fef942c86ce29a07178435e6f">m_phi0_pin</a>[p][f][g] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#aa4f9100e9dce4a8c4275abdeebd15487">m_jp_o_pin</a>[p][f][g] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#ae3a86c811e9da115d39ce36d972e9a9a">m_jp_i_pin</a>[p][f][g] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a15d1cfa4b83507500b2ab17e7f98750d">m_j_pin</a>[p][f][g] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a0db15dad2fdc0027f77e122c2503d328">m_phi2_pin</a>[p][f][g] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        }</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="comment">// Scaling the assembly data</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> a = 0; a &lt; <a class="code" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a>.size(); ++a)</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; <a class="code" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a>[a].size(); ++f)</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> g = 0; g &lt; <a class="code" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a>[a][f].size(); ++g)</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        {</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a>[a][f][g].size(); ++n)</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            <a class="code" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a>[a][f][g][n] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; dim; ++d)</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            <a class="code" href="classForest_1_1ExtractBV.html#a7672e0dfe0d102c2b9ec7d776892ad3d">m_jnet_ass</a>[a][f][g][d] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a0c5cba2999422814170f891cb707d1a0">m_phi0_ass</a>[a][f][g] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a155f5b3d28bfe916661fb56c0d9fe5cb">m_jp_o_ass</a>[a][f][g] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a187bacdfe10d7de8fd46fab9ed802ace">m_jp_i_ass</a>[a][f][g] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#af1399ae53002bef64f107a18c1dadde3">m_j_ass</a>[a][f][g] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;          <a class="code" href="classForest_1_1ExtractBV.html#a114e7cbb9584babbbd6758c097d8715f">m_phi2_ass</a>[a][f][g] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        }</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_a20d4126d42f8027c6f1e4df21943a8d4"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">Forest::ExtractBV::m_pin_bv</a></div><div class="ttdeci">stdvd4 m_pin_bv</div><div class="ttdoc">Container for the pin faces boundary values. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00355">extract_bv.h:355</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a0db15dad2fdc0027f77e122c2503d328"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a0db15dad2fdc0027f77e122c2503d328">Forest::ExtractBV::m_phi2_pin</a></div><div class="ttdeci">stdvd3 m_phi2_pin</div><div class="ttdoc">Container for the boundary values for the second moment flux. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00466">extract_bv.h:466</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ae3a86c811e9da115d39ce36d972e9a9a"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ae3a86c811e9da115d39ce36d972e9a9a">Forest::ExtractBV::m_jp_i_pin</a></div><div class="ttdeci">stdvd3 m_jp_i_pin</div><div class="ttdoc">Container for the values for the incoming partial current. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00438">extract_bv.h:438</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_af1399ae53002bef64f107a18c1dadde3"><div class="ttname"><a href="classForest_1_1ExtractBV.html#af1399ae53002bef64f107a18c1dadde3">Forest::ExtractBV::m_j_ass</a></div><div class="ttdeci">stdvd3 m_j_ass</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00457">extract_bv.h:457</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a7672e0dfe0d102c2b9ec7d776892ad3d"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a7672e0dfe0d102c2b9ec7d776892ad3d">Forest::ExtractBV::m_jnet_ass</a></div><div class="ttdeci">stdvd4 m_jnet_ass</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00448">extract_bv.h:448</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a0c5cba2999422814170f891cb707d1a0"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a0c5cba2999422814170f891cb707d1a0">Forest::ExtractBV::m_phi0_ass</a></div><div class="ttdeci">stdvd3 m_phi0_ass</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00421">extract_bv.h:421</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a6d3df1dd673f4d18a508ef478e626ef6"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">Forest::ExtractBV::scaling</a></div><div class="ttdeci">void scaling(const double scaling)</div><div class="ttdoc">Scale the interface values with a given scaling factor. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00974">extract_bv.cc:974</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a187bacdfe10d7de8fd46fab9ed802ace"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a187bacdfe10d7de8fd46fab9ed802ace">Forest::ExtractBV::m_jp_i_ass</a></div><div class="ttdeci">stdvd3 m_jp_i_ass</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00439">extract_bv.h:439</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a114e7cbb9584babbbd6758c097d8715f"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a114e7cbb9584babbbd6758c097d8715f">Forest::ExtractBV::m_phi2_ass</a></div><div class="ttdeci">stdvd3 m_phi2_ass</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00467">extract_bv.h:467</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a23a390ddb4807d3fd585526881b0b877"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">Forest::ExtractBV::m_ass_bv</a></div><div class="ttdeci">stdvd4 m_ass_bv</div><div class="ttdoc">Container for the boundary values for the assembly. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00402">extract_bv.h:402</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a155f5b3d28bfe916661fb56c0d9fe5cb"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a155f5b3d28bfe916661fb56c0d9fe5cb">Forest::ExtractBV::m_jp_o_ass</a></div><div class="ttdeci">stdvd3 m_jp_o_ass</div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00430">extract_bv.h:430</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a15d1cfa4b83507500b2ab17e7f98750d"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a15d1cfa4b83507500b2ab17e7f98750d">Forest::ExtractBV::m_j_pin</a></div><div class="ttdeci">stdvd3 m_j_pin</div><div class="ttdoc">Container for the boundary values for the net current. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00456">extract_bv.h:456</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_ab2ec657fef942c86ce29a07178435e6f"><div class="ttname"><a href="classForest_1_1ExtractBV.html#ab2ec657fef942c86ce29a07178435e6f">Forest::ExtractBV::m_phi0_pin</a></div><div class="ttdeci">stdvd3 m_phi0_pin</div><div class="ttdoc">Container for the boundary values for the flux. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00420">extract_bv.h:420</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_aa4f9100e9dce4a8c4275abdeebd15487"><div class="ttname"><a href="classForest_1_1ExtractBV.html#aa4f9100e9dce4a8c4275abdeebd15487">Forest::ExtractBV::m_jp_o_pin</a></div><div class="ttdeci">stdvd3 m_jp_o_pin</div><div class="ttdoc">Container for the values for the outgoing partial current. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00429">extract_bv.h:429</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_aa9c71737f27c0d7a213b8ba05642ef51"><div class="ttname"><a href="classForest_1_1ExtractBV.html#aa9c71737f27c0d7a213b8ba05642ef51">Forest::ExtractBV::m_jnet_pin</a></div><div class="ttdeci">stdvd4 m_jnet_pin</div><div class="ttdoc">Container for the boundary values for the net current. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00447">extract_bv.h:447</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-25" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a6d3df1dd673f4d18a508ef478e626ef6_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a6d3df1dd673f4d18a508ef478e626ef6_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a6d3df1dd673f4d18a508ef478e626ef6_icgraph" id="classForest_1_1ExtractBV_a6d3df1dd673f4d18a508ef478e626ef6_icgraph">
<area shape="rect" id="node2" href="classForest_1_1NeutronicModule.html#a4d61476d9efb27527244dd286f93d574" title="Forest::NeutronicModule::run" alt="" coords="371,42,561,69"/>
<area shape="rect" id="node5" href="classForest_1_1ExtractBV.html#a6125e651ca0f77edc13d675d9f55e26e" title="Scale the interface values with a given scaling factor. " alt="" coords="188,64,323,105"/>
<area shape="rect" id="node3" href="classForest_1_1NeutronicModule.html#adf722f675d9b68dd3591196dab7fde20" title="Forest::NeutronicModule\l::NeutronicModule" alt="" coords="609,5,775,47"/>
<area shape="rect" id="node4" href="main_8cc.html#a12426dd6493a4baf708c016a4d10be43" title="Example main program. " alt="" coords="658,71,726,98"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6125e651ca0f77edc13d675d9f55e26e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::scaling_moments </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>scaling</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scale the interface values with a given scaling factor. </p>

<p>Definition at line <a class="el" href="extract__bv_8cc_source.html#l01022">1022</a> of file <a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a>.</p>

<p>Referenced by <a class="el" href="neutronicmodule_8cc_source.html#l00027">Forest::NeutronicModule&lt; dim &gt;::run()</a>.</p>
<div class="fragment"><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  {</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="comment">// Some information about the dimensions. The same for pin and ass.</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="comment">// double boundary_value = m_pin_bv[pin][f][group_g][angle];</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">// double bv = m_pin_bvm[pin][n_moments][f][group_g];</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="comment">// double bv = m_ass_bvm[ass][n_moments][f][group_g];</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="comment">// Scaling the pin data</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classForest_1_1ExtractBV.html#a6fc848227ff4977e81bf80067c592bc7">m_pin_bvm</a>.size(); ++p)</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="classForest_1_1ExtractBV.html#a6fc848227ff4977e81bf80067c592bc7">m_pin_bvm</a>[p].size(); ++m)</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; <a class="code" href="classForest_1_1ExtractBV.html#a6fc848227ff4977e81bf80067c592bc7">m_pin_bvm</a>[p][m].size(); ++f)</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> g = 0; g &lt; <a class="code" href="classForest_1_1ExtractBV.html#a6fc848227ff4977e81bf80067c592bc7">m_pin_bvm</a>[p][m][f].size(); ++g)</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;          {</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            <span class="comment">//deallog &lt;&lt; &quot;p,m,f,g = &quot; &lt;&lt; p &lt;&lt; &quot; &quot; &lt;&lt; m &lt;&lt; &quot; &quot; &lt;&lt; f &lt;&lt; &quot; &quot; &lt;&lt; g &lt;&lt; std::endl;</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;            <a class="code" href="classForest_1_1ExtractBV.html#a6fc848227ff4977e81bf80067c592bc7">m_pin_bvm</a>[p][m][f][g] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;          }</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="comment">// Scaling the assembly data</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> a = 0; a &lt; <a class="code" href="classForest_1_1ExtractBV.html#a3ebb32675c1888817632918917e36709">m_ass_bvm</a>.size(); ++a)</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="classForest_1_1ExtractBV.html#a3ebb32675c1888817632918917e36709">m_ass_bvm</a>[a].size(); ++m)</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> f = 0; f &lt; <a class="code" href="classForest_1_1ExtractBV.html#a3ebb32675c1888817632918917e36709">m_ass_bvm</a>[a][m].size(); ++f)</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> g = 0; g &lt; <a class="code" href="classForest_1_1ExtractBV.html#a3ebb32675c1888817632918917e36709">m_ass_bvm</a>[a][m][f].size(); ++g)</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;          {</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            <span class="comment">//deallog &lt;&lt; &quot;a,m,f,g = &quot; &lt;&lt; a &lt;&lt; &quot; &quot; &lt;&lt; m &lt;&lt; &quot; &quot; &lt;&lt; f &lt;&lt; &quot; &quot; &lt;&lt; g &lt;&lt; std::endl;</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            <a class="code" href="classForest_1_1ExtractBV.html#a3ebb32675c1888817632918917e36709">m_ass_bvm</a>[a][m][f][g] *= <a class="code" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">scaling</a>;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;          }</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  }</div><div class="ttc" id="classForest_1_1ExtractBV_html_a6fc848227ff4977e81bf80067c592bc7"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a6fc848227ff4977e81bf80067c592bc7">Forest::ExtractBV::m_pin_bvm</a></div><div class="ttdeci">stdvd4 m_pin_bvm</div><div class="ttdoc">Container for the pin faces boundary values. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00367">extract_bv.h:367</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a3ebb32675c1888817632918917e36709"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a3ebb32675c1888817632918917e36709">Forest::ExtractBV::m_ass_bvm</a></div><div class="ttdeci">stdvd4 m_ass_bvm</div><div class="ttdoc">Container for the boundary values for the assembly. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8h_source.html#l00411">extract_bv.h:411</a></div></div>
<div class="ttc" id="classForest_1_1ExtractBV_html_a6d3df1dd673f4d18a508ef478e626ef6"><div class="ttname"><a href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6">Forest::ExtractBV::scaling</a></div><div class="ttdeci">void scaling(const double scaling)</div><div class="ttdoc">Scale the interface values with a given scaling factor. </div><div class="ttdef"><b>Definition:</b> <a href="extract__bv_8cc_source.html#l00974">extract_bv.cc:974</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-26" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a6125e651ca0f77edc13d675d9f55e26e_cgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a6125e651ca0f77edc13d675d9f55e26e_cgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a6125e651ca0f77edc13d675d9f55e26e_cgraph" id="classForest_1_1ExtractBV_a6125e651ca0f77edc13d675d9f55e26e_cgraph">
<area shape="rect" id="node2" href="classForest_1_1ExtractBV.html#a6d3df1dd673f4d18a508ef478e626ef6" title="Scale the interface values with a given scaling factor. " alt="" coords="188,5,323,47"/>
</map>
</div>
</p>

<p><div id="dynsection-27" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1ExtractBV_a6125e651ca0f77edc13d675d9f55e26e_icgraph.png" border="0" usemap="#classForest_1_1ExtractBV_a6125e651ca0f77edc13d675d9f55e26e_icgraph" alt=""/></div>
<map name="classForest_1_1ExtractBV_a6125e651ca0f77edc13d675d9f55e26e_icgraph" id="classForest_1_1ExtractBV_a6125e651ca0f77edc13d675d9f55e26e_icgraph">
<area shape="rect" id="node2" href="classForest_1_1NeutronicModule.html#a4d61476d9efb27527244dd286f93d574" title="Forest::NeutronicModule::run" alt="" coords="188,42,379,69"/>
<area shape="rect" id="node3" href="classForest_1_1NeutronicModule.html#adf722f675d9b68dd3591196dab7fde20" title="Forest::NeutronicModule\l::NeutronicModule" alt="" coords="427,5,592,47"/>
<area shape="rect" id="node4" href="main_8cc.html#a12426dd6493a4baf708c016a4d10be43" title="Example main program. " alt="" coords="475,71,543,98"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="aa10dcb39cdc6c5526050e232fa52ab35"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classForest_1_1Homogenization.html">Homogenization</a>&lt; dim &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00481">481</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

</div>
</div>
<a class="anchor" id="aaebbe654eda55f3f9797a0002de1288e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classForest_1_1HomData.html">HomData</a>&lt; dim &gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00482">482</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="af6ab5e3132ab03a469ccca76952378a3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Indicating the level of verbose: 0 = none; 1 = everything. </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00058">58</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00892">Forest::ExtractBV&lt; dim &gt;::coarsening_angular()</a>, <a class="el" href="extract__bv_8cc_source.html#l00869">Forest::ExtractBV&lt; dim &gt;::coarsening_spatial()</a>, <a class="el" href="extract__bv_8cc_source.html#l00066">Forest::ExtractBV&lt; dim &gt;::initialize()</a>, <a class="el" href="extract__bv_8cc_source.html#l00271">Forest::ExtractBV&lt; dim &gt;::print_ass_bc()</a>, <a class="el" href="extract__bv_8cc_source.html#l00815">Forest::ExtractBV&lt; dim &gt;::read_ass_bv()</a>, <a class="el" href="extract__bv_8cc_source.html#l00237">Forest::ExtractBV&lt; dim &gt;::set_ass2pin()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00166">Forest::ExtractBV&lt; dim &gt;::set_ass_bc()</a>.</p>

</div>
</div>
<a class="anchor" id="abd57835ed1e2c7414f83078efce7ffbf"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classForest_1_1State.html">State</a>&lt;dim&gt;&amp; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::mp_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reference to the state object. </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00061">61</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00620">Forest::ExtractBV&lt; dim &gt;::calculate_current_ass()</a>, <a class="el" href="extract__bv_8cc_source.html#l00545">Forest::ExtractBV&lt; dim &gt;::calculate_current_pin()</a>, <a class="el" href="extract__bv_8cc_source.html#l00728">Forest::ExtractBV&lt; dim &gt;::calculate_moments_ass()</a>, <a class="el" href="extract__bv_8cc_source.html#l00685">Forest::ExtractBV&lt; dim &gt;::calculate_moments_pin()</a>, <a class="el" href="extract__bv_8cc_source.html#l00771">Forest::ExtractBV&lt; dim &gt;::print_ass_bv()</a>, <a class="el" href="extract__bv_8cc_source.html#l00815">Forest::ExtractBV&lt; dim &gt;::read_ass_bv()</a>, <a class="el" href="extract__bv_8cc_source.html#l00166">Forest::ExtractBV&lt; dim &gt;::set_ass_bc()</a>, <a class="el" href="extract__bv_8cc_source.html#l00515">Forest::ExtractBV&lt; dim &gt;::set_ass_bv()</a>, <a class="el" href="extract__bv_8cc_source.html#l00463">Forest::ExtractBV&lt; dim &gt;::set_ass_bw()</a>, <a class="el" href="extract__bv_8cc_source.html#l00101">Forest::ExtractBV&lt; dim &gt;::set_pin_bc()</a>, <a class="el" href="extract__bv_8cc_source.html#l00383">Forest::ExtractBV&lt; dim &gt;::set_pin_bv()</a>, <a class="el" href="extract__bv_8cc_source.html#l00408">Forest::ExtractBV&lt; dim &gt;::set_pin_bv_g_n()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00332">Forest::ExtractBV&lt; dim &gt;::set_pin_bw()</a>.</p>

</div>
</div>
<a class="anchor" id="af29b71d47daaad7709879135b04f394c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classForest_1_1QuadratureBase.html">QuadratureBase</a>&lt;dim&gt; &gt; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_ord</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Angular quadrature. </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00064">64</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00620">Forest::ExtractBV&lt; dim &gt;::calculate_current_ass()</a>, <a class="el" href="extract__bv_8cc_source.html#l00545">Forest::ExtractBV&lt; dim &gt;::calculate_current_pin()</a>, <a class="el" href="extract__bv_8cc_source.html#l00728">Forest::ExtractBV&lt; dim &gt;::calculate_moments_ass()</a>, <a class="el" href="extract__bv_8cc_source.html#l00685">Forest::ExtractBV&lt; dim &gt;::calculate_moments_pin()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00771">Forest::ExtractBV&lt; dim &gt;::print_ass_bv()</a>.</p>

</div>
</div>
<a class="anchor" id="ae8bbac2fc100dde23aade6c1a492c96e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classForest_1_1ProbGeom.html">ProbGeom</a>&lt;dim&gt;&amp; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::mp_geom</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Geometry. </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00067">67</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00620">Forest::ExtractBV&lt; dim &gt;::calculate_current_ass()</a>, <a class="el" href="extract__bv_8cc_source.html#l00545">Forest::ExtractBV&lt; dim &gt;::calculate_current_pin()</a>, <a class="el" href="extract__bv_8cc_source.html#l00728">Forest::ExtractBV&lt; dim &gt;::calculate_moments_ass()</a>, <a class="el" href="extract__bv_8cc_source.html#l00685">Forest::ExtractBV&lt; dim &gt;::calculate_moments_pin()</a>, <a class="el" href="extract__bv_8cc_source.html#l00869">Forest::ExtractBV&lt; dim &gt;::coarsening_spatial()</a>, <a class="el" href="extract__bv_8cc_source.html#l00271">Forest::ExtractBV&lt; dim &gt;::print_ass_bc()</a>, <a class="el" href="extract__bv_8cc_source.html#l00771">Forest::ExtractBV&lt; dim &gt;::print_ass_bv()</a>, <a class="el" href="extract__bv_8cc_source.html#l00815">Forest::ExtractBV&lt; dim &gt;::read_ass_bv()</a>, <a class="el" href="extract__bv_8cc_source.html#l00237">Forest::ExtractBV&lt; dim &gt;::set_ass2pin()</a>, <a class="el" href="extract__bv_8cc_source.html#l00166">Forest::ExtractBV&lt; dim &gt;::set_ass_bc()</a>, <a class="el" href="extract__bv_8cc_source.html#l00515">Forest::ExtractBV&lt; dim &gt;::set_ass_bv()</a>, <a class="el" href="extract__bv_8cc_source.html#l00463">Forest::ExtractBV&lt; dim &gt;::set_ass_bw()</a>, <a class="el" href="extract__bv_8cc_source.html#l00101">Forest::ExtractBV&lt; dim &gt;::set_pin_bc()</a>, <a class="el" href="extract__bv_8cc_source.html#l00383">Forest::ExtractBV&lt; dim &gt;::set_pin_bv()</a>, <a class="el" href="extract__bv_8cc_source.html#l00408">Forest::ExtractBV&lt; dim &gt;::set_pin_bv_g_n()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00332">Forest::ExtractBV&lt; dim &gt;::set_pin_bw()</a>.</p>

</div>
</div>
<a class="anchor" id="adce3387da7a39374002770c2edd25daa"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classdealii_1_1DoFHandler.html">DoFHandler</a>&lt;dim, dim&gt;&amp; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_dof_handler</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00068">68</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00166">Forest::ExtractBV&lt; dim &gt;::set_ass_bc()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00101">Forest::ExtractBV&lt; dim &gt;::set_pin_bc()</a>.</p>

</div>
</div>
<a class="anchor" id="a58b15e427a438a6b8b95e259d26105ab"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_n_groups</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00069">69</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00728">Forest::ExtractBV&lt; dim &gt;::calculate_moments_ass()</a>, <a class="el" href="extract__bv_8cc_source.html#l00685">Forest::ExtractBV&lt; dim &gt;::calculate_moments_pin()</a>, <a class="el" href="extract__bv_8cc_source.html#l00869">Forest::ExtractBV&lt; dim &gt;::coarsening_spatial()</a>, <a class="el" href="extract__bv_8cc_source.html#l00771">Forest::ExtractBV&lt; dim &gt;::print_ass_bv()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00815">Forest::ExtractBV&lt; dim &gt;::read_ass_bv()</a>.</p>

</div>
</div>
<a class="anchor" id="a5973ec1792ae1bbc91ffec9feeab23fd"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_n_angles</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00070">70</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00620">Forest::ExtractBV&lt; dim &gt;::calculate_current_ass()</a>, <a class="el" href="extract__bv_8cc_source.html#l00545">Forest::ExtractBV&lt; dim &gt;::calculate_current_pin()</a>, <a class="el" href="extract__bv_8cc_source.html#l00728">Forest::ExtractBV&lt; dim &gt;::calculate_moments_ass()</a>, <a class="el" href="extract__bv_8cc_source.html#l00685">Forest::ExtractBV&lt; dim &gt;::calculate_moments_pin()</a>, <a class="el" href="extract__bv_8cc_source.html#l00869">Forest::ExtractBV&lt; dim &gt;::coarsening_spatial()</a>, <a class="el" href="extract__bv_8cc_source.html#l00515">Forest::ExtractBV&lt; dim &gt;::set_ass_bv()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00383">Forest::ExtractBV&lt; dim &gt;::set_pin_bv()</a>.</p>

</div>
</div>
<a class="anchor" id="ab554683822d192e266bd3373c7b60b9b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_n_leg_mom = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000100">Todo:</a></b></dt><dd>move this value to the materials input? </dd></dl>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00073">73</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

</div>
</div>
<a class="anchor" id="a58b31a2d3c8293eb687368f71d0659be"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;<a class="el" href="classForest_1_1ExtractBV.html#a7cd32560420878a05248db7bc13890e1">map_cf</a>&gt; &gt; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_pin_bc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>m_pin_bc[pin][face] is a map containing the pairs pair(cell,f), so we can easily find the cells and faces inside a triangulation defining the boundary <code>face</code> of the pin <code>pin</code> </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00333">333</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00101">Forest::ExtractBV&lt; dim &gt;::set_pin_bc()</a>, <a class="el" href="extract__bv_8cc_source.html#l00408">Forest::ExtractBV&lt; dim &gt;::set_pin_bv_g_n()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00332">Forest::ExtractBV&lt; dim &gt;::set_pin_bw()</a>.</p>

</div>
</div>
<a class="anchor" id="a601c8ad25bfa0d43984c2cf2b5cd8a50"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_pin_bw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Container for the pin faces boundary weight. </p>
<p>The arguments here are the <code>pin_index</code> and the <code>pin_face</code>, storing the measure of the face as follows </p><div class="fragment"><div class="line"><span class="keywordtype">double</span> boundary_weight = <a class="code" href="classForest_1_1ExtractBV.html#a601c8ad25bfa0d43984c2cf2b5cd8a50">m_pin_bw</a>[pin][f];</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00343">343</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00515">Forest::ExtractBV&lt; dim &gt;::set_ass_bv()</a>, <a class="el" href="extract__bv_8cc_source.html#l00408">Forest::ExtractBV&lt; dim &gt;::set_pin_bv_g_n()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00332">Forest::ExtractBV&lt; dim &gt;::set_pin_bw()</a>.</p>

</div>
</div>
<a class="anchor" id="a20d4126d42f8027c6f1e4df21943a8d4"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a4f51e208613155f983c9c99907ca781a">stdvd4</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_pin_bv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Container for the pin faces boundary values. </p>
<p>The arguments here are the <code>pin_index</code>, the <code>pin_face</code>, the <code>energy_group</code> and the <code>angle</code>. For each of this combinations, we have the average value of the flux at the specified face of the pin as follows </p><div class="fragment"><div class="line"><span class="keywordtype">double</span> boundary_value = <a class="code" href="classForest_1_1ExtractBV.html#a20d4126d42f8027c6f1e4df21943a8d4">m_pin_bv</a>[pin][f][group_g][angle];</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00355">355</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00545">Forest::ExtractBV&lt; dim &gt;::calculate_current_pin()</a>, <a class="el" href="extract__bv_8cc_source.html#l00685">Forest::ExtractBV&lt; dim &gt;::calculate_moments_pin()</a>, <a class="el" href="extract__bv_8cc_source.html#l00869">Forest::ExtractBV&lt; dim &gt;::coarsening_spatial()</a>, <a class="el" href="extract__bv_8cc_source.html#l00815">Forest::ExtractBV&lt; dim &gt;::read_ass_bv()</a>, <a class="el" href="extract__bv_8cc_source.html#l00974">Forest::ExtractBV&lt; dim &gt;::scaling()</a>, <a class="el" href="extract__bv_8cc_source.html#l00515">Forest::ExtractBV&lt; dim &gt;::set_ass_bv()</a>, <a class="el" href="extract__bv_8cc_source.html#l00383">Forest::ExtractBV&lt; dim &gt;::set_pin_bv()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00408">Forest::ExtractBV&lt; dim &gt;::set_pin_bv_g_n()</a>.</p>

</div>
</div>
<a class="anchor" id="a6fc848227ff4977e81bf80067c592bc7"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a4f51e208613155f983c9c99907ca781a">stdvd4</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_pin_bvm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Container for the pin faces boundary values. </p>
<p>The arguments here are the <code>pin_index</code>, the <code>pin_face</code>, the <code>energy_group</code> and the <code>moment</code>. For each of this combinations, we have the average value of the flux at the specified face of the pin as follows </p><div class="fragment"><div class="line"><span class="keywordtype">double</span> boundary_value_m = <a class="code" href="classForest_1_1ExtractBV.html#a6fc848227ff4977e81bf80067c592bc7">m_pin_bvm</a>[pin][f][group_g][moment];</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00367">367</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00685">Forest::ExtractBV&lt; dim &gt;::calculate_moments_pin()</a>, and <a class="el" href="extract__bv_8cc_source.html#l01022">Forest::ExtractBV&lt; dim &gt;::scaling_moments()</a>.</p>

</div>
</div>
<a class="anchor" id="a6d8ab0ab3b7d3bfa34d4042760890b63"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::set&lt;unsigned int&gt; &gt; &gt; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_ass2pin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pins over the boundary of the assembly. </p>
<p>assebmly_boundary[ass_i][face_i] is a set containing the cells, so we can easily find the cells and faces inside a triangulation defining the boundary <code>face_i</code> of the assembly <code>ass_i</code> </p><dl class="section note"><dt>Note</dt><dd>used in inner_iteration and boundaryvalues </dd></dl>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00376">376</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00271">Forest::ExtractBV&lt; dim &gt;::print_ass_bc()</a>, <a class="el" href="extract__bv_8cc_source.html#l00237">Forest::ExtractBV&lt; dim &gt;::set_ass2pin()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00515">Forest::ExtractBV&lt; dim &gt;::set_ass_bv()</a>.</p>

</div>
</div>
<a class="anchor" id="a21d3a9bbcde5245008763f732c27e4ce"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;<a class="el" href="classForest_1_1ExtractBV.html#a7cd32560420878a05248db7bc13890e1">map_cf</a>&gt; &gt; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_ass_bc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>boundary container for the assembly sorting cells and faces </p>
<p>m_ass_bc[ass_i][face_i] is a map containing the pairs pair(cell,f), so we can easily find the cells and faces inside a triangulation defining the boundary <code>face_i</code> of the assembly <code>ass_i</code> </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00384">384</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00271">Forest::ExtractBV&lt; dim &gt;::print_ass_bc()</a>, <a class="el" href="extract__bv_8cc_source.html#l00237">Forest::ExtractBV&lt; dim &gt;::set_ass2pin()</a>, <a class="el" href="extract__bv_8cc_source.html#l00166">Forest::ExtractBV&lt; dim &gt;::set_ass_bc()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00463">Forest::ExtractBV&lt; dim &gt;::set_ass_bw()</a>.</p>

</div>
</div>
<a class="anchor" id="aec313821f23b0f8521a1fc06d8d70bc1"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#ae767775a85397eb408e80f7f746e64ae">stdvd2</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_ass_bw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Container for the ass faces boundary weight. </p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> boundary_weight = <a class="code" href="classForest_1_1ExtractBV.html#aec313821f23b0f8521a1fc06d8d70bc1">m_ass_bw</a>[ass][f];</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00393">393</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00515">Forest::ExtractBV&lt; dim &gt;::set_ass_bv()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00463">Forest::ExtractBV&lt; dim &gt;::set_ass_bw()</a>.</p>

</div>
</div>
<a class="anchor" id="a23a390ddb4807d3fd585526881b0b877"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a4f51e208613155f983c9c99907ca781a">stdvd4</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_ass_bv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Container for the boundary values for the assembly. </p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> bv = <a class="code" href="classForest_1_1ExtractBV.html#a23a390ddb4807d3fd585526881b0b877">m_ass_bv</a>[ass][f][group_g][angle];</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00402">402</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00620">Forest::ExtractBV&lt; dim &gt;::calculate_current_ass()</a>, <a class="el" href="extract__bv_8cc_source.html#l00728">Forest::ExtractBV&lt; dim &gt;::calculate_moments_ass()</a>, <a class="el" href="extract__bv_8cc_source.html#l00869">Forest::ExtractBV&lt; dim &gt;::coarsening_spatial()</a>, <a class="el" href="extract__bv_8cc_source.html#l00771">Forest::ExtractBV&lt; dim &gt;::print_ass_bv()</a>, <a class="el" href="extract__bv_8cc_source.html#l00815">Forest::ExtractBV&lt; dim &gt;::read_ass_bv()</a>, <a class="el" href="extract__bv_8cc_source.html#l00974">Forest::ExtractBV&lt; dim &gt;::scaling()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00515">Forest::ExtractBV&lt; dim &gt;::set_ass_bv()</a>.</p>

</div>
</div>
<a class="anchor" id="a3ebb32675c1888817632918917e36709"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a4f51e208613155f983c9c99907ca781a">stdvd4</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_ass_bvm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Container for the boundary values for the assembly. </p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> bvm = <a class="code" href="classForest_1_1ExtractBV.html#a3ebb32675c1888817632918917e36709">m_ass_bvm</a>[ass][f][group_g][moment];</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00411">411</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00728">Forest::ExtractBV&lt; dim &gt;::calculate_moments_ass()</a>, and <a class="el" href="extract__bv_8cc_source.html#l01022">Forest::ExtractBV&lt; dim &gt;::scaling_moments()</a>.</p>

</div>
</div>
<a class="anchor" id="ab2ec657fef942c86ce29a07178435e6f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_phi0_pin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Container for the boundary values for the flux. </p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> bv = m_phi0[pin][f][group_g];</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00420">420</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00545">Forest::ExtractBV&lt; dim &gt;::calculate_current_pin()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00974">Forest::ExtractBV&lt; dim &gt;::scaling()</a>.</p>

</div>
</div>
<a class="anchor" id="a0c5cba2999422814170f891cb707d1a0"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_phi0_ass</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00421">421</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00620">Forest::ExtractBV&lt; dim &gt;::calculate_current_ass()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00974">Forest::ExtractBV&lt; dim &gt;::scaling()</a>.</p>

</div>
</div>
<a class="anchor" id="aa4f9100e9dce4a8c4275abdeebd15487"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_jp_o_pin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Container for the values for the outgoing partial current. </p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> bv = m_jp_o[pin][f][group_g];</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00429">429</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00545">Forest::ExtractBV&lt; dim &gt;::calculate_current_pin()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00974">Forest::ExtractBV&lt; dim &gt;::scaling()</a>.</p>

</div>
</div>
<a class="anchor" id="a155f5b3d28bfe916661fb56c0d9fe5cb"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_jp_o_ass</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00430">430</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00620">Forest::ExtractBV&lt; dim &gt;::calculate_current_ass()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00974">Forest::ExtractBV&lt; dim &gt;::scaling()</a>.</p>

</div>
</div>
<a class="anchor" id="ae3a86c811e9da115d39ce36d972e9a9a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_jp_i_pin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Container for the values for the incoming partial current. </p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> bv = m_jp_i[pin][f][group_g];</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00438">438</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00545">Forest::ExtractBV&lt; dim &gt;::calculate_current_pin()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00974">Forest::ExtractBV&lt; dim &gt;::scaling()</a>.</p>

</div>
</div>
<a class="anchor" id="a187bacdfe10d7de8fd46fab9ed802ace"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_jp_i_ass</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00439">439</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00620">Forest::ExtractBV&lt; dim &gt;::calculate_current_ass()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00974">Forest::ExtractBV&lt; dim &gt;::scaling()</a>.</p>

</div>
</div>
<a class="anchor" id="aa9c71737f27c0d7a213b8ba05642ef51"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a4f51e208613155f983c9c99907ca781a">stdvd4</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_jnet_pin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Container for the boundary values for the net current. </p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> bv = m_jnet[pin][f][group_g][dim];</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00447">447</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00545">Forest::ExtractBV&lt; dim &gt;::calculate_current_pin()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00974">Forest::ExtractBV&lt; dim &gt;::scaling()</a>.</p>

</div>
</div>
<a class="anchor" id="a7672e0dfe0d102c2b9ec7d776892ad3d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a4f51e208613155f983c9c99907ca781a">stdvd4</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_jnet_ass</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00448">448</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00620">Forest::ExtractBV&lt; dim &gt;::calculate_current_ass()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00974">Forest::ExtractBV&lt; dim &gt;::scaling()</a>.</p>

</div>
</div>
<a class="anchor" id="a15d1cfa4b83507500b2ab17e7f98750d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_j_pin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Container for the boundary values for the net current. </p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> bv = m_j[pin][f][group_g];</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00456">456</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00545">Forest::ExtractBV&lt; dim &gt;::calculate_current_pin()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00974">Forest::ExtractBV&lt; dim &gt;::scaling()</a>.</p>

</div>
</div>
<a class="anchor" id="af1399ae53002bef64f107a18c1dadde3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_j_ass</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00457">457</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00620">Forest::ExtractBV&lt; dim &gt;::calculate_current_ass()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00974">Forest::ExtractBV&lt; dim &gt;::scaling()</a>.</p>

</div>
</div>
<a class="anchor" id="a0db15dad2fdc0027f77e122c2503d328"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_phi2_pin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Container for the boundary values for the second moment flux. </p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> bv = m_phi2[pin][f][group_g];</div></div><!-- fragment --> 
<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00466">466</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00545">Forest::ExtractBV&lt; dim &gt;::calculate_current_pin()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00974">Forest::ExtractBV&lt; dim &gt;::scaling()</a>.</p>

</div>
</div>
<a class="anchor" id="a114e7cbb9584babbbd6758c097d8715f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1ExtractBV.html#a35b18eb8254953070491cb4709354451">stdvd3</a> <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_phi2_ass</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00467">467</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00620">Forest::ExtractBV&lt; dim &gt;::calculate_current_ass()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00974">Forest::ExtractBV&lt; dim &gt;::scaling()</a>.</p>

</div>
</div>
<a class="anchor" id="a92b060da2496bd32ec17d4796c7f9190"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;unsigned int&gt; <a class="el" href="classForest_1_1ExtractBV.html">Forest::ExtractBV</a>&lt; dim &gt;::m_bcs_order</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Contains the spherical harmonics order for the bcs. </p>

<p>Definition at line <a class="el" href="extract__bv_8h_source.html#l00472">472</a> of file <a class="el" href="extract__bv_8h_source.html">extract_bv.h</a>.</p>

<p>Referenced by <a class="el" href="extract__bv_8cc_source.html#l00049">Forest::ExtractBV&lt; dim &gt;::ExtractBV()</a>, and <a class="el" href="extract__bv_8cc_source.html#l00815">Forest::ExtractBV&lt; dim &gt;::read_ass_bv()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/lns/Codes/forest-public/mylib/include/neutronics/<a class="el" href="extract__bv_8h_source.html">extract_bv.h</a></li>
<li>/home/lns/Codes/forest-public/mylib/src/neutronics/<a class="el" href="extract__bv_8cc_source.html">extract_bv.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceForest.html">Forest</a></li><li class="navelem"><a class="el" href="classForest_1_1ExtractBV.html">ExtractBV</a></li>
    <li class="footer">Generated on Tue Oct 31 2017 19:02:30 for FOREST by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
