<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>FOREST: Forest::EqSolverWG&lt; dim &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="forest_icon.png" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="forest_icon.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">FOREST
   </div>
   <div id="projectbrief">Framework Oriented for REactor SimulaTions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="pages.html"><span>pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="../../index.html"><span>FOREST&#160;Documentation</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classForest_1_1EqSolverWG.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classForest_1_1EqSolverWG-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Forest::EqSolverWG&lt; dim &gt; Class Template Reference<div class="ingroups"><a class="el" href="group__ForestAlgebra.html">ForestAlgebra</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Class implementing the Solver.  
 <a href="classForest_1_1EqSolverWG.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="solver__eq_8h_source.html">/home/lns/Codes/forest-public/mylib/include/algebra/solver_eq.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac70deb216726b5b4c947fffe094b885f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1EqSolverWG.html#ac70deb216726b5b4c947fffe094b885f">EqSolverWG</a> (<a class="el" href="classForest_1_1State.html">State</a>&lt; dim &gt; &amp;state, <a class="el" href="classForest_1_1Equation.html">Equation</a>&lt; dim &gt; &amp;equation)</td></tr>
<tr class="separator:ac70deb216726b5b4c947fffe094b885f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd97f4a2183ef29cc3aec618a9c789d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1EqSolverWG.html#abd97f4a2183ef29cc3aec618a9c789d6">solve</a> (<a class="el" href="classdealii_1_1BlockVector.html">BlockVector</a>&lt; double &gt; &amp;sol, const <a class="el" href="classdealii_1_1BlockVector.html">BlockVector</a>&lt; double &gt; &amp;rhs, const double tol_default=-1., const unsigned int max_it_default=0) const </td></tr>
<tr class="separator:abd97f4a2183ef29cc3aec618a9c789d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae02db7d5c2ec6c7d11931bd473fe5bad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1EqSolverWG.html#ae02db7d5c2ec6c7d11931bd473fe5bad">richardson</a> (<a class="el" href="classdealii_1_1BlockVector.html">BlockVector</a>&lt; double &gt; &amp;sol, const <a class="el" href="classdealii_1_1BlockVector.html">BlockVector</a>&lt; double &gt; &amp;rhs, const double tol, const unsigned int max_it) const </td></tr>
<tr class="memdesc:ae02db7d5c2ec6c7d11931bd473fe5bad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Richardson method for solving a linear system.  <a href="#ae02db7d5c2ec6c7d11931bd473fe5bad">More...</a><br /></td></tr>
<tr class="separator:ae02db7d5c2ec6c7d11931bd473fe5bad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33914eb34f77d6d5ae7720d9ce92654e"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1EqSolverWG.html#a33914eb34f77d6d5ae7720d9ce92654e">get_tot_wg_it</a> () const </td></tr>
<tr class="memdesc:a33914eb34f77d6d5ae7720d9ce92654e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the total number of sweeps within energy groups.  <a href="#a33914eb34f77d6d5ae7720d9ce92654e">More...</a><br /></td></tr>
<tr class="separator:a33914eb34f77d6d5ae7720d9ce92654e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a735f7b060f85ade1344fcefc7f97dfe4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1EqSolverWG.html#a735f7b060f85ade1344fcefc7f97dfe4">memory_consumption</a> () const </td></tr>
<tr class="memdesc:a735f7b060f85ade1344fcefc7f97dfe4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the memory consumption of the vectors of this class.  <a href="#a735f7b060f85ade1344fcefc7f97dfe4">More...</a><br /></td></tr>
<tr class="separator:a735f7b060f85ade1344fcefc7f97dfe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ae55b64b504b5b49351e37d2021b27f76"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1State.html">State</a>&lt; dim &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1EqSolverWG.html#ae55b64b504b5b49351e37d2021b27f76">mp_state</a></td></tr>
<tr class="memdesc:ae55b64b504b5b49351e37d2021b27f76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reference pointer to the state vector.  <a href="#ae55b64b504b5b49351e37d2021b27f76">More...</a><br /></td></tr>
<tr class="separator:ae55b64b504b5b49351e37d2021b27f76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03f04d09e4d6b0bd8ec848eaba07d021"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1Equation.html">Equation</a>&lt; dim &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1EqSolverWG.html#a03f04d09e4d6b0bd8ec848eaba07d021">mp_equation</a></td></tr>
<tr class="separator:a03f04d09e4d6b0bd8ec848eaba07d021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ee2b46905f41e9964586a9dacddf0fb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classForest_1_1EqPrec.html">EqPrec</a>&lt; dim &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1EqSolverWG.html#a2ee2b46905f41e9964586a9dacddf0fb">m_preconditioner</a></td></tr>
<tr class="separator:a2ee2b46905f41e9964586a9dacddf0fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86f119fbd09a3dec6247e1abaf81c21e"><td class="memItemLeft" align="right" valign="top">GrowingVectorMemory&lt; <a class="el" href="classdealii_1_1BlockVector.html">BlockVector</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1EqSolverWG.html#a86f119fbd09a3dec6247e1abaf81c21e">m_vector_memory</a></td></tr>
<tr class="memdesc:a86f119fbd09a3dec6247e1abaf81c21e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory for GMRES (within-group).  <a href="#a86f119fbd09a3dec6247e1abaf81c21e">More...</a><br /></td></tr>
<tr class="separator:a86f119fbd09a3dec6247e1abaf81c21e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5161574fd00f9f9c394e845585e13322"><td class="memItemLeft" align="right" valign="top">const unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1EqSolverWG.html#a5161574fd00f9f9c394e845585e13322">m_max_it_i</a></td></tr>
<tr class="memdesc:a5161574fd00f9f9c394e845585e13322"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum iterations of the solvers (within-group).  <a href="#a5161574fd00f9f9c394e845585e13322">More...</a><br /></td></tr>
<tr class="separator:a5161574fd00f9f9c394e845585e13322"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdb5a669276a8d57f739b1a1bf4bc210"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1EqSolverWG.html#acdb5a669276a8d57f739b1a1bf4bc210">m_tol_i</a></td></tr>
<tr class="memdesc:acdb5a669276a8d57f739b1a1bf4bc210"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tolerance criteria for the solvers (within-group).  <a href="#acdb5a669276a8d57f739b1a1bf4bc210">More...</a><br /></td></tr>
<tr class="separator:acdb5a669276a8d57f739b1a1bf4bc210"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd392699ae34a6584eebae526acac241"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1EqSolverWG.html#acd392699ae34a6584eebae526acac241">m_use_krylov</a></td></tr>
<tr class="memdesc:acd392699ae34a6584eebae526acac241"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to use the Krylov solver (within-group).  <a href="#acd392699ae34a6584eebae526acac241">More...</a><br /></td></tr>
<tr class="separator:acd392699ae34a6584eebae526acac241"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05da0b5b87d2d9a9c2dd5b71427eb3fd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1EqSolverWG.html#a05da0b5b87d2d9a9c2dd5b71427eb3fd">m_use_richardson</a></td></tr>
<tr class="memdesc:a05da0b5b87d2d9a9c2dd5b71427eb3fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to use the Richardson iteration (within-group).  <a href="#a05da0b5b87d2d9a9c2dd5b71427eb3fd">More...</a><br /></td></tr>
<tr class="separator:a05da0b5b87d2d9a9c2dd5b71427eb3fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc9a9fc325203a08103ab020025d2a3b"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classForest_1_1EqSolverWG.html#abc9a9fc325203a08103ab020025d2a3b">m_total_wg_it</a></td></tr>
<tr class="memdesc:abc9a9fc325203a08103ab020025d2a3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counting the sweeps (within-group).  <a href="#abc9a9fc325203a08103ab020025d2a3b">More...</a><br /></td></tr>
<tr class="separator:abc9a9fc325203a08103ab020025d2a3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;int dim&gt;<br />
class Forest::EqSolverWG&lt; dim &gt;</h3>

<p>Class implementing the Solver. </p>
<p>This class implements the solver for the source problem working at two different levels, the within-group source problem and the multi-group problem, depending on the type of the vector provided.</p>
<p>We have to solve a source problem in a multi-group level, and this is approximated by working with single-group solvers.</p>
<h1>Multi-Group (Gauss-Seidel)</h1>
<p>The original problem looks as follows (integro-differential operator)</p>
<p class="formulaDsp">
\begin{align*} (L+MSD)\Psi = Q \end{align*}
</p>
<p>This system has a block structure defined by the energy discretization, where the streaming operator \( L \) is block diagonal (no coupling between different groups), and operator \( S \) is "almost" lower triangular (up-scattering is usually smaller than down-scattering). A reasonable approach would be then to solve the systems as if it would be lower triangular, and "lagger" the up-scattering to be multiplied to a guess. To do so, we start solving the system for the first energy group, and then applying the Gauss-Seidel method as follows</p>
<p class="formulaDsp">
\begin{align*} (L+MS_{LD}D)\Psi^{n+1} = M S_{U} D \Psi^{n} + Q \end{align*}
</p>
<p>But, in order to improve its solvability the system is rewritten as</p>
<p class="formulaDsp">
\begin{align*} (I+L^{-1}MS_{LD}D)\Psi^{n+1} = L^{-1}( M S_{U} D \Psi^{n} + Q ) \end{align*}
</p>
<p>Or we can simplify the notation by writing</p>
<p class="formulaDsp">
\begin{align*} A x = b \end{align*}
</p>
<p>where the matrix \( A \) (approximating an integral operator) and the source \( b \) are defined as</p>
<p class="formulaDsp">
\begin{align*} A := (I-L^{-1}MS_{LD}D) , \quad \text{and} \quad b := L^{-1}\hat{Q} := L^{-1} (M S_{U} D \Psi^{n} + Q) \end{align*}
</p>
<dl class="section note"><dt>Note</dt><dd>It is important to notice here that using this strategy we are not really solving the system. In order to do so, this iteration can be used as a preconditioner for a full energy groups GMRES. The update obtained here is a good approximation, and it is enough when using the power iteration to solve the eigenvalue problem, while it would not be enough if the eigenproblem is solved with, for instance, an Arnoldi method.</dd></dl>
<h1>Single Group Source Iteration.</h1>
<p>Here we perform, for a given energy group <code>m_g</code>, one source iteration. Lets consider the following problem (we skip the group index \( g \) because it happens inside each group)</p>
<p class="formulaDsp">
\begin{align*} L \Psi = MSD \Psi + Q \end{align*}
</p>
<h2>Neglecting Reflecting Boundary Conditions.</h2>
<p>We use the flux in the previous iteration collapsed with the operator D to reduce its dimensionality, and then update the solution inverting the streaming term (what should be easier)</p>
<p class="formulaDsp">
\begin{align*} &amp; \Psi^{l+1} = L^{-1}(MS \Phi^{l} + Q) \\ &amp; \Phi^{l} = D \Psi^{l} \end{align*}
</p>
<p>This expression, ignoring boundary conditions, can be simplified further by combining the two equations as follows</p>
<p class="formulaDsp">
\begin{align*} &amp; (I - D L^{-1} MS) \Phi = D b \end{align*}
</p>
<h2>Including Reflecting Boundary Conditions</h2>
<p>Here we assume "lagged" the scattering term to a previous iteration step, as before, but also "lagged" the effect of the boundary conditions, and we use the flux in the previous iteration collapsed with the operator D to reduce its dimensionality. Thus we obtain</p>
<p class="formulaDsp">
\begin{align*} \left[ \begin{array}{c} \Phi^{l+1} \\ \Psi^{l+1}_{S} \end{array} \right] = \left[ \begin{array}{cc} D &amp; 0 \\ 0 &amp; I \end{array} \right] \left( \left[ \begin{array}{c} I \\ P^{T} \end{array} \right] L_{0}^{-1} \left[ \begin{array}{cc} I &amp; -L_{R} P \end{array} \right] \right) \left[ \begin{array}{cc} M &amp; 0 \\ 0 &amp; I \end{array} \right] \left[ \begin{array}{cc} S &amp; 0 \\ 0 &amp; I \end{array} \right] \left[ \begin{array}{c} \Phi^{l} \\ \Psi^{l}_{S} \end{array} \right] + \left[ \begin{array}{c} D L_{0}^{-1} Q \\ P^{T}L_{0}^{-1} Q \end{array} \right] \end{align*}
</p>
<p>This can be rewritten as</p>
<p class="formulaDsp">
\begin{align*} &amp; (\hat{I} - \hat{D} \hat{L}^{-1} \hat{M}\hat{S}) \hat{\Phi} = \hat{b} \end{align*}
</p>
<p>where</p>
<p class="formulaDsp">
\begin{align*} \hat{\Phi} := \left[ \begin{array}{c} \Phi\\ \Psi_{S} \end{array} \right], \quad \hat{L}^{-1} := \left( \left[ \begin{array}{c} I \\ P^{T} \end{array} \right] L_{0}^{-1} \left[ \begin{array}{cc} I &amp; -L_{R} P \end{array} \right] \right) \equiv \left[ \begin{array}{cc} L_{0}^{-1} &amp; -L_{0}^{-1} L_{R} P \\ P^{T}L_{0}^{-1} &amp; -P^{T}L_{0}^{-1} L_{R} P \end{array} \right] \end{align*}
</p>
<p>and the rest of the operators follow the notation in the obvious way. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000035">Todo:</a></b></dt><dd>Hide all the discussion related to the particular problem from this class and move it to the <a class="el" href="classForest_1_1Equation.html" title="Equation, base class. ">Equation</a> class. Here we are solving a linear system \( A x = b \) . </dd></dl>

<p>Definition at line <a class="el" href="solver__eq_8h_source.html#l00345">345</a> of file <a class="el" href="solver__eq_8h_source.html">solver_eq.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ac70deb216726b5b4c947fffe094b885f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1EqSolverWG.html">Forest::EqSolverWG</a>&lt; dim &gt;::<a class="el" href="classForest_1_1EqSolverWG.html">EqSolverWG</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classForest_1_1State.html">State</a>&lt; dim &gt; &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classForest_1_1Equation.html">Equation</a>&lt; dim &gt; &amp;&#160;</td>
          <td class="paramname"><em>equation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000037">Todo:</a></b></dt><dd>Document me </dd></dl>

<p>Definition at line <a class="el" href="solver__eq_8cc_source.html#l00261">261</a> of file <a class="el" href="solver__eq_8cc_source.html">solver_eq.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      : <a class="code" href="classForest_1_1EqSolverWG.html#ae55b64b504b5b49351e37d2021b27f76">mp_state</a> (state),</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <a class="code" href="classForest_1_1EqSolverWG.html#a03f04d09e4d6b0bd8ec848eaba07d021">mp_equation</a> (equation),</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <a class="code" href="classForest_1_1EqSolverWG.html#a2ee2b46905f41e9964586a9dacddf0fb">m_preconditioner</a> (<a class="code" href="classForest_1_1EqSolverWG.html#a03f04d09e4d6b0bd8ec848eaba07d021">mp_equation</a>), <span class="comment">// Parsing the preconditioner</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="classForest_1_1EqSolverWG.html#a86f119fbd09a3dec6247e1abaf81c21e">m_vector_memory</a> (8),</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="classForest_1_1EqSolverWG.html#a5161574fd00f9f9c394e845585e13322">m_max_it_i</a> (<a class="code" href="classForest_1_1EqSolverWG.html#ae55b64b504b5b49351e37d2021b27f76">mp_state</a>.mp_data.mp_settings.get_inner_max_it ()),</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <a class="code" href="classForest_1_1EqSolverWG.html#acdb5a669276a8d57f739b1a1bf4bc210">m_tol_i</a> (<a class="code" href="classForest_1_1EqSolverWG.html#ae55b64b504b5b49351e37d2021b27f76">mp_state</a>.mp_data.mp_settings.get_inner_tol ())</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// start the timer for initializing the geometry object.</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    Timer timer;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    timer.restart (); <span class="comment">// We restart the timer</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// Set the control parameters.</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="classForest_1_1EqSolverWG.html#acd392699ae34a6584eebae526acac241">m_use_krylov</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="classForest_1_1EqSolverWG.html#a05da0b5b87d2d9a9c2dd5b71427eb3fd">m_use_richardson</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// Initialization of the counters for the sweeps.</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="classForest_1_1EqSolverWG.html#abc9a9fc325203a08103ab020025d2a3b">m_total_wg_it</a> = 0;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// Stop the timer and report the time</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    timer.stop ();</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="classForest_1_1StatsTimer.html#abcea4c84eefef9cc2c98cd57a390db3a">StatsTimer::instance</a> ().<a class="code" href="classForest_1_1StatsTimer.html#a6eeef37937bfc1eb0b6f1d1f7cb7e822">add</a> (<span class="stringliteral">&quot;EqSolverWG&quot;</span>, timer.wall_time ());</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">// Report the memory</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="classForest_1_1StatsMemory.html#a5eb587b9a801cb0c550cbbddf4683a9e">StatsMemory::instance</a> ().<a class="code" href="classForest_1_1StatsMemory.html#a606d8a3997ebe17f80942fb446ee521c">add</a> (<span class="stringliteral">&quot;EqSolverWG&quot;</span>, <a class="code" href="classForest_1_1EqSolverWG.html#a735f7b060f85ade1344fcefc7f97dfe4">memory_consumption</a> ());</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  }</div><div class="ttc" id="classForest_1_1EqSolverWG_html_acdb5a669276a8d57f739b1a1bf4bc210"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#acdb5a669276a8d57f739b1a1bf4bc210">Forest::EqSolverWG::m_tol_i</a></div><div class="ttdeci">const double m_tol_i</div><div class="ttdoc">Tolerance criteria for the solvers (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00403">solver_eq.h:403</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_ae55b64b504b5b49351e37d2021b27f76"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#ae55b64b504b5b49351e37d2021b27f76">Forest::EqSolverWG::mp_state</a></div><div class="ttdeci">State&lt; dim &gt; &amp; mp_state</div><div class="ttdoc">Reference pointer to the state vector. </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00393">solver_eq.h:393</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_a86f119fbd09a3dec6247e1abaf81c21e"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#a86f119fbd09a3dec6247e1abaf81c21e">Forest::EqSolverWG::m_vector_memory</a></div><div class="ttdeci">GrowingVectorMemory&lt; BlockVector&lt; double &gt; &gt; m_vector_memory</div><div class="ttdoc">Memory for GMRES (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00398">solver_eq.h:398</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_a2ee2b46905f41e9964586a9dacddf0fb"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#a2ee2b46905f41e9964586a9dacddf0fb">Forest::EqSolverWG::m_preconditioner</a></div><div class="ttdeci">EqPrec&lt; dim &gt; m_preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00395">solver_eq.h:395</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_a5161574fd00f9f9c394e845585e13322"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#a5161574fd00f9f9c394e845585e13322">Forest::EqSolverWG::m_max_it_i</a></div><div class="ttdeci">const unsigned int m_max_it_i</div><div class="ttdoc">Maximum iterations of the solvers (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00401">solver_eq.h:401</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_a03f04d09e4d6b0bd8ec848eaba07d021"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#a03f04d09e4d6b0bd8ec848eaba07d021">Forest::EqSolverWG::mp_equation</a></div><div class="ttdeci">Equation&lt; dim &gt; &amp; mp_equation</div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00394">solver_eq.h:394</a></div></div>
<div class="ttc" id="classForest_1_1StatsTimer_html_a6eeef37937bfc1eb0b6f1d1f7cb7e822"><div class="ttname"><a href="classForest_1_1StatsTimer.html#a6eeef37937bfc1eb0b6f1d1f7cb7e822">Forest::StatsTimer::add</a></div><div class="ttdeci">void add(const std::string &amp;flag, double value)</div><div class="ttdoc">add </div><div class="ttdef"><b>Definition:</b> <a href="forest__utils__timer_8cc_source.html#l00030">forest_utils_timer.cc:30</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_abc9a9fc325203a08103ab020025d2a3b"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#abc9a9fc325203a08103ab020025d2a3b">Forest::EqSolverWG::m_total_wg_it</a></div><div class="ttdeci">unsigned int m_total_wg_it</div><div class="ttdoc">Counting the sweeps (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00409">solver_eq.h:409</a></div></div>
<div class="ttc" id="classForest_1_1StatsMemory_html_a606d8a3997ebe17f80942fb446ee521c"><div class="ttname"><a href="classForest_1_1StatsMemory.html#a606d8a3997ebe17f80942fb446ee521c">Forest::StatsMemory::add</a></div><div class="ttdeci">void add(const std::string &amp;flag, double value)</div><div class="ttdoc">add </div><div class="ttdef"><b>Definition:</b> <a href="forest__utils__memory_8cc_source.html#l00023">forest_utils_memory.cc:23</a></div></div>
<div class="ttc" id="classForest_1_1StatsMemory_html_a5eb587b9a801cb0c550cbbddf4683a9e"><div class="ttname"><a href="classForest_1_1StatsMemory.html#a5eb587b9a801cb0c550cbbddf4683a9e">Forest::StatsMemory::instance</a></div><div class="ttdeci">static StatsMemory &amp; instance()</div><div class="ttdoc">instance </div><div class="ttdef"><b>Definition:</b> <a href="forest__utils__memory_8h_source.html#l00018">forest_utils_memory.h:18</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_a05da0b5b87d2d9a9c2dd5b71427eb3fd"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#a05da0b5b87d2d9a9c2dd5b71427eb3fd">Forest::EqSolverWG::m_use_richardson</a></div><div class="ttdeci">bool m_use_richardson</div><div class="ttdoc">Flag to use the Richardson iteration (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00407">solver_eq.h:407</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_a735f7b060f85ade1344fcefc7f97dfe4"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#a735f7b060f85ade1344fcefc7f97dfe4">Forest::EqSolverWG::memory_consumption</a></div><div class="ttdeci">double memory_consumption() const </div><div class="ttdoc">Return the memory consumption of the vectors of this class. </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00383">solver_eq.h:383</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_acd392699ae34a6584eebae526acac241"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#acd392699ae34a6584eebae526acac241">Forest::EqSolverWG::m_use_krylov</a></div><div class="ttdeci">bool m_use_krylov</div><div class="ttdoc">Flag to use the Krylov solver (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00405">solver_eq.h:405</a></div></div>
<div class="ttc" id="classForest_1_1StatsTimer_html_abcea4c84eefef9cc2c98cd57a390db3a"><div class="ttname"><a href="classForest_1_1StatsTimer.html#abcea4c84eefef9cc2c98cd57a390db3a">Forest::StatsTimer::instance</a></div><div class="ttdeci">static StatsTimer &amp; instance()</div><div class="ttdoc">Instance. </div><div class="ttdef"><b>Definition:</b> <a href="forest__utils__timer_8h_source.html#l00023">forest_utils_timer.h:23</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1EqSolverWG_ac70deb216726b5b4c947fffe094b885f_cgraph.png" border="0" usemap="#classForest_1_1EqSolverWG_ac70deb216726b5b4c947fffe094b885f_cgraph" alt=""/></div>
<map name="classForest_1_1EqSolverWG_ac70deb216726b5b4c947fffe094b885f_cgraph" id="classForest_1_1EqSolverWG_ac70deb216726b5b4c947fffe094b885f_cgraph">
<area shape="rect" id="node2" href="classForest_1_1StatsTimer.html#abcea4c84eefef9cc2c98cd57a390db3a" title="Instance. " alt="" coords="210,122,341,163"/>
<area shape="rect" id="node3" href="classForest_1_1StatsTimer.html#a6eeef37937bfc1eb0b6f1d1f7cb7e822" title="add " alt="" coords="410,5,570,32"/>
<area shape="rect" id="node7" href="classForest_1_1StatsMemory.html#a5eb587b9a801cb0c550cbbddf4683a9e" title="instance " alt="" coords="203,275,348,317"/>
<area shape="rect" id="node8" href="classForest_1_1StatsMemory.html#a606d8a3997ebe17f80942fb446ee521c" title="add " alt="" coords="403,253,577,280"/>
<area shape="rect" id="node11" href="classForest_1_1EqSolverWG.html#a735f7b060f85ade1344fcefc7f97dfe4" title="Return the memory consumption of the vectors of this class. " alt="" coords="196,341,355,382"/>
<area shape="rect" id="node4" href="classForest_1_1StatsTimer.html#aef24c161a85651b197734742c0ca8422" title="add_final " alt="" coords="425,57,555,98"/>
<area shape="rect" id="node5" href="classForest_1_1StatsTimer.html#a10a05da97b74c5c209fe7836d68d1f95" title="print_detailed " alt="" coords="425,122,555,163"/>
<area shape="rect" id="node6" href="classForest_1_1StatsTimer.html#ac516bc136543c5798062c3af6a4f787d" title="get_total " alt="" coords="425,187,555,229"/>
<area shape="rect" id="node9" href="classForest_1_1StatsMemory.html#a11ffb64d73b6ba087eda89b3700a1636" title="print_detailed " alt="" coords="417,305,563,346"/>
<area shape="rect" id="node10" href="classForest_1_1StatsMemory.html#a7924e0b4d364500be0663a1cd1caafc4" title="get_total " alt="" coords="417,370,563,411"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="abd97f4a2183ef29cc3aec618a9c789d6"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1EqSolverWG.html">Forest::EqSolverWG</a>&lt; dim &gt;::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdealii_1_1BlockVector.html">BlockVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdealii_1_1BlockVector.html">BlockVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol_default</em> = <code>-1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>max_it_default</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000038">Todo:</a></b></dt><dd>Document me </dd></dl>

<p>Definition at line <a class="el" href="solver__eq_8cc_source.html#l00287">287</a> of file <a class="el" href="solver__eq_8cc_source.html">solver_eq.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> tol = (tol_default &lt; 0) ? <a class="code" href="classForest_1_1EqSolverWG.html#acdb5a669276a8d57f739b1a1bf4bc210">m_tol_i</a> : tol_default;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_it =</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        (max_it_default == 0) ? <a class="code" href="classForest_1_1EqSolverWG.html#a5161574fd00f9f9c394e845585e13322">m_max_it_i</a> : max_it_default;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="classForest_1_1EqSolverWG.html#abc9a9fc325203a08103ab020025d2a3b">m_total_wg_it</a> = 0;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// Use Krylov method or Richardson iteration.</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    std::string solver_name = <span class="stringliteral">&quot;gmres&quot;</span>; <span class="comment">//&quot;fgmres or gmres&quot;</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classForest_1_1EqSolverWG.html#acd392699ae34a6584eebae526acac241">m_use_krylov</a>)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classForest_1_1EqSolverWG.html#a03f04d09e4d6b0bd8ec848eaba07d021">mp_equation</a>.is_symmetric ())</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        solver_name = <span class="stringliteral">&quot;cg&quot;</span>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        solver_name = <span class="stringliteral">&quot;gmres&quot;</span>;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classForest_1_1EqSolverWG.html#a05da0b5b87d2d9a9c2dd5b71427eb3fd">m_use_richardson</a>)</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="comment">// phi_new = [D*L_inv*M*S]*phi_old</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="comment">//         = [I-(I-D*L_inv*M*S)]*phi_old ;</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="comment">//         = [I-Eq.vmult]*phi_old ;</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      solver_name = <span class="stringliteral">&quot;richardson&quot;</span>;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      Assert(<span class="keyword">false</span>, ExcMessage(<span class="stringliteral">&quot;Krylov or Richardson must be chosen.&quot;</span>));</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// Prepare gmres to solve the system.</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    SolverControl solver_control (max_it, tol);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// By default we use the FGMRES</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">if</span> (solver_name == <span class="stringliteral">&quot;fgmres&quot;</span>)</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      SolverFGMRES&lt;BlockVector&lt;double&gt; &gt; solver (solver_control,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          <a class="code" href="classForest_1_1EqSolverWG.html#a86f119fbd09a3dec6247e1abaf81c21e">m_vector_memory</a>,</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          SolverFGMRES&lt;<a class="code" href="classdealii_1_1BlockVector.html">BlockVector&lt;double&gt;</a> &gt;::AdditionalData (8));</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      solver.solve (<a class="code" href="classForest_1_1EqSolverWG.html#a03f04d09e4d6b0bd8ec848eaba07d021">mp_equation</a>, sol, rhs, <a class="code" href="classForest_1_1EqSolverWG.html#a2ee2b46905f41e9964586a9dacddf0fb">m_preconditioner</a>);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      deallog &lt;&lt; <span class="stringliteral">&quot;fgmres iters = &quot;</span> &lt;&lt; solver_control.last_step () &lt;&lt; std::endl;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// we use GMRES</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (solver_name == <span class="stringliteral">&quot;gmres&quot;</span>)</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      SolverGMRES&lt;BlockVector&lt;double&gt; &gt; solver (solver_control, <a class="code" href="classForest_1_1EqSolverWG.html#a86f119fbd09a3dec6247e1abaf81c21e">m_vector_memory</a>,</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;          SolverGMRES&lt;<a class="code" href="classdealii_1_1BlockVector.html">BlockVector&lt;double&gt;</a> &gt;::AdditionalData (8));</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      solver.solve (<a class="code" href="classForest_1_1EqSolverWG.html#a03f04d09e4d6b0bd8ec848eaba07d021">mp_equation</a>, sol, rhs, <a class="code" href="classForest_1_1EqSolverWG.html#a2ee2b46905f41e9964586a9dacddf0fb">m_preconditioner</a>);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      deallog &lt;&lt; <span class="stringliteral">&quot;gmres iters = &quot;</span> &lt;&lt; solver_control.last_step () &lt;&lt; <span class="stringliteral">&quot; and tol = &quot;</span> &lt;&lt; solver_control.last_value () &lt;&lt; std::endl;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// we use CG</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (solver_name == <span class="stringliteral">&quot;cg&quot;</span>)</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      SolverCG&lt;BlockVector&lt;double&gt; &gt; solver (solver_control, <a class="code" href="classForest_1_1EqSolverWG.html#a86f119fbd09a3dec6247e1abaf81c21e">m_vector_memory</a>);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      solver.solve (<a class="code" href="classForest_1_1EqSolverWG.html#a03f04d09e4d6b0bd8ec848eaba07d021">mp_equation</a>, sol, rhs, <a class="code" href="classForest_1_1EqSolverWG.html#a2ee2b46905f41e9964586a9dacddf0fb">m_preconditioner</a>);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      deallog &lt;&lt; <span class="stringliteral">&quot;cg iters = &quot;</span> &lt;&lt; solver_control.last_step () &lt;&lt; std::endl;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// we use Richardson</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (solver_name == <span class="stringliteral">&quot;richardson&quot;</span>)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    {</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> richardson_its = 1;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      this-&gt;<a class="code" href="classForest_1_1EqSolverWG.html#ae02db7d5c2ec6c7d11931bd473fe5bad">richardson</a> (sol, rhs, <a class="code" href="classForest_1_1EqSolverWG.html#acdb5a669276a8d57f739b1a1bf4bc210">m_tol_i</a>, richardson_its);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="comment">//SolverRichardson&lt;BlockVector&lt;double&gt; &gt; solver (solver_control, m_vector_memory,</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="comment">//    SolverRichardson&lt;BlockVector&lt;double&gt; &gt;::AdditionalData (8));</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="comment">//solver.solve (mp_equation, sol, rhs, m_preconditioner);</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      deallog &lt;&lt; <span class="stringliteral">&quot;richardson iters = &quot;</span> &lt;&lt; richardson_its &lt;&lt; std::endl;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">/*SolverSelector&lt;BlockVector&lt;double&gt; &gt; solver();</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">     solver.select(solver_name);</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">     solver.set_control(solver_control);*/</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">/*SolverSelector&lt;BlockVector&lt;double&gt; &gt;  solver(solver_name, solver_control, m_vector_memory);*/</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// We solve the system.</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">//solver.solve (mp_equation, sol, rhs, m_preconditioner);</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;iterations = &quot; &lt;&lt; solver_control.last_step () &lt;&lt; std::endl;</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="classForest_1_1EqSolverWG.html#abc9a9fc325203a08103ab020025d2a3b">m_total_wg_it</a> += solver_control.last_step ();</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  }</div><div class="ttc" id="classForest_1_1EqSolverWG_html_acdb5a669276a8d57f739b1a1bf4bc210"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#acdb5a669276a8d57f739b1a1bf4bc210">Forest::EqSolverWG::m_tol_i</a></div><div class="ttdeci">const double m_tol_i</div><div class="ttdoc">Tolerance criteria for the solvers (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00403">solver_eq.h:403</a></div></div>
<div class="ttc" id="classdealii_1_1BlockVector_html"><div class="ttname"><a href="classdealii_1_1BlockVector.html">dealii::BlockVector&lt; double &gt;</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_a86f119fbd09a3dec6247e1abaf81c21e"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#a86f119fbd09a3dec6247e1abaf81c21e">Forest::EqSolverWG::m_vector_memory</a></div><div class="ttdeci">GrowingVectorMemory&lt; BlockVector&lt; double &gt; &gt; m_vector_memory</div><div class="ttdoc">Memory for GMRES (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00398">solver_eq.h:398</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_a2ee2b46905f41e9964586a9dacddf0fb"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#a2ee2b46905f41e9964586a9dacddf0fb">Forest::EqSolverWG::m_preconditioner</a></div><div class="ttdeci">EqPrec&lt; dim &gt; m_preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00395">solver_eq.h:395</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_a5161574fd00f9f9c394e845585e13322"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#a5161574fd00f9f9c394e845585e13322">Forest::EqSolverWG::m_max_it_i</a></div><div class="ttdeci">const unsigned int m_max_it_i</div><div class="ttdoc">Maximum iterations of the solvers (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00401">solver_eq.h:401</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_a03f04d09e4d6b0bd8ec848eaba07d021"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#a03f04d09e4d6b0bd8ec848eaba07d021">Forest::EqSolverWG::mp_equation</a></div><div class="ttdeci">Equation&lt; dim &gt; &amp; mp_equation</div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00394">solver_eq.h:394</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_ae02db7d5c2ec6c7d11931bd473fe5bad"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#ae02db7d5c2ec6c7d11931bd473fe5bad">Forest::EqSolverWG::richardson</a></div><div class="ttdeci">void richardson(BlockVector&lt; double &gt; &amp;sol, const BlockVector&lt; double &gt; &amp;rhs, const double tol, const unsigned int max_it) const </div><div class="ttdoc">Richardson method for solving a linear system. </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8cc_source.html#l00374">solver_eq.cc:374</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_abc9a9fc325203a08103ab020025d2a3b"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#abc9a9fc325203a08103ab020025d2a3b">Forest::EqSolverWG::m_total_wg_it</a></div><div class="ttdeci">unsigned int m_total_wg_it</div><div class="ttdoc">Counting the sweeps (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00409">solver_eq.h:409</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_a05da0b5b87d2d9a9c2dd5b71427eb3fd"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#a05da0b5b87d2d9a9c2dd5b71427eb3fd">Forest::EqSolverWG::m_use_richardson</a></div><div class="ttdeci">bool m_use_richardson</div><div class="ttdoc">Flag to use the Richardson iteration (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00407">solver_eq.h:407</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_acd392699ae34a6584eebae526acac241"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#acd392699ae34a6584eebae526acac241">Forest::EqSolverWG::m_use_krylov</a></div><div class="ttdeci">bool m_use_krylov</div><div class="ttdoc">Flag to use the Krylov solver (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00405">solver_eq.h:405</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1EqSolverWG_abd97f4a2183ef29cc3aec618a9c789d6_cgraph.png" border="0" usemap="#classForest_1_1EqSolverWG_abd97f4a2183ef29cc3aec618a9c789d6_cgraph" alt=""/></div>
<map name="classForest_1_1EqSolverWG_abd97f4a2183ef29cc3aec618a9c789d6_cgraph" id="classForest_1_1EqSolverWG_abd97f4a2183ef29cc3aec618a9c789d6_cgraph">
<area shape="rect" id="node2" href="classForest_1_1EqSolverWG.html#ae02db7d5c2ec6c7d11931bd473fe5bad" title="Richardson method for solving a linear system. " alt="" coords="196,5,339,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae02db7d5c2ec6c7d11931bd473fe5bad"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classForest_1_1EqSolverWG.html">Forest::EqSolverWG</a>&lt; dim &gt;::richardson </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdealii_1_1BlockVector.html">BlockVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdealii_1_1BlockVector.html">BlockVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>max_it</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Richardson method for solving a linear system. </p>
<p>phi_new = [D*L_inv*M*S]*phi_old = [I-(I-D*L_inv*M*S)]*phi_old = [I-Eq.vmult]*phi_old ; </p>

<p>Definition at line <a class="el" href="solver__eq_8cc_source.html#l00374">374</a> of file <a class="el" href="solver__eq_8cc_source.html">solver_eq.cc</a>.</p>

<p>Referenced by <a class="el" href="solver__eq_8cc_source.html#l00287">Forest::EqSolverWG&lt; dim &gt;::solve()</a>.</p>
<div class="fragment"><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="classdealii_1_1BlockVector.html">BlockVector&lt;double&gt;</a> m_sol_old (sol);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l = 0; l &lt; max_it; ++l)</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="comment">// Move sol_new to the container sol_old and start.</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      m_sol_old.swap (sol);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="comment">// equation.DL_invMS (sol, m_sol_old);</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <a class="code" href="classForest_1_1EqSolverWG.html#a03f04d09e4d6b0bd8ec848eaba07d021">mp_equation</a>.vmult (sol, m_sol_old);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      sol.sadd (-1., m_sol_old);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="comment">// Increase transport sweeps counter.</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      ++<a class="code" href="classForest_1_1EqSolverWG.html#abc9a9fc325203a08103ab020025d2a3b">m_total_wg_it</a>;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="comment">// New solution vector and its norm.</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      sol += rhs;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> sol_norm = sol.l2_norm ();</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="comment">// Subtract the new solution to the old one to approximate the error.</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      m_sol_old.sadd (-1, sol);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> err_phi = m_sol_old.l2_norm ();</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="comment">// If the error is small enough.. stop!.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">if</span> (err_phi / sol_norm &lt; tol)</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  }</div><div class="ttc" id="classdealii_1_1BlockVector_html"><div class="ttname"><a href="classdealii_1_1BlockVector.html">dealii::BlockVector&lt; double &gt;</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_a03f04d09e4d6b0bd8ec848eaba07d021"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#a03f04d09e4d6b0bd8ec848eaba07d021">Forest::EqSolverWG::mp_equation</a></div><div class="ttdeci">Equation&lt; dim &gt; &amp; mp_equation</div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00394">solver_eq.h:394</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_abc9a9fc325203a08103ab020025d2a3b"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#abc9a9fc325203a08103ab020025d2a3b">Forest::EqSolverWG::m_total_wg_it</a></div><div class="ttdeci">unsigned int m_total_wg_it</div><div class="ttdoc">Counting the sweeps (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00409">solver_eq.h:409</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1EqSolverWG_ae02db7d5c2ec6c7d11931bd473fe5bad_icgraph.png" border="0" usemap="#classForest_1_1EqSolverWG_ae02db7d5c2ec6c7d11931bd473fe5bad_icgraph" alt=""/></div>
<map name="classForest_1_1EqSolverWG_ae02db7d5c2ec6c7d11931bd473fe5bad_icgraph" id="classForest_1_1EqSolverWG_ae02db7d5c2ec6c7d11931bd473fe5bad_icgraph">
<area shape="rect" id="node2" href="classForest_1_1EqSolverWG.html#abd97f4a2183ef29cc3aec618a9c789d6" title="Forest::EqSolverWG\l::solve" alt="" coords="196,5,339,47"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a33914eb34f77d6d5ae7720d9ce92654e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classForest_1_1EqSolverWG.html">Forest::EqSolverWG</a>&lt; dim &gt;::get_tot_wg_it </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the total number of sweeps within energy groups. </p>

<p>Definition at line <a class="el" href="solver__eq_8h_source.html#l00376">376</a> of file <a class="el" href="solver__eq_8h_source.html">solver_eq.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classForest_1_1EqSolverWG.html#abc9a9fc325203a08103ab020025d2a3b">m_total_wg_it</a>;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div><div class="ttc" id="classForest_1_1EqSolverWG_html_abc9a9fc325203a08103ab020025d2a3b"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#abc9a9fc325203a08103ab020025d2a3b">Forest::EqSolverWG::m_total_wg_it</a></div><div class="ttdeci">unsigned int m_total_wg_it</div><div class="ttdoc">Counting the sweeps (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00409">solver_eq.h:409</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a735f7b060f85ade1344fcefc7f97dfe4"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classForest_1_1EqSolverWG.html">Forest::EqSolverWG</a>&lt; dim &gt;::memory_consumption </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the memory consumption of the vectors of this class. </p>

<p>Definition at line <a class="el" href="solver__eq_8h_source.html#l00383">383</a> of file <a class="el" href="solver__eq_8h_source.html">solver_eq.h</a>.</p>

<p>Referenced by <a class="el" href="solver__eq_8cc_source.html#l00261">Forest::EqSolverWG&lt; dim &gt;::EqSolverWG()</a>.</p>
<div class="fragment"><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="classForest_1_1EqSolverWG.html#a735f7b060f85ade1344fcefc7f97dfe4">memory_consumption</a> = 0;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      memory_consumption += <a class="code" href="classForest_1_1EqSolverWG.html#a86f119fbd09a3dec6247e1abaf81c21e">m_vector_memory</a>.memory_consumption();</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classForest_1_1EqSolverWG.html#a735f7b060f85ade1344fcefc7f97dfe4">memory_consumption</a>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div><div class="ttc" id="classForest_1_1EqSolverWG_html_a86f119fbd09a3dec6247e1abaf81c21e"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#a86f119fbd09a3dec6247e1abaf81c21e">Forest::EqSolverWG::m_vector_memory</a></div><div class="ttdeci">GrowingVectorMemory&lt; BlockVector&lt; double &gt; &gt; m_vector_memory</div><div class="ttdoc">Memory for GMRES (within-group). </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00398">solver_eq.h:398</a></div></div>
<div class="ttc" id="classForest_1_1EqSolverWG_html_a735f7b060f85ade1344fcefc7f97dfe4"><div class="ttname"><a href="classForest_1_1EqSolverWG.html#a735f7b060f85ade1344fcefc7f97dfe4">Forest::EqSolverWG::memory_consumption</a></div><div class="ttdeci">double memory_consumption() const </div><div class="ttdoc">Return the memory consumption of the vectors of this class. </div><div class="ttdef"><b>Definition:</b> <a href="solver__eq_8h_source.html#l00383">solver_eq.h:383</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classForest_1_1EqSolverWG_a735f7b060f85ade1344fcefc7f97dfe4_icgraph.png" border="0" usemap="#classForest_1_1EqSolverWG_a735f7b060f85ade1344fcefc7f97dfe4_icgraph" alt=""/></div>
<map name="classForest_1_1EqSolverWG_a735f7b060f85ade1344fcefc7f97dfe4_icgraph" id="classForest_1_1EqSolverWG_a735f7b060f85ade1344fcefc7f97dfe4_icgraph">
<area shape="rect" id="node2" href="classForest_1_1EqSolverWG.html#ac70deb216726b5b4c947fffe094b885f" title="Forest::EqSolverWG\l::EqSolverWG" alt="" coords="212,5,355,47"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="ae55b64b504b5b49351e37d2021b27f76"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1State.html">State</a>&lt;dim&gt;&amp; <a class="el" href="classForest_1_1EqSolverWG.html">Forest::EqSolverWG</a>&lt; dim &gt;::mp_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reference pointer to the state vector. </p>

<p>Definition at line <a class="el" href="solver__eq_8h_source.html#l00393">393</a> of file <a class="el" href="solver__eq_8h_source.html">solver_eq.h</a>.</p>

</div>
</div>
<a class="anchor" id="a03f04d09e4d6b0bd8ec848eaba07d021"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1Equation.html">Equation</a>&lt;dim&gt;&amp; <a class="el" href="classForest_1_1EqSolverWG.html">Forest::EqSolverWG</a>&lt; dim &gt;::mp_equation</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="solver__eq_8h_source.html#l00394">394</a> of file <a class="el" href="solver__eq_8h_source.html">solver_eq.h</a>.</p>

<p>Referenced by <a class="el" href="solver__eq_8cc_source.html#l00374">Forest::EqSolverWG&lt; dim &gt;::richardson()</a>, and <a class="el" href="solver__eq_8cc_source.html#l00287">Forest::EqSolverWG&lt; dim &gt;::solve()</a>.</p>

</div>
</div>
<a class="anchor" id="a2ee2b46905f41e9964586a9dacddf0fb"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classForest_1_1EqPrec.html">EqPrec</a>&lt;dim&gt; <a class="el" href="classForest_1_1EqSolverWG.html">Forest::EqSolverWG</a>&lt; dim &gt;::m_preconditioner</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="solver__eq_8h_source.html#l00395">395</a> of file <a class="el" href="solver__eq_8h_source.html">solver_eq.h</a>.</p>

<p>Referenced by <a class="el" href="solver__eq_8cc_source.html#l00287">Forest::EqSolverWG&lt; dim &gt;::solve()</a>.</p>

</div>
</div>
<a class="anchor" id="a86f119fbd09a3dec6247e1abaf81c21e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">GrowingVectorMemory&lt;<a class="el" href="classdealii_1_1BlockVector.html">BlockVector</a>&lt;double&gt; &gt; <a class="el" href="classForest_1_1EqSolverWG.html">Forest::EqSolverWG</a>&lt; dim &gt;::m_vector_memory</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Memory for GMRES (within-group). </p>

<p>Definition at line <a class="el" href="solver__eq_8h_source.html#l00398">398</a> of file <a class="el" href="solver__eq_8h_source.html">solver_eq.h</a>.</p>

<p>Referenced by <a class="el" href="solver__eq_8cc_source.html#l00287">Forest::EqSolverWG&lt; dim &gt;::solve()</a>.</p>

</div>
</div>
<a class="anchor" id="a5161574fd00f9f9c394e845585e13322"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int <a class="el" href="classForest_1_1EqSolverWG.html">Forest::EqSolverWG</a>&lt; dim &gt;::m_max_it_i</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maximum iterations of the solvers (within-group). </p>

<p>Definition at line <a class="el" href="solver__eq_8h_source.html#l00401">401</a> of file <a class="el" href="solver__eq_8h_source.html">solver_eq.h</a>.</p>

<p>Referenced by <a class="el" href="solver__eq_8cc_source.html#l00287">Forest::EqSolverWG&lt; dim &gt;::solve()</a>.</p>

</div>
</div>
<a class="anchor" id="acdb5a669276a8d57f739b1a1bf4bc210"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double <a class="el" href="classForest_1_1EqSolverWG.html">Forest::EqSolverWG</a>&lt; dim &gt;::m_tol_i</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tolerance criteria for the solvers (within-group). </p>

<p>Definition at line <a class="el" href="solver__eq_8h_source.html#l00403">403</a> of file <a class="el" href="solver__eq_8h_source.html">solver_eq.h</a>.</p>

<p>Referenced by <a class="el" href="solver__eq_8cc_source.html#l00287">Forest::EqSolverWG&lt; dim &gt;::solve()</a>.</p>

</div>
</div>
<a class="anchor" id="acd392699ae34a6584eebae526acac241"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="classForest_1_1EqSolverWG.html">Forest::EqSolverWG</a>&lt; dim &gt;::m_use_krylov</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag to use the Krylov solver (within-group). </p>

<p>Definition at line <a class="el" href="solver__eq_8h_source.html#l00405">405</a> of file <a class="el" href="solver__eq_8h_source.html">solver_eq.h</a>.</p>

<p>Referenced by <a class="el" href="solver__eq_8cc_source.html#l00261">Forest::EqSolverWG&lt; dim &gt;::EqSolverWG()</a>, and <a class="el" href="solver__eq_8cc_source.html#l00287">Forest::EqSolverWG&lt; dim &gt;::solve()</a>.</p>

</div>
</div>
<a class="anchor" id="a05da0b5b87d2d9a9c2dd5b71427eb3fd"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> <a class="el" href="classForest_1_1EqSolverWG.html">Forest::EqSolverWG</a>&lt; dim &gt;::m_use_richardson</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag to use the Richardson iteration (within-group). </p>

<p>Definition at line <a class="el" href="solver__eq_8h_source.html#l00407">407</a> of file <a class="el" href="solver__eq_8h_source.html">solver_eq.h</a>.</p>

<p>Referenced by <a class="el" href="solver__eq_8cc_source.html#l00261">Forest::EqSolverWG&lt; dim &gt;::EqSolverWG()</a>, and <a class="el" href="solver__eq_8cc_source.html#l00287">Forest::EqSolverWG&lt; dim &gt;::solve()</a>.</p>

</div>
</div>
<a class="anchor" id="abc9a9fc325203a08103ab020025d2a3b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classForest_1_1EqSolverWG.html">Forest::EqSolverWG</a>&lt; dim &gt;::m_total_wg_it</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Counting the sweeps (within-group). </p>

<p>Definition at line <a class="el" href="solver__eq_8h_source.html#l00409">409</a> of file <a class="el" href="solver__eq_8h_source.html">solver_eq.h</a>.</p>

<p>Referenced by <a class="el" href="solver__eq_8cc_source.html#l00261">Forest::EqSolverWG&lt; dim &gt;::EqSolverWG()</a>, <a class="el" href="solver__eq_8cc_source.html#l00374">Forest::EqSolverWG&lt; dim &gt;::richardson()</a>, and <a class="el" href="solver__eq_8cc_source.html#l00287">Forest::EqSolverWG&lt; dim &gt;::solve()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/lns/Codes/forest-public/mylib/include/algebra/<a class="el" href="solver__eq_8h_source.html">solver_eq.h</a></li>
<li>/home/lns/Codes/forest-public/mylib/src/algebra/<a class="el" href="solver__eq_8cc_source.html">solver_eq.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceForest.html">Forest</a></li><li class="navelem"><a class="el" href="classForest_1_1EqSolverWG.html">EqSolverWG</a></li>
    <li class="footer">Generated on Tue Oct 31 2017 19:23:34 for FOREST by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
